<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>חינוך פיננסי משפחתי</title>
	 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap');

        :root {
            --primary-color: #2d5a77;
            --secondary-color: #4a90a7;
            --accent-color: #c9a959;
            --background-color: #ffffff;
            --text-color: #2c3e50;
            --border-color: #e5e9f0;
            --hover-color: #3a7ca5;
            --card-background: #f8f9fa;
            --shadow-color: rgba(45, 90, 119, 0.1);
            --gradient-start: #2d5a77;
            --gradient-end: #4a90a7;
            --success-color: #4CAF50;
            --warning-color: #FFA726;
            --error-color: #EF5350;
        }

        [data-theme="dark"] {
            --primary-color: #64b5f6;
            --secondary-color: #81d4fa;
            --accent-color: #ffd54f;
            --background-color: #0a1929;
            --text-color: #e3f2fd;
            --border-color: #1a3747;
            --hover-color: #90caf9;
            --card-background: #132f4c;
            --shadow-color: rgba(100, 181, 246, 0.2);
            --gradient-start: #1a237e;
            --gradient-end: #0d47a1;
            --success-color: #66BB6A;
            --warning-color: #FFB74D;
            --error-color: #EF5350;
        }

        /* Reset and Base Styles */
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			transition: background-color 0.3s ease, color 0.3s ease;
			font-size: 18px;
		}

		body {

			font-family: 'Rubik', sans-serif;
			line-height: 1.6;
			background-color: var(--background-color);
			color: var(--text-color);
			padding-top: 80px;
			direction: rtl;
			overflow-x: hidden;
			min-height: 100vh;
		}

		/* Container and Main Layout */
		.container {
			max-width: 1200px;
			margin: 0 auto;
			position: relative;
			z-index: 1;
			padding-top: 1rem; /* מרווח קטן מלמעלה */
		}

		/* Header */
		header {
			background-color: var(--primary-color);
			color: white;
			padding: 1rem 0;
			box-shadow: 0 2px 4px var(--shadow-color);
			position: fixed;
			width: 100%;
			top: 0;
			left: 0;
			right: 0;
			z-index: 1000;
			height: 80px;
			display: flex;
			align-items: flex-end;
		}

		.header-content {
			display: flex;
			justify-content: space-between;
			align-items: center;
			width: 100%;
		}

		/* Main Content Area */
		main {
			margin-right: 280px; /* תואם את רוחב תפריט הצד */
			padding: 0 20px;
			min-height: calc(100vh - 80px);
		}

		/* Side Navigation */
		.steps-navigation {
			position: fixed;
			top: 80px;
			right: 0;
			width: 350px;
			height: calc(100vh - 80px);
			background: var(--background-color);
			padding: 1rem;
			z-index: 100;
			box-shadow: 2px 0 10px var(--shadow-color);
			overflow-y: auto;
		}

		.steps-list {
			display: flex;
			flex-direction: column;
			gap: 1rem;
		}

		/* Content Sections */
		.content-section {
			visibility: hidden; /* מסתיר את האלמנט ללא הסרתו מהזרימה */
			height: 0; /* גובה אפס כאשר השלב אינו פעיל */
			overflow: hidden; /* מונע גלילה פנימית מיותרת */
			opacity: 0; /* שקיפות מלאה כאשר השלב אינו פעיל */
			transition: opacity 0.3s ease, visibility 0s linear 0.3s, height 0s linear 0.3s; /* מעבר חלק */
			padding: 2rem; /* ריווח פנימי לתוכן */
			margin: 0; /* ביטול מרווחים חיצוניים */
			background: var(--background-color); /* צבע רקע */
			border-radius: 12px; /* פינות מעוגלות */
			position: relative; /* מאפשר תכונות מיקום */
			z-index: 5; /* סדר מיקום */
			min-height: 500px; /* גובה מינימלי אחיד לכל השלבים */
		}

		.content-section.active {
			visibility: visible; /* הופך את האלמנט לגלוי */
			height: auto; /* מאפשר התאמה אוטומטית לגובה התוכן */
			overflow: visible; /* מציג תוכן גלוי */
			opacity: 1; /* שקיפות מלאה */
			transition: opacity 0.3s ease; /* אנימציה חלקה של שקיפות בלבד */
		}

		/* Chapter Navigation */
		.chapter-navigation {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 2rem;
			padding: 1rem;
			background-color: var(--card-background);
			border-radius: 12px;
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		/* Content Blocks */
		.content-block {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-bottom: 2rem;
			box-shadow: 0 2px 10px var(--shadow-color);
			opacity: 1;
			visibility: visible;
		}

		/* Steps */
		.step {
			background: var(--card-background);
			border-radius: 8px;
			padding: 1rem;
			cursor: pointer;
			transition: all 0.3s ease;
			border: 1px solid var(--border-color);
			margin-bottom: 0.5rem;
		}

		.step.active {
			border-color: var(--primary-color);
			box-shadow: 0 0 0 2px rgba(74, 144, 167, 0.2);
		}

		.step-number {
			width: 32px;
			height: 32px;
			border-radius: 50%;
			background: var(--primary-color);
			color: white;
			display: inline-flex;
			align-items: center;
			justify-content: center;
			margin-left: 0.5rem;
		}

		.step-title {
			font-weight: 500;
			font-size: 1.1rem;
		}

		.step-details {
			display: none;
			margin-top: 0.5rem;
			padding-right: 2.5rem;
		}

		.step.active .step-details {
			display: block;
		}


		/* Content Components */
		.principle-block,
		.practical-example,
		.advanced-tips,
		.interactive-exercise {
			position: relative;
			z-index: 2;
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 12px;
			margin: 1.5rem 0;
			border: 1px solid var(--border-color);
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		/* Progress Indicators */
		.progress-wrapper {
			display: flex;
			align-items: center;
			gap: 1rem;
		}

		/* מחיקת ההגדרות הכפולות */
		.progress-bar {
			width: 200px;
			height: 8px;
			background-color: var(--border-color);
			border-radius: 4px;
			overflow: hidden;
		}

		.progress-bar .progress-indicator {
			height: 100%;
			background-color: var(--primary-color);
			transition: width 0.3s ease-in-out;
			width: 0;
		}

		.progress-text {
			font-size: 0.9rem;
			color: var(--text-color);
			margin-left: 1rem;
		}

		.chapter-navigation .progress-bar {
			width: 200px;
			height: 8px;
			background-color: var(--border-color);
			border-radius: 4px;
			overflow: hidden;
		}

		.chapter-navigation .progress-bar div {
			height: 100%;
			background-color: var(--primary-color);
			transition: width 0.3s ease-in-out;
			width: 0;
		}

		.chapter-navigation .progress-text {
			font-size: 0.9rem;
			margin-right: 1rem;
		}

		/* הסרת ההגדרה הכפולה */
		.progress {
			display: none;  /* נסתיר את האלמנט הכפול */
		}
				
		.progress-bar div {
			height: 100%;
			background-color: var(--primary-color);
			transition: width 0.3s ease-in-out;
		}

		.substep {
			cursor: pointer;
		}

		.substep.completed {
			background-color: var(--success-color);
			color: white;
		}


		.step-navigation {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-top: 2rem;
			padding: 1rem;
			background-color: var(--card-background);
			border-radius: 8px;
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		.step-navigation button {
			padding: 0.8rem 1.5rem;
			font-size: 1rem;
			font-weight: bold;
			color: white;
			background-color: var(--primary-color);
			border: none;
			border-radius: 8px;
			cursor: pointer;
			transition: background-color 0.3s ease, transform 0.2s ease;
		}

		.step-navigation button:hover {
			background-color: var(--hover-color);
			transform: translateY(-2px);
		}

		.step-navigation button:disabled {
			background-color: var(--border-color);
			color: var(--text-color);
			cursor: not-allowed;
			transform: none;
		}

		/* Responsive Adjustments */
		@media (max-width: 768px) {
			.steps-navigation {
				position: sticky;
				top: 80px;
				width: 100%;
				height: auto;
				margin-bottom: 1rem;
				border-radius: 12px;
			}
			
			main {
				margin-right: 0;
				padding: 0;
			}
			

			.container {
				max-width: 100%;
				margin: 0 auto;
				padding: 1rem;
			}

			.steps-list {
				gap: 0.5rem;
			}

			.step {
				padding: 0.75rem;
			}

			.step-title {
				font-size: 1rem;
			}

			.step-details {
				padding-right: 1.5rem;
			}

			.content-block {
				padding: 1rem;
			}

			.chapter-navigation {
				flex-direction: column;
				gap: 1rem;
			}
		}

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .nav-toggle {
            display: none;
            font-size: 1.5rem;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
            font-size: 1.2rem;
        }

        nav {
            display: flex;
            gap: 2rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        nav a:hover {
            background-color: var(--hover-color);
        }


        /* 6. תיקון התצוגה של ה-hero section */
		.hero {
			margin-top: 0;
			border-radius: 16px;
			position: relative;
			overflow: hidden;
		}
				
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.1) 0%, transparent 60%);
            pointer-events: none;
        }

        .hero::after {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: radial-gradient(circle at center, rgba(255,255,255,0.05) 0%, transparent 50%);
            animation: rotate 60s linear infinite;
            pointer-events: none;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem 0;
        }

        .card {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px var(--shadow-color);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
            border-radius: 16px 16px 0 0;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px var(--shadow-color);
        }

        .card:hover::before {
            transform: scaleX(1);
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .nav-toggle {
                display: block;
            }

            nav {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background-color: var(--primary-color);
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }

            nav.active {
                display: flex;
            }
        }

        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }

                /* Additional Styles */
        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .cta-button, .secondary-button {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            border: none;
        }

        .cta-button {
            background-color: var(--accent-color);
            color: var(--background-color);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .secondary-button {
            background-color: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
        }

        .secondary-button:hover {
            background-color: rgba(255,255,255,0.3);
        }

        .search-overlay {
			display: none;  /* מצב ברירת מחדל */
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.85);
			z-index: 9999;  /* ערך גבוה יותר מכל האלמנטים האחרים */
			justify-content: center;
			align-items: center;
		}

		.search-container {
			width: 90%;
			max-width: 600px;
			background-color: var(--background-color);
			padding: 2rem;
			border-radius: 12px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
			position: relative;
		}

		.search-input {
			width: 100%;
			padding: 1rem;
			border: 2px solid var(--border-color);
			border-radius: 8px;
			font-size: 1.1rem;
			background-color: var(--background-color);
			color: var(--text-color);
		}

		.search-close {
			position: absolute;
			top: 1rem;
			left: 1rem;
			background: none;
			border: none;
			color: var(--text-color);
			font-size: 24px;
			cursor: pointer;
			padding: 8px;
			border-radius: 50%;
		}

		.search-close:hover {
			background-color: var(--border-color);
		}

		/* ודא שיש מרחק מלמטה לתוצאות */
		.search-results {
			margin-top: 1rem;
		}
        .search-container input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(20px); }
			to { opacity: 1; transform: translateY(0); }
		}
		
		
        .info-card, .action-card, .tips-card {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .card-footer {
            margin-top: auto;
            padding-top: 1rem;
        }

        .expand-button {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .expand-button:hover {
            background-color: rgba(0,0,0,0.05);
        }

        .expanded-content {
            display: none;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .expanded-content h4 {
            margin-bottom: 0.5rem;
        }

        .expanded-content ul {
            padding-right: 1.5rem;
        }

        .tips-carousel {
            overflow: hidden;
            margin: 1rem 0;
        }

        .tips-track {
            display: flex;
            animation: scroll 20s linear infinite;
        }

        .tip-item {
            flex: 0 0 auto;
            padding: 1rem;
            margin-left: 1rem;
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 2px 10px var(--shadow-color);
            white-space: nowrap;
        }

        @keyframes scroll {
            0% {
                transform: translateX(100%);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        .interactive-goals .goal-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .interactive-goals input {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .goals-list {
            list-style: none;
            padding: 0;
        }

        .goals-list li {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: var(--card-background);
            border-radius: 4px;
            box-shadow: 0 2px 5px var(--shadow-color);
        }

        .floating-nav {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 100;
        }

        .floating-nav button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .floating-nav button:hover {
            transform: scale(1.1);
        }

       

        /* Loading Animation */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--background-color);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading::after {
            content: "";
            width: 50px;
            height: 50px;
            border: 5px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: loading 1s infinite linear;
        }

        @keyframes loading {
            to {
                transform: rotate(360deg);
            }
        }
		
        .learning-path {
            background-color: var(--card-background);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px var(--shadow-color);
        }

        .lesson-module {
            display: none;
        }

        .lesson-module.active {
            display: block;
        }

        .lesson-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .duration {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .lesson-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .theory ul {
            margin-top: 1rem;
            padding-right: 1.5rem;
        }

        .theory li {
            margin-bottom: 0.5rem;
        }

        .interactive-exercise {
            background-color: var(--card-background);
            padding: 2rem;
            border-radius: 12px;
            border: 2px solid var(--primary-color);
        }

        .checkbox-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1rem 0;
        }

        .checkbox-list label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .action-button {
            background-color: var(--primary-color);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-button:hover {
            background-color: var(--hover-color);
            transform: translateY(-2px);
        }

        .practical-tips {
            margin: 2rem 0;
        }

        .tip-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .tip-card {
            background-color: var(--background-color);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .tip-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .tip-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .knowledge-check {
            background-color: var(--card-background);
            padding: 2rem;
            border-radius: 12px;
            border: 2px solid var(--accent-color);
        }

        .quiz-question {
            margin: 1rem 0;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1rem 0;
        }

        .check-answer-button {
            background-color: var(--accent-color);
            color: var(--background-color);
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .check-answer-button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .lesson-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-color);
        }

        .nav-button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: var(--primary-color);
		}
		

		.principle-content {
			margin-top: 1rem;
		}

		.main-principles {
			list-style: none;
			padding: 0;
		}

		.main-principles > li {
			margin-bottom: 1.5rem;
			padding: 1rem;
			background-color: var(--background-color);
			border-radius: 8px;
			box-shadow: 0 2px 8px var(--shadow-color);
		}

		.main-principles > li > strong {
			display: block;
			margin-bottom: 0.5rem;
			color: var(--primary-color);
			font-size: 1.1rem;
		}

		.main-principles ul {
			padding-right: 1.5rem;
			margin-top: 0.5rem;
		}

		.practical-example {
			margin: 2rem 0;
			padding: 2rem;
			background-color: var(--card-background);
			border-radius: 12px;
			border: 2px solid var(--accent-color);
		}

		.example-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
			gap: 2rem;
			margin-top: 1rem;
		}

		.income-section, .expenses-section {
			padding: 1.5rem;
			background-color: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.income-section h6, .expenses-section h6 {
			color: var(--primary-color);
			margin-bottom: 1rem;
			font-size: 1.1rem;
		}

		.example-grid ul {
			padding-right: 1.2rem;
		}

		.example-grid ul li {
			margin-bottom: 0.8rem;
		}

		.example-grid ul ul {
			margin-top: 0.5rem;
		}

		.advanced-tips {
			margin-top: 2rem;
			padding: 1.5rem;
			background: linear-gradient(to bottom, var(--card-background), var(--background-color));
			border-radius: 12px;
		}

		.tips-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 1.5rem;
			margin-top: 1rem;
		}

		.tip-item {
			padding: 1.5rem;
			background-color: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
			transition: transform 0.3s ease;
		}

		.tip-item:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.tip-item strong {
			display: block;
			margin-bottom: 0.5rem;
			color: var(--primary-color);
		}

		/* תוספת אנימציות */
		.principle-block, 
		.practical-example, 
		.advanced-tips {
			background: var(--card-background);
			padding: 1.5rem;
			border-radius: 12px;
			margin: 1.5rem 0;
			border: 1px solid var(--border-color);
			box-shadow: 0 2px 10px var(--shadow-color);
		}


		@keyframes fadeInUp {
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* תוספת רספונסיביות */
		@media (max-width: 768px) {
			.example-grid {
				grid-template-columns: 1fr;
			}
			
			.tips-grid {
				grid-template-columns: 1fr;
			}
			
			.principle-block, .practical-example, .advanced-tips {
				padding: 1rem;
			}
		}
		
		.step-by-step {
			display: flex;
			flex-direction: column;
			gap: 1rem;
			padding: 1rem;
			background: var(--card-background);
			border-radius: 8px;
		}

		.step {
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
			transition: transform 0.3s ease;
		}

		.step:hover {
			transform: translateY(-2px);
		}

		.example-cards {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 1rem;
			margin-top: 1rem;
		}

		.example-card {
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
			transition: all 0.3s ease;
		}

		.example-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.budget-calculator {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 2rem;
		}

		.tool-item, .budget-category {
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
			margin-bottom: 1rem;
		}

		.tools-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1rem;
			margin-top: 1rem;
		}

		.example-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 1rem;
		}

		@media (max-width: 768px) {
			.tools-grid, .example-grid {
				grid-template-columns: 1fr;
			}
		}

		.principle-block {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-bottom: 2rem;
		}

		.example-box {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
			margin-top: 1.5rem;
		}

		.budget-category {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			text-align: right;
		}

		.tools-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1rem;
			margin-top: 1rem;
		}

		.tool-item {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			text-align: right;
		}

		.example-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 1rem;
		}

		.budget-calculator {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 2rem;
		}

		.calculator-section {
			margin-bottom: 1.5rem;
		}

		.input-group {
			display: flex;
			align-items: center;
			gap: 1rem;
			margin-bottom: 1rem;
		}

		.budget-input {
			padding: 0.5rem;
			border: 1px solid var(--border-color);
			border-radius: 4px;
			width: 150px;
			text-align: right;
		}

		.calculator-results {
			margin-top: 1.5rem;
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
		}

		@media (max-width: 768px) {
			.tools-grid, .example-grid {
				grid-template-columns: 1fr;
			}
		}
		
		.principle-block {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-bottom: 2rem;
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		.example-box {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
			margin-top: 1.5rem;
		}

		.example-box h5 {
			color: var(--primary-color);
			margin-bottom: 0.5rem;
		}

		.investment-types-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 2rem;
		}

		.investment-type {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.education-methods {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 1.5rem;
		}

		.method-item {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		@media (max-width: 768px) {
			.investment-types-grid,
			.education-methods {
				grid-template-columns: 1fr;
			}
		}
		
		.interactive-tools {
			display: grid;
			gap: 2rem;
			margin-top: 2rem;
		}

		.emergency-fund-calculator,
		.investment-simulator,
		.kids-savings-tracker {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		.calculator-inputs,
		.investment-type-selector,
		.savings-goal-setter {
			margin-bottom: 1.5rem;
		}

		.investment-type-selector {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1rem;
		}

		.investment-option {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.investment-option:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.investment-option.selected {
			border-color: var(--primary-color);
			background: var(--primary-color);
			color: white;
		}

		.calculator-result {
			margin-top: 1rem;
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
		}

		.progress-visualizer {
			height: 20px;
			background: var(--background-color);
			border-radius: 10px;
			overflow: hidden;
			margin-top: 1rem;
		}

	

		@media (max-width: 768px) {
			.investment-type-selector {
				grid-template-columns: 1fr;
			}
		}

		.debt-analyzer,
		.credit-cards-simulator,
		.loan-calculator {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
			box-shadow: 0 2px 10px var(--shadow-color);
		}

		.analyzer-inputs,
		.credit-scenario,
		.calculator-inputs {
			display: grid;
			gap: 1rem;
		}

		.input-group {
			display: flex;
			align-items: center;
			gap: 1rem;
		}

		.calc-input {
			padding: 0.5rem;
			border: 1px solid var(--border-color);
			border-radius: 4px;
			width: 200px;
			text-align: right;
		}

		.analysis-result,
		.simulation-result,
		.calculator-result {
			margin-top: 1.5rem;
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
		}

		select {
			padding: 0.5rem;
			border: 1px solid var(--border-color);
			border-radius: 4px;
			width: 200px;
		}

		.warning {
			color: var(--error-color);
			font-weight: bold;
		}

		.good {
			color: var(--success-color);
			font-weight: bold;
		}
		
		.insurance-calculator,
		.policy-comparison-tool,
		.emergency-plan-builder {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.comparison-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 2rem;
			margin-bottom: 1.5rem;
		}

		.policy-input {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.checkbox-group {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
			margin: 1rem 0;
		}

		.step-input {
			margin-bottom: 1.5rem;
		}

		input[type="range"] {
			width: 100%;
			margin: 1rem 0;
		}

		.comparison-result,
		.plan-result {
			margin-top: 1.5rem;
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
		}

		@media (max-width: 768px) {
			.comparison-grid {
				grid-template-columns: 1fr;
			}
		}

		.coverage-indicator {
			display: inline-block;
			width: 20px;
			height: 20px;
			border-radius: 50%;
			margin-left: 8px;
		}

		.coverage-good {
			background-color: var(--success-color);
		}

		.coverage-warning {
			background-color: var(--warning-color);
		}

		.coverage-danger {
			background-color: var(--error-color);
		}

		.insurance-recommendations {
			background: var(--card-background);
			padding: 1.5rem;
			border-radius: 8px;
			margin-top: 1rem;
		}

		.insurance-recommendations h6 {
			color: var(--primary-color);
			margin-bottom: 1rem;
		}

		

		.progress-fill {
			height: 100%;
			background: var(--primary-color);
			transition: width 0.3s ease;
		}

		.comparison-chart {
			width: 100%;
			height: 300px;
			margin-top: 1.5rem;
		}

		.tooltip {
			position: absolute;
			background: var(--card-background);
			padding: 0.5rem;
			border-radius: 4px;
			box-shadow: 0 2px 8px var(--shadow-color);
			font-size: 0.875rem;
			z-index: 100;
		}

		.tips-section {
			background: var(--background-color);
			padding: 1rem;
			border-radius: 8px;
			margin-top: 1rem;
			border-right: 4px solid var(--primary-color);
		}

		.help-icon {
			display: inline-block;
			width: 18px;
			height: 18px;
			border-radius: 50%;
			background: var(--primary-color);
			color: white;
			text-align: center;
			line-height: 18px;
			font-size: 12px;
			margin-right: 8px;
			cursor: help;
		}

		@media (max-width: 768px) {
			.comparison-chart {
				height: 200px;
			}
			
			.insurance-recommendations {
				padding: 1rem;
			}
		}
		
		.retirement-calculator,
		.pension-comparison,
		.pension-calculator {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.comparison-table {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-bottom: 2rem;
		}

		.pension-option {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.pension-option:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.pension-option.selected {
			border-color: var(--primary-color);
			background-color: var(--primary-color);
			color: white;
		}

		.pension-details {
			margin-top: 1.5rem;
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
			display: none;
		}

		.calculator-inputs {
			display: grid;
			gap: 1rem;
			margin-bottom: 1.5rem;
		}

		@media (max-width: 768px) {
			.comparison-table {
				grid-template-columns: 1fr;
			}
		}

		.shop-game,
		.allowance-calculator,
		.savings-tracker,
		.games-activities {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.products-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
			gap: 1rem;
			margin: 1rem 0;
		}

		.product-card {
			background: var(--background-color);
			padding: 1rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			text-align: center;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.product-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.activity-cards {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 1.5rem;
		}

		.activity-card {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.activity-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px var(--shadow-color);
		}

		.progress-tracker {
			margin-top: 1.5rem;
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
		}

		@media (max-width: 768px) {
			.activity-cards {
				grid-template-columns: 1fr;
			}
		}
		
		.shopping-planner,
		.apps-showcase,
		.expense-calculator {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.planner-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 2rem;
		}

		.apps-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
		}

		.app-card {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.list-input,
		.compare-input {
			display: flex;
			gap: 1rem;
			margin-bottom: 1rem;
		}

		.transport-calculator {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 2rem;
		}

		@media (max-width: 768px) {
			.planner-grid,
			.apps-grid,
			.transport-calculator {
				grid-template-columns: 1fr;
			}
		}

		.calculator-section {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}
		
		.education-savings-calculator,
		.mortgage-calculator,
		.cash-flow-planner {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.planner-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 2rem;
		}

		.calculator-inputs {
			display: grid;
			gap: 1rem;
			margin-bottom: 1.5rem;
		}

		.income-section,
		.expenses-section {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		@media (max-width: 768px) {
			.planner-grid {
				grid-template-columns: 1fr;
			}
		}

		.analysis-result {
			margin-top: 1.5rem;
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
		}
		
		.cash-flow-recommendations {
			margin-top: 1rem;
			padding: 1rem;
			background-color: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--primary-color);
		}

		.emergency-fund-analysis {
			margin: 1rem 0;
			padding: 1rem;
			background-color: var(--background-color);
			border-radius: 8px;
			border-right: 4px solid var(--accent-color);
		}

		.warning {
			color: var(--warning-color);
			font-weight: bold;
		}

		.success {
			color: var(--success-color);
			font-weight: bold;
		}

		.income-reduction-simulator,
		.debt-exit-planner,
		.lifestyle-planner {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.simulator-inputs,
		.planner-inputs {
			display: grid;
			gap: 1rem;
			margin-bottom: 1.5rem;
		}

		.add-debt-section {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		#debtsList {
			margin: 1rem 0;
		}

		.debt-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 0.5rem;
			background: var(--background-color);
			border-radius: 4px;
			margin-bottom: 0.5rem;
		}

		.debt-item button {
			color: var(--error-color);
			background: none;
			border: none;
			cursor: pointer;
		}

		@media (max-width: 768px) {
			.add-debt-section .input-group {
				display: grid;
				grid-template-columns: 1fr;
				gap: 0.5rem;
			}
		}
		
		.summary-checklist,
		.implementation-plan,
		.next-steps {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-top: 1.5rem;
		}

		.checklist-items {
			display: grid;
			gap: 1rem;
		}

		.checklist-item {
			display: flex;
			align-items: center;
			gap: 1rem;
			padding: 1rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.timeline {
			display: grid;
			gap: 2rem;
			margin-top: 1.5rem;
		}

		.timeline-item {
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
			position: relative;
		}

		.timeline-item::before {
			content: '';
			position: absolute;
			right: -1.5rem;
			top: 50%;
			width: 1rem;
			height: 1rem;
			background: var(--primary-color);
			border-radius: 50%;
		}

		.recommendations-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 1.5rem;
			margin-top: 1.5rem;
		}

		.recommendation-card {
			padding: 1.5rem;
			background: var(--background-color);
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		@media (max-width: 768px) {
			.recommendations-grid {
				grid-template-columns: 1fr;
			}
		}
		
		/* עיצוב כללי לכל שדות הקלט */
		.input-group {
			display: flex;
			flex-direction: row;
			align-items: center;
			gap: 1rem;
			margin-bottom: 1rem;
			width: 100%;
		}

		/* תווית */
		.input-group label {
			min-width: 180px;
			text-align: right;
			font-size: 1rem;
			color: var(--text-color);
		}

		/* שדה קלט */
		.input-group input,
		.input-group select {
			flex: 1;
			padding: 0.75rem 1rem;
			border: 1px solid var(--border-color);
			border-radius: 8px;
			font-size: 1rem;
			color: var(--text-color);
			background: var(--background-color);
			transition: all 0.3s ease;
		}

		/* מצב מעבר עכבר */
		.input-group input:hover,
		.input-group select:hover {
			border-color: var(--primary-color);
		}

		/* מצב מיקוד */
		.input-group input:focus,
		.input-group select:focus {
			outline: none;
			border-color: var(--primary-color);
			box-shadow: 0 0 0 2px rgba(74, 144, 167, 0.2);
		}

		/* עיצוב כפתור */
		.action-button {
			width: 100%;
			padding: 1rem;
			margin-top: 1rem;
			background: var(--primary-color);
			color: white;
			border: none;
			border-radius: 8px;
			font-size: 1rem;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.action-button:hover {
			background: var(--hover-color);
			transform: translateY(-2px);
		}

		/* התאמה למסכים קטנים */
		@media (max-width: 768px) {
			.input-group {
				flex-direction: column;
				align-items: stretch;
			}

			.input-group label {
				margin-bottom: 0.5rem;
			}
		}

		/* עיצוב נוסף לשדות מספריים */
		input[type="number"] {
			-moz-appearance: textfield;
		}

		input[type="number"]::-webkit-outer-spin-button,
		input[type="number"]::-webkit-inner-spin-button {
			-webkit-appearance: none;
			margin: 0;
		}

		/* עיצוב קבוצת שדות */
		.calculator-inputs {
			background: var(--card-background);
			padding: 2rem;
			border-radius: 12px;
			margin-bottom: 2rem;
		}

		/* עיצוב תיבת בחירה */
		select {
			appearance: none;
			padding-right: 2rem;
			background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
			background-repeat: no-repeat;
			background-position: left 0.75rem center;
			background-size: 1em;
		}
		
		/* 4. תיקון התצוגה של ה-navigation */


		.step.completed {
			border-color: var(--success-color);
		}

		.step-title {
			font-weight: 500;
			font-size: 1.1rem;
		}

		.step-details {
			margin-top: 0.5rem;
			padding-right: 2.5rem;
			display: none;
		}

		.substep {
			padding: 0.5rem;
			margin: 0.25rem 0;
			border-radius: 4px;
			background: var(--background-color);
			font-size: 0.9rem;
			transition: background-color 0.3s ease;
		}

		.substep.completed {
			background: var(--success-color);
			color: white;
		}

		@media (max-width: 768px) {
			.steps-list {
				gap: 0.5rem;
			}

			.step {
				padding: 0.75rem;
			}

			.step-title {
				font-size: 1rem;
			}

			.step-details {
				padding-right: 1.5rem;
			}
		}
		
		/* Search Styling */
		.hero-search {
			display: flex;
			justify-content: center;
			gap: 1rem;
		}

		.search-overlay.active {
			opacity: 1;
		}


		.search-overlay.active .search-container {
			transform: translateY(0);
		}

		.search-input-wrapper {
			position: relative;
			margin-bottom: 1.5rem;
		}

		.search-input:focus {
			outline: none;
			border-color: var(--primary-color);
			box-shadow: 0 0 0 3px rgba(74, 144, 167, 0.2);
		}

		.search-icon {
			position: absolute;
			right: 1rem;
			top: 50%;
			transform: translateY(-50%);
			color: var(--text-color);
			opacity: 0.5;
		}


		.search-close:hover {
			background-color: var(--border-color);
		}

		.search-results {
			max-height: 60vh;
			overflow-y: auto;
			padding-right: 0.5rem;
		}

		.search-result {
			padding: 1rem;
			margin-bottom: 0.75rem;
			border-radius: 12px;
			background-color: var(--card-background);
			border: 1px solid var(--border-color);
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.search-result:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 12px var(--shadow-color);
			border-color: var(--primary-color);
		}

		.result-title {
			font-weight: 600;
			color: var(--primary-color);
			margin-bottom: 0.5rem;
			font-size: 1.1rem;
		}

		.result-content {
			color: var(--text-color);
			font-size: 0.95rem;
			line-height: 1.5;
		}

		.highlight {
			background-color: var(--accent-color);
			color: var(--background-color);
			padding: 0.1rem 0.3rem;
			border-radius: 4px;
			margin: 0 0.1rem;
		}

		.no-results {
			text-align: center;
			padding: 2rem;
			color: var(--text-color);
			opacity: 0.7;
		}

		/* Custom Scrollbar */
		.search-results::-webkit-scrollbar {
			width: 8px;
		}

		.search-results::-webkit-scrollbar-track {
			background-color: var(--card-background);
			border-radius: 4px;
		}

		.search-results::-webkit-scrollbar-thumb {
			background-color: var(--primary-color);
			border-radius: 4px;
		}

		.search-results::-webkit-scrollbar-thumb:hover {
			background-color: var(--hover-color);
		}

		/* Search Results Counter */
		.results-count {
			color: var(--text-color);
			opacity: 0.7;
			font-size: 0.9rem;
			margin-bottom: 1rem;
			text-align: right;
		}

		/* Responsive Design */
		@media (max-width: 768px) {
			.search-container {
				width: 95%;
				padding: 1.5rem;
			}

			.search-input {
				font-size: 1rem;
				padding: 0.75rem 2.5rem 0.75rem 0.75rem;
			}

			.search-results {
				max-height: 50vh;
			}

			.result-title {
				font-size: 1rem;
			}

			.result-content {
				font-size: 0.9rem;
			}
		}
		
		/* Progress Button Styles */
		/* Floating Navigation Buttons */
		.floating-nav {
			position: fixed;
			bottom: 2rem;
			left: 2rem;
			display: flex;
			flex-direction: column;
			gap: 1rem;
			z-index: 1000;
		}

		.floating-btn {
			width: 3.5rem;
			height: 3.5rem;
			border: none;
			border-radius: 50%;
			background: var(--background-color);
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
			color: var(--primary-color);
			font-size: 1.5rem;
			padding: 0;
		}

		.floating-btn svg {
			width: 60%;
			height: 60%;
			transition: transform 0.3s ease;
		}

		.floating-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(0,0,0,0.15);
			background: var(--primary-color);
			color: var(--background-color);
		}

		.floating-btn:hover svg {
			transform: scale(1.1);
		}

		.floating-btn:active {
			transform: translateY(0);
		}

		/* Progress Overlay */
		.progress-overlay {
			position: fixed;
			bottom: 5rem;
			left: 2rem;
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 1rem;
			box-shadow: 0 4px 20px rgba(0,0,0,0.15);
			z-index: 999;
			max-width: 300px;
			width: 100%;
			opacity: 0;
			transform: translateY(20px);
			visibility: hidden;
			transition: all 0.3s ease;
		}

		.progress-overlay.visible {
			opacity: 1;
			transform: translateY(0);
			visibility: visible;
		}

		.progress-item {
			margin: 1rem 0;
			padding: 1rem;
			background: var(--card-background);
			border-radius: 0.5rem;
			border: 1px solid var(--border-color);
		}

		.progress-label {
			display: block;
			margin-bottom: 0.5rem;
			color: var(--text-color);
			font-weight: 500;
		}

		.progress-bar {
			width: 100%;
			height: 8px;
			background: var(--border-color);
			border-radius: 4px;
			overflow: hidden;
		}

		.progress-fill {
			height: 100%;
			background: var(--primary-color);
			border-radius: 4px;
			transition: width 0.3s ease;
		}

		/* Media Query for Mobile */
		@media (max-width: 768px) {
			.floating-nav {
				bottom: 1rem;
				left: 1rem;
			}
			
			.floating-btn {
				width: 3rem;
				height: 3rem;
				font-size: 1.2rem;
			}
		}

		/* עדכון סגנונות הניווט */
		.principle-block {
			position: relative;
			scroll-margin-top: 100px; /* מרווח מהכותרת הקבועה */
			transition: all 0.3s ease;
		}

		.principle-block.highlight {
			background-color: var(--hover-color);
			border-radius: 8px;
			box-shadow: 0 0 15px var(--shadow-color);
		}

		.substep {
			position: relative;
			padding: 1rem;
			margin: 0.5rem 0;
			background: var(--card-background);
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.substep::before {
			content: '';
			position: absolute;
			right: -1rem;
			top: 50%;
			transform: translateY(-50%);
			width: 0.5rem;
			height: 0.5rem;
			border-radius: 50%;
			background: var(--border-color);
			transition: all 0.3s ease;
		}

		.substep:hover {
			background: var(--hover-color);
			color: var(--background-color);
			transform: translateX(-0.5rem);
		}

		.substep.active {
			background: var(--primary-color);
			color: var(--background-color);
			transform: translateX(-0.5rem);
		}

		.substep.completed::before {
			background: var(--success-color);
		}

		.substep.active::before {
			background: var(--primary-color);
			width: 0.75rem;
			height: 0.75rem;
		}

		/* אנימציית הדגשה */
		@keyframes highlight {
			0% { background-color: transparent; }
			50% { background-color: var(--hover-color); }
			100% { background-color: transparent; }
		}

		.highlight {
			animation: highlight 2s ease-in-out;
		}
		
		/* עיצוב למבחן הידע */
		.quiz-section {
			background: var(--card-background);
			border-radius: 12px;
			padding: 2rem;
			margin: 2rem 0;
		}

		.question-card {
			display: none;
		}

		.question-card.active {
			display: block;
		}

		.question-header {
			margin-bottom: 1.5rem;
		}

		.options-wrapper {
			display: flex;
			flex-direction: column;
			gap: 1rem;
			margin-bottom: 1.5rem;
		}

		.option {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			padding: 1rem;
			background: var(--background-color);
			border: 1px solid var(--border-color);
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.option:hover {
			background: var(--hover-color);
			color: white;
		}

		.feedback {
			display: none;
			padding: 1rem;
			margin-top: 1rem;
			background: var(--background-color);
			border-radius: 8px;
		}

		.feedback.show {
			display: block;
		}

		.quiz-controls {
			display: flex;
			justify-content: space-between;
			gap: 1rem;
			margin-top: 2rem;
		}

		.nav-btn, .check-btn {
			padding: 0.75rem 1.5rem;
			border: none;
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.nav-btn {
			background: var(--primary-color);
			color: white;
		}

		.check-btn {
			background: var(--accent-color);
			color: white;
			flex: 1;
		}

		.nav-btn:disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}

		.question-card.correct {
			border-right: 4px solid var(--success-color);
		}

		.question-card.incorrect {
			border-right: 4px solid var(--error-color);
		}

		.simulator-section {
			background: var(--card-background);
			border-radius: 12px;
			padding: 2rem;
			margin: 2rem 0;
			box-shadow: 0 4px 20px var(--shadow-color);
		}

		.simulator-container {
			display: grid;
			grid-template-columns: 1fr 2fr;
			gap: 2rem;
			margin-top: 1.5rem;
		}

		.input-panel {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.input-group {
			margin-bottom: 1.5rem;
		}

		.input-group label {
			display: block;
			margin-bottom: 0.5rem;
			color: var(--text-color);
		}

		.input-group input {
			width: 100%;
			padding: 0.75rem;
			border: 1px solid var(--border-color);
			border-radius: 6px;
			background: var(--background-color);
			color: var(--text-color);
		}

		.visualization-panel {
			/* הגדרת מידות למיכל */
			width: 100%;
			max-width: 800px;
			margin: 0 auto;
		}

		.visualization-panel canvas {
			/* הגדרת גובה לגרף */
			height: 300px !important;
			width: 100% !important;
		}

		.results-summary {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 1rem;
			margin-top: 1.5rem;
		}

		.result-card {
			background: var(--card-background);
			padding: 1rem;
			border-radius: 6px;
			text-align: center;
		}

		.result-card .amount {
			font-size: 1.5rem;
			font-weight: bold;
			color: var(--primary-color);
			margin-top: 0.5rem;
		}

		@media (max-width: 768px) {
			.simulator-container {
				grid-template-columns: 1fr;
			}
		}

		.chart-section {
			background: var(--card-background);
			border-radius: 12px;
			padding: 2rem;
			margin: 2rem 0;
			box-shadow: 0 4px 20px var(--shadow-color);
		}

		.chart-controls {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
			gap: 1rem;
			margin-bottom: 2rem;
		}

		.input-group {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
		}

		.input-group input {
			padding: 0.75rem;
			border: 1px solid var(--border-color);
			border-radius: 6px;
			background: var(--background-color);
			color: var(--text-color);
		}

		.charts-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 2rem;
			margin-bottom: 2rem;
		}

		.chart-wrapper {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
			text-align: center;
		}

		.expense-analysis {
			background: var(--background-color);
			padding: 1.5rem;
			border-radius: 8px;
			border: 1px solid var(--border-color);
		}

		.analysis-content {
			margin-top: 1rem;
		}

		@media (max-width: 768px) {
			.charts-grid {
				grid-template-columns: 1fr;
			}
		}

		.concepts-section {
			background: var(--card-background);
			border-radius: 12px;
			padding: 2rem;
			margin: 2rem 0;
			box-shadow: 0 4px 20px var(--shadow-color);
		}

		.concepts-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
			gap: 2rem;
			margin-top: 1.5rem;
		}

		.concept-card {
			background: var(--background-color);
			border-radius: 8px;
			padding: 1.5rem;
			border: 1px solid var(--border-color);
		}

		.concept-title {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.animate-btn {
			background: var(--primary-color);
			color: white;
			padding: 0.5rem 1rem;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.animate-btn:hover {
			background: var(--hover-color);
		}

		.concept-animation {
			display: none;
			margin-top: 1rem;
		}

		.animation-container {
			height: 200px;
			background: var(--card-background);
			border-radius: 8px;
			position: relative;
			overflow: hidden;
			margin-bottom: 1rem;
		}

		.animation-controls {
			display: flex;
			gap: 0.5rem;
			margin-bottom: 1rem;
		}

		.control-btn {
			padding: 0.5rem 1rem;                    /* ריווח פנימי */
			border: 1px solid var(--border-color);   /* מסגרת */
			border-radius: 4px;                      /* פינות מעוגלות */
			background: var(--background-color);     /* צבע רקע */
			color: var(--text-color);               /* צבע טקסט */
			cursor: pointer;                        /* סמן יד בריחוף */
			transition: all 0.3s ease;              /* אנימציית מעבר */
		}

		/* מצב ריחוף */
		.control-btn:hover {
			background: var(--hover-color);         /* שינוי צבע רקע בריחוף */
			color: white;                          /* שינוי צבע טקסט בריחוף */
		}

		/* מצב לחיצה */
		.control-btn:active {
			transform: translateY(1px);            /* אפקט לחיצה */
		}

		/* מצב נבחר */
		.control-btn.active {
			background: var(--primary-color);      /* צבע רקע כשהכפתור פעיל */
			color: white;                          /* צבע טקסט כשהכפתור פעיל */
			border-color: var(--primary-color);    /* צבע מסגרת כשהכפתור פעיל */
		}
		
		.question-card {
			display: none;
		}

		.question-card.active {
			display: block;
		}

		.quiz-navigation {
		display: flex;
			justify-content: space-between;
			align-items: center;
			margin-top: 2rem;
		}

		.nav-btn {
			padding: 0.5rem 1rem;
			border: 1px solid var(--border-color);
			border-radius: 4px;
			background: var(--background-color);
			color: var(--text-color);
			cursor: pointer;
		}

		.nav-btn:disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}

		/* אנימציית מעבר */
		.question-card {
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		.question-card.active {
			opacity: 1;
		}
		
		.check-answer-btn:disabled {
			opacity: 0.5;
			cursor: not-allowed;
			background: var(--border-color);
		}

		.nav-btn:not(:disabled) {
			background: var(--primary-color);
			color: white;
		}

		.option input[type="radio"]:disabled + .option-content {
			cursor: not-allowed;
			opacity: 0.7;
		}

    </style>
</head>
<body>
     <div class="loading" id="loading"></div>
    
	  <div class="search-overlay" id="searchOverlay">
		<div class="search-container">
			<input 
				type="text" 
				id="searchInput" 
				class="search-input" 
				placeholder="חפש נושא..." 
				autocomplete="off"
			/>
			<div id="searchResults" class="search-results"></div>
			<button class="search-close" onclick="toggleSearch()">×</button>
		</div>
	</div>
			
    <header>
        <div class="container header-content">
            <div class="logo">חינוך פיננסי משפחתי</div>
            <button class="nav-toggle" aria-label="Toggle navigation">☰</button>
            <!-- <nav>
                <a href="#intro">מבוא</a>
                <a href="#budget">תקציב</a>
                <a href="#savings">חיסכון</a>
                <a href="#investment">השקעות</a>
                <a href="#education">חינוך פיננסי</a>
            </nav> -->
            <button class="theme-toggle" aria-label="Toggle theme">🌓</button>
        </div>
    </header>

    <main>
        <div class="container">
            <section class="hero">
                <h1>ברוכים הבאים לחינוך פיננסי משפחתי</h1>
                <p>גלו כיצד לנהל את הכספים המשפחתיים בצורה חכמה ואחראית</p>
                <div class="hero-buttons">
                    <button class="cta-button" onclick="scrollToContent()">התחל ללמוד</button>
                    <button class="secondary-button" onclick="toggleSearch()">חפש נושא</button>
                </div>
            </section>
			
			<div class="steps-navigation">
				<div class="steps-progress">
					<div class="progress-bar">
						<div class="progress-indicator" id="totalProgress"></div>
					</div>
					<span class="progress-text" id="progressText">0% הושלם</span>
				</div>
				<div class="steps-list">
					<!-- שלב 1: מבוא -->
					<div class="step active" data-step="intro">
						<span class="step-number">1</span>
						<span class="step-title">מבוא לחינוך פיננסי</span>
						<div class="step-details">
							<div class="substep" data-section="basics" data-chapter="intro">יסודות הכלכלה המשפחתית</div>
							<div class="substep" data-section="goals" data-chapter="intro">הגדרת מטרות פיננסיות</div>
							<div class="substep" data-section="mindset" data-chapter="intro">פיתוח חשיבה כלכלית</div>
						</div>
					</div>

					<!-- שלב 2: תקציב -->
					<div class="step" data-step="budget">
						<span class="step-number">2</span>
						<span class="step-title">ניהול תקציב</span>
						<div class="step-details">
							<div class="substep" data-section="income">הכנסות והוצאות</div>
							<div class="substep" data-section="planning">תכנון תקציבי</div>
							<div class="substep" data-section="tracking">מעקב ובקרה</div>
							<div class="substep" data-section="optimization">ייעול תקציבי</div>
						</div>
					</div>

					<!-- שלב 3: חיסכון -->
					<div class="step" data-step="savings">
						<span class="step-number">3</span>
						<span class="step-title">חיסכון והשקעות</span>
						<div class="step-details">
							<div class="substep" data-section="emergency">קרן חירום</div>
							<div class="substep" data-section="investment-basics">יסודות ההשקעות</div>
							<div class="substep" data-section="investment-types">סוגי השקעות והתאמת סיכון</div>
							<div class="substep" data-section="savings-plans">תוכניות חיסכון</div>
							<div class="substep" data-section="kids" data-related="kids-education">חיסכון לילדים</div>
						</div>
					</div>

					<!-- שלב 4: ביטוח -->
					<div class="step" data-step="insurance">
						<span class="step-number">4</span>
						<span class="step-title">ביטוח וניהול סיכונים</span>
						<div class="step-details">
							<div class="substep" data-section="life">ביטוח חיים</div>
							<div class="substep" data-section="health">ביטוח בריאות</div>
							<div class="substep" data-section="property">ביטוח רכוש</div>
							<div class="substep" data-section="disability">אובדן כושר עבודה וסיעוד</div>
						</div>
					</div>

					<!-- שלב 5: חינוך פיננסי -->
					<div class="step" data-step="kids-education">
						<span class="step-number">5</span>
						<span class="step-title">חינוך פיננסי לילדים</span>
						<div class="step-details">
							<div class="substep" data-section="basics">יסודות לילדים</div>
							<div class="substep" data-section="allowance">דמי כיס</div>
							<div class="substep" data-section="savings" data-related="savings">חיסכון לילדים</div>
							<div class="substep" data-section="activities">פעילויות חינוכיות</div>
						</div>
					</div>

					<!-- שלב 6: ניהול חובות -->
					<div class="step" data-step="debt">
						<span class="step-number">6</span>
						<span class="step-title">ניהול חובות ואשראי</span>
						<div class="step-details">
							<div class="substep" data-section="credit">ניהול אשראי</div>
							<div class="substep" data-section="mortgage">משכנתא</div>
							<div class="substep" data-section="debt-management">ניהול חובות</div>
							<div class="substep" data-section="refinance">מיחזור הלוואות</div>
							<div class="substep" data-section="recovery">שיקום פיננסי</div>
						</div>
					</div>

					<!-- שלב 7: תכנון פרישה -->
					<div class="step" data-step="retirement">
						<span class="step-number">7</span>
						<span class="step-title">תכנון פרישה</span>
						<div class="step-details">
							<div class="substep" data-section="pension">פנסיה</div>
							<div class="substep" data-section="investments">השקעות לפרישה</div>
							<div class="substep" data-section="planning">תכנון פיננסי</div>
							<div class="substep" data-section="lifestyle">תכנון אורח חיים</div>
						</div>
					</div>

					<!-- שלב 8: סיכום ויישום -->
					<div class="step" data-step="summary">
						<span class="step-number">8</span>
						<span class="step-title">סיכום ויישום</span>
						<div class="step-details">
							<div class="substep" data-section="review">סקירה כללית</div>
							<div class="substep" data-section="action-plan">תוכנית פעולה</div>
							<div class="substep" data-section="next-steps">צעדים הבאים</div>
							<div class="substep" data-section="resources">משאבים נוספים</div>
						</div>
					</div>
				</div>
			</div>


          

            <section id="intro" class="content-section">			
				<div class="chapter-navigation">
					<h2>מבוא לחינוך פיננסי</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>
							
                <div class="content-block theory">
					<div id="intro-basics" class="principle-block">
						<h4>מהו חינוך פיננסי?</h4>
						<div class="principle-block">
							<p>חינוך פיננסי הוא תהליך למידה המאפשר הבנה ושליטה בניהול הכספים המשפחתיים. המטרה היא להקנות כלים לניהול חכם של המשאבים הכלכליים כדי להשיג ביטחון כלכלי ולהגשים מטרות אישיות ומשפחתיות.</p>
							
							<h5>למה זה חשוב?</h5>
							<ul class="main-principles">
								<li>
									<strong>יצירת יציבות כלכלית</strong>
									<p>הבנה טובה של ניהול הכסף מסייעת להימנע מחובות מיותרים וליצור עתיד כלכלי בטוח.</p>
								</li>
								<li>
									<strong>הפחתת מתחים במשפחה</strong>
									<p>תכנון כלכלי נכון מפחית קונפליקטים ומאפשר התמקדות בדברים החשובים.</p>
								</li>
								<li>
									<strong>דוגמה אישית לילדים</strong>
									<p>ילדים לומדים מתוך דוגמה. הורים המתנהלים כלכלית בחוכמה מעניקים כלים לחיים יציבים לילדיהם.</p>
								</li>
							</ul>
						</div>
					</div>

					<div class="practical-example">
						<h5>דוגמה מעשית: משפחת ישראלי</h5>
						<div class="example-grid">
							<div class="income-section">
								<h6>המצב ההתחלתי:</h6>
								<ul>
									<li>הוצאות לא מתוכננות</li>
									<li>חוסר מעקב אחר תקציב</li>
									<li>מתח כלכלי במשפחה</li>
								</ul>
							</div>
							<div class="expenses-section">
								<h6>לאחר יישום חינוך פיננסי:</h6>
								<ul>
									<li>תקציב חודשי מסודר</li>
									<li>קרן חירום של 30,000 ₪</li>
									<li>שיפור באווירה המשפחתית</li>
								</ul>
							</div>
						</div>
					</div>

					<div id="intro-goals" class="principle-block">
						<h5>הצבת מטרות כלכליות משפחתיות</h5>
						<p>המטרות הכלכליות הן אבן היסוד לתכנון נכון. הן מספקות כיוון ברור להתנהלות המשפחתית.</p>

						<div class="example-grid">
							<div class="principle-content">
								<h6>עקרונות SMART להגדרת מטרות:</h6>
								<ul>
									<li><strong>ספציפיות</strong> - למשל, "לחסוך 20,000 ש"ח לחופשה משפחתית"</li>
									<li><strong>מדידות</strong> - יכולת לעקוב אחר ההתקדמות</li>
									<li><strong>ברות-השגה</strong> - מטרות ריאליות שניתן לעמוד בהן</li>
									<li><strong>רלוונטיות</strong> - תורמות לשיפור חיי המשפחה</li>
									<li><strong>מתוזמנות</strong> - עם לוח זמנים ברור להשגה</li>
								</ul>
							</div>
						</div>
						
						<div class="practical-example">
							<h6>דוגמה מעשית: תכנון חופשה משפחתית</h6>
							<div class="example-grid">
								<div class="step-by-step">
									<div class="step">
										<strong>1. הגדרת המטרה</strong>
										<p>חיסכון 20,000 ₪ לחופשה בעוד שנה</p>
									</div>
									<div class="step">
										<strong>2. תכנית פעולה</strong>
										<p>חיסכון 1,700 ₪ בחודש</p>
									</div>
									<div class="step">
										<strong>3. שיתוף המשפחה</strong>
										<p>כל בן משפחה תורם לחיסכון</p>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="advanced-tips">
						<div id="intro-mindset" class="advanced-tips">
							<h5>יצירת תודעה פיננסית משפחתית</h5>
							<p>תודעה פיננסית היא ההבנה שההתנהלות הכלכלית של כל אחד משפיעה על המצב הכלכלי הכולל של המשפחה.</p>

							<div class="tips-grid">
								<div class="tip-item" dir="rtl">
									<strong>שיתוף פעולה</strong>
									<p>שיתוף המשפחה בקבלת החלטות</p>
								</div>
								<div class="tip-item" dir="rtl">
									<strong>שיחה פתוחה</strong>
									<p>דיון משפחתי על נושאי כסף</p>
								</div>
								<div class="tip-item" dir="rtl">
									<strong>למידה חווייתית</strong>
									<p>משחקים ופעילויות לניהול תקציב</p>
								</div>
							</div>
						</div>
							
						<div class="practical-example">
							<h6>דוגמה מעשית: חינוך פיננסי בפעולה</h6>
							<div class="example-cards">
								<div class="example-card">
									<strong>משחק חנות משפחתית</strong>
									<p>הורה מסביר לילדים על ניהול תקציב דרך משחק תפקידים של חנות</p>
								</div>
								<div class="example-card">
									<strong>חיסכון באנרגיה</strong>
									<p>הילדים לומדים על חיסכון בחשמל ומים ורואים את ההשפעה על החשבונות</p>
								</div>
								<div class="example-card">
									<strong>קניות חכמות</strong>
									<p>המשפחה מתכננת יחד את קניות הסופרמרקט ומשווה מחירים</p>
								</div>
							</div>
						</div>
					</div>
					
					<!-- מבנה המבחן המעודכן -->
					<div class="quiz-section">
						<h4>בחן את עצמך</h4>
						<div class="quiz-container">
							<div class="questions-wrapper">
								<!-- שאלה 1 -->
								<div class="question-card active" data-question="1">
									<div class="question-header">
										<h5>שאלה 1 מתוך 2</h5>
										<p>מהו אחוז החיסכון המומלץ מההכנסה החודשית?</p>
									</div>
									<div class="options-wrapper">
										<label class="option">
											<input type="radio" name="q1" value="a">
											<span>10%</span>
										</label>
										<label class="option">
											<input type="radio" name="q1" value="b">
											<span>20%</span>
										</label>
										<label class="option">
											<input type="radio" name="q1" value="c">
											<span>30%</span>
										</label>
									</div>
									<div class="feedback-wrapper">
										<div class="feedback" data-value="a">קרוב, אבל מומלץ יותר.</div>
										<div class="feedback" data-value="b">נכון מאוד! 20% היא המלצה מקובלת לחיסכון.</div>
										<div class="feedback" data-value="c">זה אחוז גבוה מדי שעלול להקשות על ההתנהלות השוטפת.</div>
									</div>
								</div>

								<!-- שאלה 2 -->
								<div class="question-card" data-question="2">
									<div class="question-header">
										<h5>שאלה 2 מתוך 2</h5>
										<p>מהי המטרה העיקרית של קרן חירום?</p>
									</div>
									<div class="options-wrapper">
										<label class="option">
											<input type="radio" name="q2" value="a">
											<span>הגנה מפני הוצאות לא צפויות</span>
										</label>
										<label class="option">
											<input type="radio" name="q2" value="b">
											<span>השקעה לטווח ארוך</span>
										</label>
										<label class="option">
											<input type="radio" name="q2" value="c">
											<span>חיסכון לפנסיה</span>
										</label>
									</div>
									<div class="feedback-wrapper">
										<div class="feedback" data-value="a">נכון מאוד! קרן חירום נועדה להתמודדות עם הוצאות בלתי צפויות.</div>
										<div class="feedback" data-value="b">לא נכון, השקעות לטווח ארוך הן מטרה נפרדת מקרן חירום.</div>
										<div class="feedback" data-value="c">לא נכון, חיסכון לפנסיה הוא מטרה ארוכת טווח שונה מקרן חירום.</div>
									</div>
								</div>
							</div>

							<div class="quiz-controls">
								<button class="nav-btn prev-btn" disabled>הקודם</button>
								<button class="check-btn">בדוק תשובה</button>
								<button class="nav-btn next-btn">הבא</button>
							</div>
						</div>
					</div>
															
				</div>
            </section>
			
			<section id="budget" class="content-section">
				<div class="chapter-navigation">
					<h2>ניהול תקציב</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>שלבים לבניית תקציב משפחתי</h4>
						<p>תקציב משפחתי הוא כלי המאפשר ניהול הכנסות והוצאות בצורה מסודרת כדי למנוע גירעון, לחסוך ולהגשים מטרות. הוא כולל תכנון מראש וחלוקה נכונה של המשאבים הכספיים.</p>
						
						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>1. רישום כל ההכנסות:</strong>
									<ul>
										<li>הכנסות קבועות (משכורת, קצבאות, דיבידנדים)</li>
										<li>הכנסות משתנות (בונוסים, עבודה צדדית)</li>
									</ul>
								</li>
								<li>
									<strong>2. רישום כל ההוצאות:</strong>
									<ul>
										<li>הוצאות קבועות (שכירות, משכנתא, חשבונות)</li>
										<li>הוצאות משתנות (קניות, בילויים)</li>
									</ul>
								</li>
								<li>
									<strong>3. חישוב ההפרש:</strong>
									<ul>
										<li>הכנסות פחות הוצאות</li>
										<li>אם יש גירעון, יש לבדוק היכן ניתן לקצץ</li>
									</ul>
								</li>
								<li>
									<strong>4. הגדרת קטגוריות לתקציב:</strong>
									<ul>
										<li>צרכים בסיסיים (דיור, מזון, בריאות) – 50%</li>
										<li>חיסכון והשקעות – 20%</li>
										<li>פנאי והנאה – 30%</li>
									</ul>
								</li>
							</ul>
						</div>
					</div>

					<div class="practical-example">
						<h5>דוגמה מעשית - תכנון תקציב משפחתי:</h5>
						<p>משפחה עם הכנסה חודשית של 20,000 ש"ח תבנה תקציב כך:</p>
						<div class="example-grid">
							<div class="budget-category">
								<strong>צרכים בסיסיים - 50%</strong>
								<p>10,000 ש"ח</p>
								<ul>
									<li>דיור</li>
									<li>מזון</li>
									<li>בריאות</li>
								</ul>
							</div>
							<div class="budget-category">
								<strong>חיסכון והשקעות - 20%</strong>
								<p>4,000 ש"ח</p>
							</div>
							<div class="budget-category">
								<strong>פנאי והנאה - 30%</strong>
								<p>6,000 ש"ח</p>
							</div>
						</div>
					</div>

					<div class="tracking-tools">
						<h4>כלים למעקב אחר הוצאות והכנסות</h4>
						<p>מעקב שוטף חשוב כדי לוודא שהמשפחה עומדת בתקציב ולא סוטה ממנו. המעקב מאפשר זיהוי מוקדם של בעיות וביצוע התאמות נדרשות.</p>
						
						<div class="tools-grid">
							<div class="tool-item" dir="rtl">
								<strong>אפליקציות לניהול תקציב</strong>
								<p>למשל, You Need a Budget, PocketGuard. מאפשרות מעקב בזמן אמת אחר ההוצאות.</p>
							</div>
							<div class="tool-item" dir="rtl">
								<strong>גיליונות אקסל מותאמים</strong>
								<p>מעקב מסודר אחר הכנסות והוצאות עם יכולת ניתוח מתקדמת.</p>
							</div>
							<div class="tool-item" dir="rtl">
								<strong>מחברות ויומני הוצאות</strong>
								<p>לתיעוד ידני מסודר של כל ההוצאות וההכנסות.</p>
							</div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמעדכנת את ההוצאות שלה באפליקציה יכולה לראות בקלות אם היא קרובה לחריגה בתקציב הבילויים ולנקוט צעדים לפני החריגה.</p>
						</div>
					</div>

					<div class="interactive-exercise">
						<h4>תרגיל: בדיקת איזון תקציבי</h4>
						<div class="budget-calculator">
							<div class="calculator-section">
								<h6>הכנסות חודשיות</h6>
								<div class="input-group">
									<label>סך הכנסות:</label>
									<input type="number" id="totalIncome" class="budget-input" />
								</div>
							</div>
							
							<div class="calculator-results">
								<h6>התפלגות מומלצת:</h6>
								<div id="recommendedSplit"></div>
							</div>
							<button class="action-button" onclick="calculateBudgetSplit()">חשב חלוקה מומלצת</button>
						</div>
					</div>
					
					<!-- גרף דינמי להמחשת התפלגות הוצאות -->
					<div class="chart-section">
						<h4>התפלגות הוצאות משפחתיות</h4>
						<div class="chart-container">
							<div class="chart-controls">
								<div class="input-group">
									<label>דיור:</label>
									<input type="number" id="housingExpense" value="4000" min="0" step="100">
								</div>
								<div class="input-group">
									<label>מזון:</label>
									<input type="number" id="foodExpense" value="3000" min="0" step="100">
								</div>
								<div class="input-group">
									<label>תחבורה:</label>
									<input type="number" id="transportExpense" value="1500" min="0" step="100">
								</div>
								<div class="input-group">
									<label>בילויים ופנאי:</label>
									<input type="number" id="leisureExpense" value="1000" min="0" step="100">
								</div>
								<div class="input-group">
									<label>חינוך:</label>
									<input type="number" id="educationExpense" value="2000" min="0" step="100">
								</div>
							</div>
							
							<div class="charts-grid">
								<div class="chart-wrapper">
									<canvas id="expensesPie"></canvas>
									<h6>התפלגות באחוזים</h6>
								</div>
								<div class="chart-wrapper">
									<canvas id="expensesBar"></canvas>
									<h6>השוואה בשקלים</h6>
								</div>
							</div>
							
							<div class="expense-analysis">
								<h5>ניתוח הוצאות</h5>
								<div class="analysis-content" id="analysisContent"></div>
							</div>
						</div>
					</div>
					
				</div>
			</section>
			
			<section id="savings" class="content-section">
				<div class="chapter-navigation">
					<h2>חיסכון והשקעות</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך לבנות קרן חירום?</h4>
						<div class="principle-content">
							<p>קרן חירום היא חיסכון ייעודי למצבי חירום בלתי צפויים כמו אובדן עבודה, הוצאות רפואיות או תיקונים דחופים בבית. הקרן מעניקה שקט נפשי וביטחון כלכלי.</p>
							<ul class="main-principles">
								<li>
									<strong>חישוב הצרכים:</strong>
									<ul>
										<li>סכום הקרן המומלץ: 3-6 חודשים של הוצאות חודשיות קבועות</li>
										<li>לדוגמה, אם ההוצאות החודשיות הן 10,000 ש"ח, קרן החירום המומלצת תהיה 30,000-60,000 ש"ח</li>
									</ul>
								</li>
								<li>
									<strong>חיסכון הדרגתי:</strong>
									<ul>
										<li>קביעת סכום חיסכון חודשי קבוע (לדוגמה, 1,000 ש"ח לחודש)</li>
										<li>שמירה על עקביות גם בהוצאות לא מתוכננות</li>
									</ul>
								</li>
								<li>
									<strong>שמירה במקום נגיש:</strong>
									<ul>
										<li>חשבון חיסכון נפרד או פיקדון נזיל</li>
										<li>הימנעות מהשקעה בסיכון גבוה כדי להבטיח נזילות</li>
									</ul>
								</li>
							</ul>
							
							<div class="example-box">
								<h5>דוגמה מעשית:</h5>
								<p>משפחה מתחילה להפריש 1,500 ש"ח לחודש לקרן חירום ובתוך שנתיים צוברת 36,000 ש"ח. הקרן מאפשרת להם להתמודד עם תיקון רכב יקר ללא לקיחת הלוואה.</p>
							</div>
							
							<div class="emergency-fund-calculator">
								<h5>מחשבון קרן חירום</h5>
								<div class="calculator-inputs">
									<div class="input-group">
										<label>הוצאות חודשיות קבועות:</label>
										<input type="number" id="monthlyExpenses" class="calc-input" placeholder="למשל: 10,000">
									</div>
									<div class="input-group">
										<label>מספר חודשי כיסוי רצויים (3-6):</label>
										<input type="number" id="monthsCover" class="calc-input" min="3" max="6" value="3">
									</div>
									<button class="action-button" onclick="calculateEmergencyFund()">חשב קרן חירום נדרשת</button>
								</div>
								<div id="emergencyFundResult" class="calculator-result"></div>
							</div>
							
						</div>
					</div>

					<div class="principle-block">
						<h4>2. סוגי השקעות ומתי לבחור בהן</h4>
						<p>השקעות מאפשרות להגדיל את ההון לאורך זמן ולהשיג מטרות כלכליות ארוכות טווח. חשוב להתאים את סוג ההשקעה לצרכים ולפרופיל הסיכון של המשפחה.</p>
						
						<div class="investment-types-grid">
							<div class="investment-type">
								<h5>השקעות סולידיות</h5>
								<ul>
									<li>קופות גמל להשקעה</li>
									<li>אג"ח ממשלתיות</li>
									<li>פיקדונות בנקאיים</li>
								</ul>
								<p>מתאימות למשפחות שמעדיפות סיכון נמוך</p>
							</div>

							<div class="investment-type">
								<h5>השקעות מניבות</h5>
								<ul>
									<li>מניות</li>
									<li>קרנות נאמנות</li>
									<li>נדל"ן</li>
								</ul>
								<p>מתאימות למשפחות המחפשות תשואה גבוהה ויכולות להתמודד עם סיכון</p>
							</div>

							<div class="investment-type">
								<h5>השקעות אלטרנטיביות</h5>
								<ul>
									<li>הלוואות חברתיות</li>
									<li>קרנות הון סיכון</li>
								</ul>
								<p>מתאימות למשפחות מנוסות בשוק ההון המחפשות לגוון את ההשקעות</p>
							</div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שרוצה לחסוך לחתונת הילדים בעוד 15 שנה משקיעה בתיק מניות מגוון, תוך איזון עם קופות גמל להשקעה.</p>
						</div>
						
						<div class="investment-simulator">
							<h5>סימולטור השקעות</h5>
							<div class="investment-type-selector">
								<div class="investment-option" onclick="selectInvestmentType('solid')">
									<h6>השקעות סולידיות</h6>
									<ul>
										<li>סיכון נמוך</li>
										<li>תשואה שנתית: 3-5%</li>
										<li>מתאים לטווח קצר-בינוני</li>
									</ul>
								</div>
								<div class="investment-option" onclick="selectInvestmentType('balanced')">
									<h6>השקעות מניבות</h6>
									<ul>
										<li>סיכון בינוני</li>
										<li>תשואה שנתית: 6-10%</li>
										<li>מתאים לטווח בינוני-ארוך</li>
									</ul>
								</div>
								<div class="investment-option" onclick="selectInvestmentType('aggressive')">
									<h6>השקעות אלטרנטיביות</h6>
									<ul>
										<li>סיכון גבוה</li>
										<li>תשואה שנתית: 10%+</li>
										<li>מתאים לטווח ארוך</li>
									</ul>
								</div>
							</div>
							<div class="investment-calculator">
								<div class="input-group">
									<label>סכום השקעה חודשי:</label>
									<input type="number" id="monthlyInvestment" class="calc-input">
								</div>
								<div class="input-group">
									<label>תקופת השקעה (שנים):</label>
									<input type="number" id="investmentYears" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateInvestment()">חשב צפי תשואה</button>
							</div>
							<div id="investmentResult" class="calculator-result"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. חינוך ילדים לחשיבות החיסכון</h4>
						<p>לימוד ילדים לחסוך מגיל צעיר עוזר להם לפתח הרגלים כלכליים טובים לעתיד.</p>
						
						<div class="education-methods">
							<div class="method-item">
								<strong>דמי כיס</strong>
								<ul>
									<li>הענקת סכום חודשי מוגדר לילדים</li>
									<li>עידוד הילדים להפריש אחוז קבוע לחיסכון</li>
								</ul>
							</div>
							
							<div class="method-item">
								<strong>הצבת מטרות חיסכון</strong>
								<ul>
									<li>למשל, חיסכון לרכישת צעצוע או משחק</li>
									<li>חישוב משותף כמה זמן ייקח להגיע למטרה</li>
								</ul>
							</div>
							
							<div class="method-item">
								<strong>חשבון חיסכון לילדים</strong>
								<ul>
									<li>פתיחת חשבון בנק מיוחד</li>
									<li>למידת מושגי יסוד בנקאיים</li>
								</ul>
							</div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>ילד שחוסך דמי כיס לקניית אופניים חדשים לומד לתכנן מראש ולהעריך את מאמצי החיסכון.</p>
						</div>
						
						<div class="kids-savings-tracker">
							<h5>מעקב חיסכון לילדים</h5>
							<div class="savings-goal-setter">
								<div class="input-group">
									<label>מטרת החיסכון:</label>
									<input type="text" id="savingsGoal" class="text-input" placeholder="למשל: אופניים חדשים">
								</div>
								<div class="input-group">
									<label>סכום נדרש:</label>
									<input type="number" id="targetAmount" class="calc-input">
								</div>
								<div class="input-group">
									<label>חיסכון חודשי:</label>
									<input type="number" id="monthlySaving" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateSavingsGoal()">חשב זמן להשגת המטרה</button>
							</div>
							<div id="savingsResult" class="calculator-result"></div>
							<div class="progress-visualizer">
								<div id="savingsProgress" class="progress-bar"></div>
							</div>
						</div>
					</div>
					
					<!-- סימולטור השקעות אינטראקטיבי -->
					<div class="simulator-section">
						<h4>סימולטור השקעות</h4>
						<div class="simulator-container">
							<div class="input-panel">
								<div class="input-group">
									<label>סכום התחלתי להשקעה:</label>
									<input type="number" id="initialAmount" min="0" step="1000" value="10000">
								</div>
								<div class="input-group">
									<label>הפקדה חודשית:</label>
									<input type="number" id="monthlyDeposit" min="0" step="100" value="500">
								</div>
								<div class="input-group">
									<label>תשואה שנתית צפויה (%):</label>
									<input type="number" id="expectedReturn" min="0" max="20" step="0.5" value="4">
								</div>
								<div class="input-group">
									<label>תקופת השקעה (שנים):</label>
									<input type="number" id="investmentPeriod" min="1" max="50" step="1" value="10">
								</div>
							</div>
							
							<div class="visualization-panel">
								<!-- הגדרת גובה באמצעות class במקום ישירות על ה-canvas -->
								<canvas id="growthChart"></canvas>
								<div class="results-summary">
									<div class="result-card">
										<h6>סכום סופי צפוי</h6>
										<div class="amount" id="finalAmount">0 ₪</div>
									</div>
									<div class="result-card">
										<h6>רווח צפוי</h6>
										<div class="amount" id="totalProfit">0 ₪</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>

			<section id="debt" class="content-section">
				<div class="chapter-navigation">
					<h2>ניהול חובות ואשראי</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך להימנע מהצטברות חובות?</h4>
						<p>חובות יכולים להיות הכרחיים במצבים מסוימים, אך הצטברותם ללא שליטה עלולה להוביל לקשיים כלכליים חמורים. התנהלות פיננסית מושכלת יכולה למנוע חובות לא רצויים.</p>
						
						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>תכנון תקציב:</strong>
									<ul>
										<li>הקפדה על תקציב משפחתי מאוזן</li>
										<li>מניעת הוצאות מיותרות והתמקדות בצרכים בסיסיים</li>
									</ul>
								</li>
								<li>
									<strong>שימוש מחושב באשראי:</strong>
									<ul>
										<li>הימנעות משימוש מוגזם בכרטיסי אשראי</li>
										<li>תשלום מלא של יתרת החוב החודשית למניעת ריביות גבוהות</li>
									</ul>
								</li>
								<li>
									<strong>קרן חירום:</strong>
									<ul>
										<li>שימוש בכספי קרן חירום למצבי חירום במקום להסתמך על הלוואות</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמפעילה תקציב ומעקבת אחר הוצאותיה מגלה שהיא יכולה לקצץ בעלויות בילויים ולמנוע שימוש מיותר בכרטיס אשראי.</p>
						</div>

						<div class="debt-analyzer">
							<h5>מחשבון בריאות פיננסית</h5>
							<div class="analyzer-inputs">
								<div class="input-group">
									<label>הכנסה חודשית נטו:</label>
									<input type="number" id="monthlyIncome" class="calc-input">
								</div>
								<div class="input-group">
									<label>סך תשלומי חובות חודשיים:</label>
									<input type="number" id="monthlyDebts" class="calc-input">
								</div>
								<button class="action-button" onclick="analyzeDebtRatio()">בדוק יחס חוב-הכנסה</button>
							</div>
							<div id="debtAnalysis" class="analysis-result"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. ניהול כרטיסי אשראי בצורה חכמה</h4>
						<p>כרטיסי אשראי הם כלי נוח לניהול תשלומים, אך השימוש הלא נכון בהם עלול להוביל לחובות מיותרים.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>הגבלת מספר כרטיסים:</strong>
									<ul>
										<li>שימוש בכרטיס אחד או שניים בלבד כדי לשלוט בהוצאות</li>
									</ul>
								</li>
								<li>
									<strong>מעקב אחר תשלומים:</strong>
									<ul>
										<li>בדיקת דוחות חודשיים כדי לוודא שאין חיובים לא מוכרים</li>
										<li>הימנעות מתשלומים רבים המובילים לריביות</li>
									</ul>
								</li>
								<li>
									<strong>בחירת כרטיס עם הטבות רלוונטיות:</strong>
									<ul>
										<li>בחירת כרטיסים עם נקודות לטיסות, הנחות בקניות, או הטבות דומות שמתאימות לצרכים המשפחתיים</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמבקרת מדי שנה בחו"ל בוחרת כרטיס אשראי המעניק נקודות לנוסע המתמיד וכך חוסכת כסף על טיסות.</p>
						</div>
						
						<div class="credit-cards-simulator">
							<h5>סימולטור ניהול אשראי</h5>
							<div class="credit-scenario">
								<label>בחר תרחיש:</label>
								<select id="creditScenario" onchange="simulateCredit()">
									<option value="full">תשלום מלא בכל חודש</option>
									<option value="minimum">תשלום מינימום</option>
									<option value="partial">תשלום חלקי</option>
								</select>
								<div class="input-group">
									<label>סכום החיוב:</label>
									<input type="number" id="creditCharge" class="calc-input">
								</div>
								<button class="action-button" onclick="simulateCredit()">הצג השפעה</button>
							</div>
							<div id="creditSimulation" class="simulation-result"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. מיחזור הלוואות - מתי ולמה?</h4>
						<p>מיחזור הלוואות הוא תהליך שבו מחליפים הלוואה קיימת באחרת בתנאים טובים יותר. הוא יכול להקטין את הריבית, להפחית את ההחזר החודשי, או לקצר את תקופת ההלוואה.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>מתי כדאי למחזר?</strong>
									<ul>
										<li>כאשר הריביות בשוק נמוכות משמעותית מהריבית על ההלוואה הקיימת</li>
										<li>אם המצב הפיננסי השתפר וניתן לשלם החזרים גבוהים יותר</li>
										<li>כשיש מספר הלוואות שניתן לאחד להלוואה אחת</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמחזירה הלוואת רכב עם ריבית גבוהה מחליפה אותה בהלוואה עם ריבית נמוכה יותר, וכך חוסכת 200 ש"ח בחודש.</p>
						</div>

						<div class="loan-calculator">
							<h5>מחשבון כדאיות מיחזור הלוואה</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>יתרת הלוואה נוכחית:</label>
									<input type="number" id="currentLoanAmount" class="calc-input">
								</div>
								<div class="input-group">
									<label>ריבית נוכחית (%):</label>
									<input type="number" id="currentInterest" class="calc-input">
								</div>
								<div class="input-group">
									<label>ריבית מוצעת למיחזור (%):</label>
									<input type="number" id="newInterest" class="calc-input">
								</div>
								<div class="input-group">
									<label>תקופה נותרת (חודשים):</label>
									<input type="number" id="remainingMonths" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateRefinance()">בדוק כדאיות</button>
							</div>
							<div id="refinanceResults" class="calculator-result"></div>
						</div>
					</div>
				</div>
			</section>
			
			<section id="insurance" class="content-section">
				<div class="chapter-navigation">
					<h2>ביטוח וניהול סיכונים</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. ביטוחים בסיסיים שכל משפחה צריכה</h4>
						<p>ביטוחים הם כלים חשובים לניהול סיכונים, המספקים הגנה כלכלית במצבי חירום בלתי צפויים. משפחה צריכה להבטיח שהביטוחים שלה מכסים את הסיכונים העיקריים שהיא עלולה להתמודד איתם.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>ביטוח בריאות:</strong>
									<ul>
										<li>כיסוי לטיפולים רפואיים שלא מכוסים בסל הבריאות הציבורי</li>
										<li>הרחבות אפשריות: תרופות יקרות, ניתוחים בחו"ל</li>
									</ul>
								</li>
								<li>
									<strong>ביטוח חיים:</strong>
									<ul>
										<li>הגנה כלכלית לבני המשפחה במקרה של פטירת אחד מהמפרנסים</li>
										<li>קביעת סכום הפיצוי בהתאם להכנסות ולצרכים של המשפחה</li>
									</ul>
								</li>
								<li>
									<strong>ביטוח דירה:</strong>
									<ul>
										<li>כיסוי למבנה ותכולה במקרה של נזק כמו שריפה או גניבה</li>
										<li>חשוב לבדוק האם הפוליסה כוללת גם נזק לצד שלישי</li>
									</ul>
								</li>
								<li>
									<strong>ביטוח רכב:</strong>
									<ul>
										<li>חובה על פי חוק לבעלי רכב</li>
										<li>מומלץ לשקול גם ביטוח צד ג' וביטוח מקיף</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שגרה באזור עם סיכון גבוה לרעידות אדמה מוסיפה הרחבה לביטוח הדירה שלה, וכך נמנעת מהוצאות גבוהות במקרה של נזק למבנה.</p>
						</div>

						<div class="insurance-calculator">
							<h5>מחשבון כיסוי ביטוחי למשפחה</h5>
							<div class="calculator-section">
								<div class="input-group">
									<label>הכנסה משפחתית חודשית:</label>
									<input type="number" id="familyIncome" class="calc-input">
								</div>
								<div class="input-group">
									<label>שווי דירה:</label>
									<input type="number" id="houseValue" class="calc-input">
								</div>
								<div class="input-group">
									<label>מספר ילדים:</label>
									<input type="number" id="childrenCount" class="calc-input" min="0">
								</div>
								<div class="input-group">
									<label>שווי תכולת דירה:</label>
									<input type="number" id="contentValue" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateInsuranceNeeds()">חשב המלצות כיסוי</button>
							</div>
							<div id="insuranceRecommendations" class="calculator-result"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. השוואת פוליסות וכיסויים</h4>
						<p>השוואת פוליסות ביטוח היא חיונית כדי להבטיח שהמשפחה מקבלת את הכיסוי הטוב ביותר במחיר המשתלם ביותר.</p>

						<div class="policy-comparison-tool">
							<h5>מחשבון השוואת פוליסות</h5>
							<div class="comparison-grid">
								<div class="policy-input">
									<h6>פוליסה א'</h6>
									<div class="input-group">
										<label>פרמיה חודשית:</label>
										<input type="number" id="premium1" class="calc-input">
									</div>
									<div class="input-group">
										<label>גובה כיסוי:</label>
										<input type="number" id="coverage1" class="calc-input">
									</div>
									<div class="input-group">
										<label>השתתפות עצמית:</label>
										<input type="number" id="deductible1" class="calc-input">
									</div>
								</div>
								<div class="policy-input">
									<h6>פוליסה ב'</h6>
									<div class="input-group">
										<label>פרמיה חודשית:</label>
										<input type="number" id="premium2" class="calc-input">
									</div>
									<div class="input-group">
										<label>גובה כיסוי:</label>
										<input type="number" id="coverage2" class="calc-input">
									</div>
									<div class="input-group">
										<label>השתתפות עצמית:</label>
										<input type="number" id="deductible2" class="calc-input">
									</div>
								</div>
							</div>
							<button class="action-button" onclick="comparePolicies()">השווה פוליסות</button>
							<div id="policyComparison" class="comparison-result"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. תכנון פיננסי למצבי חירום</h4>
						<p>תכנון פיננסי למצבי חירום כולל בניית אסטרטגיה להתמודדות עם אירועים לא צפויים כמו אובדן עבודה, מחלה קשה או תאונות.</p>

						<div class="emergency-plan-builder">
							<h5>בונה תכנית חירום משפחתית</h5>
							<div class="plan-steps">
								<div class="step-input">
									<h6>1. הערכת צרכים בסיסיים</h6>
									<div class="input-group">
										<label>הוצאות חודשיות הכרחיות:</label>
										<input type="number" id="basicExpenses" class="calc-input">
									</div>
								</div>
								<div class="step-input">
									<h6>2. מקורות תמיכה</h6>
									<div class="checkbox-group">
										<label><input type="checkbox" id="savings"> חסכונות</label>
										<label><input type="checkbox" id="insurance"> ביטוח אובדן כושר עבודה</label>
										<label><input type="checkbox" id="family"> תמיכה משפחתית</label>
									</div>
								</div>
								<div class="step-input">
									<h6>3. תקופת כיסוי רצויה (חודשים)</h6>
									<input type="range" id="coveragePeriod" min="3" max="12" value="6">
									<span id="periodDisplay">6 חודשים</span>
								</div>
								<button class="action-button" onclick="buildEmergencyPlan()">צור תכנית חירום</button>
							</div>
							<div id="emergencyPlan" class="plan-result"></div>
						</div>
					</div>
				</div>
			</section>

			<section id="retirement" class="content-section">
				<div class="chapter-navigation">
					<h2>תכנון פרישה</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך לתכנן את הפנסיה המשפחתית?</h4>
						<p>תכנון פרישה הוא תהליך חשוב המבטיח הכנסה מספקת לשמירה על רמת חיים טובה לאחר סיום הקריירה. התכנון כולל חישוב הצרכים הפיננסיים, ניהול השקעות לטווח הארוך, ובחירה נכונה של מוצרים פנסיוניים.</p>

						<div class="retirement-calculator">
							<h5>מחשבון תכנון פרישה</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>גיל נוכחי:</label>
									<input type="number" id="currentAge" class="calc-input" min="20" max="67">
								</div>
								<div class="input-group">
									<label>גיל פרישה מתוכנן:</label>
									<input type="number" id="retirementAge" class="calc-input" min="60" max="80" value="67">
								</div>
								<div class="input-group">
									<label>הכנסה חודשית נטו:</label>
									<input type="number" id="monthlyIncome" class="calc-input">
								</div>
								<div class="input-group">
									<label>חסכונות קיימים:</label>
									<input type="number" id="currentSavings" class="calc-input">
								</div>
								<div class="input-group">
									<label>אחוז הפרשה חודשי:</label>
									<input type="number" id="monthlySavingRate" class="calc-input" min="0" max="100" value="20">
								</div>
								<button class="action-button" onclick="calculateRetirement()">חשב תחזית פרישה</button>
							</div>
							<div id="retirementResults" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>זוג שמתכנן פרישה בעוד 20 שנה מחשב שהוצאותיהם יהיו כ-15,000 ש"ח בחודש. הם מזהים פער של 3,000 ש"ח בין הכנסותיהם הצפויות לבין צרכיהם ומתחילים להפריש לחיסכון נוסף.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. השוואה בין מסלולי חיסכון פנסיוני</h4>
						<p>בחירת המוצר הפנסיוני המתאים תלויה בצרכים, בגיל, ובמטרות הפיננסיות. כל מוצר מציע יתרונות וחסרונות שיש להביא בחשבון.</p>

						<div class="pension-comparison">
							<div class="comparison-table">
								<div class="pension-option" onclick="showPensionDetails('fund')">
									<h6>קרן פנסיה</h6>
									<ul>
										<li>דמי ניהול נמוכים</li>
										<li>כיסוי ביטוחי מובנה</li>
										<li>ניהול מקצועי של ההשקעות</li>
									</ul>
								</div>
								<div class="pension-option" onclick="showPensionDetails('insurance')">
									<h6>ביטוח מנהלים</h6>
									<ul>
										<li>גמישות בבחירת מסלולים</li>
										<li>אפשרות להתאמה אישית</li>
										<li>קבלת קצבה מובטחת</li>
									</ul>
								</div>
								<div class="pension-option" onclick="showPensionDetails('provident')">
									<h6>קופת גמל</h6>
									<ul>
										<li>גמישות במשיכת הכספים</li>
										<li>אפשרויות השקעה מגוונות</li>
										<li>הטבות מס אטרקטיביות</li>
									</ul>
								</div>
							</div>
							<div id="pensionDetails" class="pension-details"></div>
						</div>

						<div class="pension-calculator">
							<h5>מחשבון השוואת מסלולים</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>סכום הפקדה חודשי:</label>
									<input type="number" id="monthlyDeposit" class="calc-input">
								</div>
								<div class="input-group">
									<label>גיל תחילת חיסכון:</label>
									<input type="number" id="startAge" class="calc-input">
								</div>
								<div class="input-group">
									<label>תקופת חיסכון (שנים):</label>
									<input type="number" id="savingPeriod" class="calc-input">
								</div>
								<button class="action-button" onclick="comparePensionPlans()">השווה מסלולים</button>
							</div>
							<div id="pensionComparison" class="comparison-result"></div>
						</div>
					</div>
				</div>
			</section>

			<section id="kids-education" class="content-section">
				<div class="chapter-navigation">
					<h2>חינוך פיננסי לילדים</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך ללמד ילדים על כסף?</h4>
						<p>חינוך פיננסי מגיל צעיר מסייע לילדים לפתח הבנה נכונה על כסף, חיסכון, והשקעה. זה מקנה להם כלים להתנהלות עצמאית ואחראית כבוגרים.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>שיחה פתוחה על כסף:</strong>
									<ul>
										<li>הסבירו לילדים מאיפה מגיע הכסף והחשיבות של עבודה וחיסכון</li>
										<li>הציגו להם את התקציב המשפחתי באופן שמותאם לגילם</li>
									</ul>
								</li>
								<li>
									<strong>מעורבות בקבלת החלטות קטנות:</strong>
									<ul>
										<li>שתפו את הילדים בהחלטות פשוטות</li>
										<li>למשל, תכנון תקציב לחופשה משפחתית או קניית מתנה</li>
									</ul>
								</li>
								<li>
									<strong>דוגמאות אישיות:</strong>
									<ul>
										<li>הראו דוגמה אישית לניהול פיננסי נבון</li>
										<li>למשל, חיסכון לפני קנייה גדולה</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="interactive-learning">
							<h5>משחק למידה: חנות משפחתית</h5>
							<div class="shop-game">
								<div class="shop-inventory">
									<h6>מוצרים בחנות:</h6>
									<div class="products-grid" id="shopProducts"></div>
								</div>
								<div class="shopping-cart">
									<h6>עגלת קניות</h6>
									<div id="cart-items"></div>
									<div class="cart-total">
										<span>סה"כ: </span>
										<span id="cartTotal">0</span>
										<span>₪</span>
									</div>
									<div class="wallet">
										<span>כסף זמין: </span>
										<span id="availableMoney">100</span>
										<span>₪</span>
									</div>
									<button class="action-button" onclick="checkout()">לקופה</button>
								</div>
							</div>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. דמי כיס - למה וכמה?</h4>
						<p>דמי כיס הם דרך מעשית ללמד ילדים לנהל כסף. הם מקנים להם חופש החלטה ומלמדים אותם להתמודד עם תקציב מוגבל.</p>

						<div class="allowance-calculator">
							<h5>מחשבון דמי כיס מומלצים</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>גיל הילד/ה:</label>
									<input type="number" id="childAge" class="calc-input" min="6" max="18">
								</div>
								<div class="input-group">
									<label>תדירות (שבועי/חודשי):</label>
									<select id="frequency" class="calc-input">
										<option value="weekly">שבועי</option>
										<option value="monthly">חודשי</option>
									</select>
								</div>
								<div class="input-group">
									<label>הכנסה משפחתית:</label>
									<select id="incomeLevel" class="calc-input">
										<option value="low">מתחת לממוצע</option>
										<option value="medium">ממוצעת</option>
										<option value="high">מעל הממוצע</option>
									</select>
								</div>
								<button class="action-button" onclick="calculateAllowance()">חשב המלצה</button>
							</div>
							<div id="allowanceResult" class="calculator-result"></div>
						</div>

						<div class="savings-tracker">
							<h5>מעקב חיסכון ילדים</h5>
							<div class="tracker-inputs">
								<div class="input-group">
									<label>מטרת החיסכון:</label>
									<input type="text" id="savingGoal" class="text-input">
								</div>
								<div class="input-group">
									<label>מחיר היעד:</label>
									<input type="number" id="targetPrice" class="calc-input">
								</div>
								<div class="input-group">
									<label>חיסכון שבועי:</label>
									<input type="number" id="weeklySaving" class="calc-input">
								</div>
								<button class="action-button" onclick="trackSavings()">עקוב אחר התקדמות</button>
							</div>
							<div id="savingsProgress" class="progress-tracker"></div>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. משחקים ופעילויות ללמידה חווייתית</h4>
						<p>משחקים ופעילויות חווייתיות הם דרך כיפית להעביר מסרים פיננסיים. הם משפרים את ההבנה של מושגים פיננסיים ומחברים את הילדים לנושא בצורה מעשית.</p>

						<div class="games-activities">
							<div class="activity-cards">
								<div class="activity-card" onclick="showActivityDetails('store')">
									<h6>משחק "חנות"</h6>
									<p>משחק תפקידים המלמד על ערך הכסף וקבלת החלטות</p>
								</div>
								<div class="activity-card" onclick="showActivityDetails('budget')">
									<h6>תכנון תקציב משפחתי</h6>
									<p>פעילות משפחתית לתכנון הוצאות והכנסות</p>
								</div>
								<div class="activity-card" onclick="showActivityDetails('investment')">
									<h6>משחק השקעות</h6>
									<p>למידה על חיסכון והשקעה דרך משחק</p>
								</div>
							</div>
							<div id="activityDetails" class="activity-details"></div>
						</div>
					</div>
				</div>
			</section>

			<section id="daily-expenses" class="content-section">
				<div class="chapter-navigation">
					<h2>ניהול הוצאות יומיות</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך לחסוך בקניות בסופרמרקט?</h4>
						<p>קניות בסופרמרקט הן אחת ההוצאות הקבועות במשפחה, אך ניתן לחסוך בהן משמעותית על ידי תכנון חכם והימנעות מרכישות לא נחוצות.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>רשימת קניות מראש:</strong>
									<ul>
										<li>הכינו רשימה מדויקת של המוצרים הנדרשים</li>
										<li>תכננו מראש את הארוחות השבועיות</li>
									</ul>
								</li>
								<li>
									<strong>השוואת מחירים:</strong>
									<ul>
										<li>בדקו מחירים באפליקציות השוואת מחירים</li>
										<li>בדקו מבצעים שבועיים ברשתות השיווק</li>
									</ul>
								</li>
								<li>
									<strong>הימנעות ממותגים יקרים:</strong>
									<ul>
										<li>נסו מוצרים של מותגי הבית</li>
										<li>השוו מחירים בין מותגים שונים</li>
									</ul>
								</li>
								<li>
									<strong>קנייה בכמויות גדולות:</strong>
									<ul>
										<li>במוצרים לא מתכלים, קנייה בכמויות גדולות מוזילה את המחיר ליחידה</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="shopping-planner">
							<h5>מתכנן קניות חכם</h5>
							<div class="planner-grid">
								<div class="shopping-list">
									<h6>רשימת קניות</h6>
									<div class="list-input">
										<input type="text" id="itemName" placeholder="שם המוצר">
										<input type="number" id="itemQuantity" placeholder="כמות">
										<input type="number" id="itemPrice" placeholder="מחיר משוער">
										<button onclick="addToList()">הוסף לרשימה</button>
									</div>
									<ul id="shoppingList"></ul>
									<div id="listTotal"></div>
								</div>
								<div class="price-compare">
									<h6>השוואת מחירים</h6>
									<div class="compare-input">
										<input type="text" id="productName" placeholder="שם המוצר">
										<button onclick="comparePrice()">בדוק מחירים</button>
									</div>
									<div id="priceComparison"></div>
								</div>
							</div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמשווה מחירים באמצעות אפליקציה מזהה שמחיר הביצים בסופרמרקט הקרוב גבוה ב-15% מאשר ברשת אחרת ומחליטה לבצע את הקנייה במקום הזול יותר.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. שימוש באפליקציות והשוואת מחירים</h4>
						<p>בעידן הטכנולוגי, אפליקציות ייעודיות מאפשרות לחסוך זמן וכסף על ידי השוואת מחירים בזמן אמת, מעקב אחר מבצעים, וניהול הוצאות.</p>

						<div class="apps-showcase">
							<h5>אפליקציות מומלצות</h5>
							<div class="apps-grid">
								<div class="app-card">
									<h6>השוואת מחירים</h6>
									<ul>
										<li>Pricez</li>
										<li>Walla Shops</li>
										<li>השוואת מחירים ברשתות</li>
									</ul>
								</div>
								<div class="app-card">
									<h6>ניהול תקציב</h6>
									<ul>
										<li>Money Lover</li>
										<li>Spendee</li>
										<li>מעקב הוצאות והכנסות</li>
									</ul>
								</div>
								<div class="app-card">
									<h6>מבצעים והנחות</h6>
									<ul>
										<li>כמה?!</li>
										<li>סופר דיל</li>
										<li>מעקב אחר מבצעים</li>
									</ul>
								</div>
							</div>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. ניהול הוצאות על תחבורה ותקשורת</h4>
						<p>הוצאות על תחבורה ותקשורת הן חלק בלתי נפרד מההוצאות היומיות, אך ניתן לחסוך גם בהן בעזרת כלים ותכנון.</p>

						<div class="expense-calculator">
							<h5>מחשבון הוצאות תחבורה</h5>
							<div class="transport-calculator">
								<div class="calculator-section">
									<h6>רכב פרטי</h6>
									<div class="input-group">
										<label>צריכת דלק (ק"מ לליטר):</label>
										<input type="number" id="fuelEfficiency" class="calc-input">
									</div>
									<div class="input-group">
										<label>מרחק יומי (ק"מ):</label>
										<input type="number" id="dailyDistance" class="calc-input">
									</div>
									<div class="input-group">
										<label>מחיר דלק לליטר:</label>
										<input type="number" id="fuelPrice" class="calc-input">
									</div>
								</div>
								<div class="calculator-section">
									<h6>תחבורה ציבורית</h6>
									<div class="input-group">
										<label>מחיר חופשי חודשי:</label>
										<input type="number" id="monthlyPass" class="calc-input">
									</div>
								</div>
								<button class="action-button" onclick="compareTransportCosts()">השווה עלויות</button>
								<div id="transportComparison" class="comparison-result"></div>
							</div>
						</div>
					</div>
				</div>
			</section>
			
			<section id="long-term" class="content-section">
				<div class="chapter-navigation">
					<h2>תכנון לטווח ארוך</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. חיסכון לחינוך ילדים</h4>
						<p>השקעה בחינוך הילדים היא אחת ההוצאות המשמעותיות ביותר במשפחה. תכנון מוקדם מאפשר להורים להבטיח שהמשאבים הכלכליים יעמדו לרשותם בעת הצורך.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>פתיחת תוכנית חיסכון ייעודית:</strong>
									<ul>
										<li>קופת גמל להשקעה או פיקדון בנקאי</li>
										<li>התחלת חיסכון מוקדם לניצול אפקט הריבית דריבית</li>
									</ul>
								</li>
								<li>
									<strong>השקעה בתוכניות גמישות:</strong>
									<ul>
										<li>חיסכון לפי הצורך (קורסים, חוגים, השכלה גבוהה)</li>
									</ul>
								</li>
								<li>
									<strong>מעורבות הילדים בתהליך:</strong>
									<ul>
										<li>הסברה על החיסכון המיועד לעתידם</li>
										<li>עידוד להשתתפות באמצעות דמי כיס</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="education-savings-calculator">
							<h5>מחשבון חיסכון לחינוך</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>גיל הילד/ה כיום:</label>
									<input type="number" id="childCurrentAge" class="calc-input" min="0" max="18">
								</div>
								<div class="input-group">
									<label>יעד חיסכון כולל:</label>
									<select id="educationGoal" class="calc-input">
										<option value="degree">תואר אקדמי (150,000 ₪)</option>
										<option value="professional">הכשרה מקצועית (50,000 ₪)</option>
										<option value="custom">סכום מותאם אישית</option>
									</select>
								</div>
								<div class="input-group" id="customAmountGroup" style="display: none;">
									<label>סכום מותאם אישית:</label>
									<input type="number" id="customAmount" class="calc-input">
								</div>
								<div class="input-group">
									<label>סכום חיסכון חודשי:</label>
									<input type="number" id="monthlySaving" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateEducationSavings()">חשב תחזית חיסכון</button>
							</div>
							<div id="educationSavingsResult" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה פותחת תוכנית חיסכון בקופת גמל להשקעה לילדיה עם הפקדה חודשית של 500 ש"ח. לאחר 18 שנים, יש להם כ-120,000 ש"ח לכל ילד ללימודים אקדמיים.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. תכנון לקניית דירה</h4>
						<p>קניית דירה היא אחת המטרות הפיננסיות המרכזיות במשפחות רבות. תכנון מדויק עוזר להבטיח שההשקעה מתבצעת באופן יציב וללא סיכון מיותר.</p>

						<div class="mortgage-calculator">
							<h5>מחשבון תכנון רכישת דירה</h5>
							<div class="calculator-inputs">
								<div class="input-group">
									<label>מחיר דירה משוער:</label>
									<input type="number" id="propertyPrice" class="calc-input">
								</div>
								<div class="input-group">
									<label>הון עצמי קיים:</label>
									<input type="number" id="currentSavings" class="calc-input">
								</div>
								<div class="input-group">
									<label>חיסכון חודשי אפשרי:</label>
									<input type="number" id="monthlySavingAmount" class="calc-input">
								</div>
								<div class="input-group">
									<label>הכנסה משפחתית נטו:</label>
									<input type="number" id="familyIncome" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateMortgage()">בדוק תכנית רכישה</button>
							</div>
							<div id="mortgageResult" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שחוסכת 5,000 ש"ח בחודש במשך 8 שנים צוברת הון עצמי של 480,000 ש"ח, המספיק לרכישת דירה במחיר של 1.92 מיליון ש"ח.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. ניהול תזרים מזומנים לתקופות בלתי צפויות</h4>
						<p>ניהול תזרים מזומנים לטווח ארוך מאפשר למשפחה להתמודד עם אירועים בלתי צפויים כמו אובדן הכנסה, שינויים במצב הבריאותי או תיקונים דחופים.</p>

						<div class="cash-flow-planner">
							<h5>מתכנן תזרים מזומנים</h5>
							<div class="planner-grid">
								<div class="income-section">
									<h6>הכנסות קבועות</h6>
									<div class="input-group">
										<label>משכורת 1:</label>
										<input type="number" id="salary1" class="calc-input">
									</div>
									<div class="input-group">
										<label>משכורת 2:</label>
										<input type="number" id="salary2" class="calc-input">
									</div>
									<div class="input-group">
										<label>הכנסות נוספות:</label>
										<input type="number" id="otherIncome" class="calc-input">
									</div>
								</div>
								<div class="expenses-section">
									<h6>הוצאות קבועות</h6>
									<div class="input-group">
										<label>משכנתא/שכ"ד:</label>
										<input type="number" id="housing" class="calc-input">
									</div>
									<div class="input-group">
										<label>הוצאות קבועות אחרות:</label>
										<input type="number" id="fixedExpenses" class="calc-input">
									</div>
									<div class="input-group">
										<label>הוצאות משתנות:</label>
										<input type="number" id="variableExpenses" class="calc-input">
									</div>
								</div>
							</div>
							<button class="action-button" onclick="analyzeCashFlow()">נתח תזרים מזומנים</button>
							<div id="cashFlowAnalysis" class="analysis-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שמשלבת השקעות נזילות עם קרן חירום מצליחה להתמודד עם הוצאה בלתי צפויה של 20,000 ש"ח לתיקון רכב לאחר תאונה.</p>
						</div>
					</div>
				</div>
			</section>

			<section id="real-cases" class="content-section">
				<div class="chapter-navigation">
					<h2>דוגמאות למקרים מציאותיים</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>1. איך להתמודד עם הפחתת הכנסה במשפחה?</h4>
						<p>מצבים כמו פיטורים, ירידה בהיקף משרה או שינוי בהכנסות עשויים לגרום לקושי כלכלי זמני. עם תכנון נכון, ניתן להתמודד עם המשבר מבלי לפגוע באופן משמעותי באורח החיים.</p>

						<div class="principle-content">
							<ul class="main-principles">
								<li>
									<strong>ניתוח מחדש של התקציב:</strong>
									<ul>
										<li>זיהוי הוצאות לא הכרחיות וקיצוץ זמני בהן</li>
										<li>למשל: צמצום בילויים או שימוש במוצרי מותרות</li>
									</ul>
								</li>
								<li>
									<strong>הפעלת קרן חירום:</strong>
									<ul>
										<li>שימוש בקרן חירום לכיסוי ההוצאות הבסיסיות עד לשיפור המצב</li>
									</ul>
								</li>
								<li>
									<strong>חיפוש מקורות הכנסה נוספים:</strong>
									<ul>
										<li>עבודות זמניות, פרויקטים פרילנסריים</li>
										<li>מכירת פריטים שאינם בשימוש</li>
									</ul>
								</li>
							</ul>
						</div>

						<div class="income-reduction-simulator">
							<h5>סימולטור התמודדות עם ירידה בהכנסה</h5>
							<div class="simulator-inputs">
								<div class="input-group">
									<label>הכנסה חודשית נוכחית:</label>
									<input type="number" id="currentIncome" class="calc-input">
								</div>
								<div class="input-group">
									<label>אחוז ירידה בהכנסה:</label>
									<input type="number" id="incomeReductionPercent" class="calc-input" min="0" max="100">
								</div>
								<div class="input-group">
									<label>קרן חירום קיימת:</label>
									<input type="number" id="emergencyFund" class="calc-input">
								</div>
								<div class="input-group">
									<label>הוצאות קבועות:</label>
									<input type="number" id="fixedExpenses" class="calc-input">
								</div>
								<button class="action-button" onclick="simulateIncomeReduction()">חשב תכנית התמודדות</button>
							</div>
							<div id="reductionPlan" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה שבה אחד ההורים איבד את עבודתו קיצצה 20% מהוצאותיה על פנאי ובילויים, השתמשה בקרן החירום למימון ההוצאות הבסיסיות, ובמקביל חיפשה מקורות הכנסה חלופיים.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>2. יציאה מחובות משמעותיים</h4>
						<p>יציאה מחובות דורשת תהליך מסודר ותכנון מדויק על מנת להפחית את העול הכלכלי ולמנוע חזרה למצב דומה בעתיד.</p>

						<div class="debt-exit-planner">
							<h5>מתכנן יציאה מחובות</h5>
							<div class="planner-inputs">
								<div class="add-debt-section">
									<h6>הוסף חוב:</h6>
									<div class="input-group">
										<input type="text" id="debtName" placeholder="סוג החוב">
										<input type="number" id="debtAmount" placeholder="סכום">
										<input type="number" id="interestRate" placeholder="ריבית שנתית %" min="0" max="100">
										<button onclick="addDebt()">הוסף</button>
									</div>
								</div>
								<div id="debtsList"></div>
								<div class="input-group">
									<label>סכום פנוי להחזר חודשי:</label>
									<input type="number" id="monthlyPayment" class="calc-input">
								</div>
								<button class="action-button" onclick="calculateDebtPayoff()">צור תכנית החזר</button>
							</div>
							<div id="debtPayoffPlan" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה עם חובות של 200,000 ש"ח מפזרת את החובות שלה על פני הלוואה מאוחדת עם ריבית נמוכה יותר, ומשלמת כל חודש סכום מוגדר כדי להבטיח יציבות כלכלית.</p>
						</div>
					</div>

					<div class="principle-block">
						<h4>3. שיפור איכות החיים הכלכלית</h4>
						<p>גם במשפחות שבהן המצב הכלכלי יציב, שיפור איכות החיים הכלכלית דורש איזון חכם בין חיסכון להוצאות על פנאי והנאה.</p>

						<div class="lifestyle-planner">
							<h5>מתכנן איכות חיים פיננסית</h5>
							<div class="planner-inputs">
								<div class="input-group">
									<label>הכנסה חודשית נטו:</label>
									<input type="number" id="monthlyNetIncome" class="calc-input">
								</div>
								<div class="input-group">
									<label>חיסכון חודשי נוכחי:</label>
									<input type="number" id="currentSavings" class="calc-input">
								</div>
								<div class="input-group">
									<label>תקציב פנאי נוכחי:</label>
									<input type="number" id="leisureBudget" class="calc-input">
								</div>
								<button class="action-button" onclick="optimizeLifestyle()">קבל המלצות לשיפור</button>
							</div>
							<div id="lifestyleRecommendations" class="calculator-result"></div>
						</div>

						<div class="example-box">
							<h5>דוגמה מעשית:</h5>
							<p>משפחה מחליטה להשקיע בשיפוץ המטבח, תוך הקצאת תקציב ברור למטרה, ותוך שמירה על 20% מההכנסות החודשיות כחיסכון לטווח ארוך.</p>
						</div>
					</div>
				</div>
			</section>
						
			<section id="summary" class="content-section">
				<div class="chapter-navigation">
					<h2>סיכום המדריך והמלצות להמשך יישום</h2>
					<div class="progress-wrapper">
						<div class="progress-bar">
							<div class="progress-indicator" style="width: 0%"></div>
						</div>
						<span class="progress-text">0% הושלם</span>
					</div>
				</div>

				<div class="content-block theory">
					<div class="principle-block">
						<h4>סיכום כללי</h4>
						<p>המדריך שהכנו מעניק כלים ותובנות להתנהלות כלכלית חכמה ונכונה לכל המשפחה. הוא מכסה את כל תחומי החיים הפיננסיים -- החל מהבנה בסיסית של חינוך פיננסי ועד ניהול השקעות ותכנון פרישה.</p>

						<div class="summary-checklist">
							<h5>רשימת בדיקה ליישום</h5>
							<div class="checklist-items">
								<div class="checklist-item">
									<input type="checkbox" id="budgetCheck">
									<label for="budgetCheck">בניית תקציב משפחתי</label>
									<div class="item-status"></div>
								</div>
								<div class="checklist-item">
									<input type="checkbox" id="savingsCheck">
									<label for="savingsCheck">הקמת קרן חירום</label>
									<div class="item-status"></div>
								</div>
								<div class="checklist-item">
									<input type="checkbox" id="insuranceCheck">
									<label for="insuranceCheck">בדיקת כיסויים ביטוחיים</label>
									<div class="item-status"></div>
								</div>
								<div class="checklist-item">
									<input type="checkbox" id="retirementCheck">
									<label for="retirementCheck">תכנון פרישה</label>
									<div class="item-status"></div>
								</div>
								<div class="checklist-item">
									<input type="checkbox" id="kidsEducationCheck">
									<label for="kidsEducationCheck">תכנית חיסכון לילדים</label>
									<div class="item-status"></div>
								</div>
								<button class="action-button" onclick="checkProgress()">בדוק התקדמות</button>
							</div>
							<div id="progressSummary" class="progress-summary"></div>
						</div>

						<div class="implementation-plan">
							<h5>תוכנית פעולה להתחלה</h5>
							<div class="timeline">
								<div class="timeline-item">
									<div class="timeline-header">חודש ראשון</div>
									<ul>
										<li>הכנת רשימה מלאה של ההכנסות וההוצאות המשפחתיות</li>
										<li>קביעת מטרות כלכליות לטווח הקצר, הבינוני והארוך</li>
									</ul>
								</div>
								<div class="timeline-item">
									<div class="timeline-header">חודש שני</div>
									<ul>
										<li>בניית תקציב משפחתי מפורט לפי הקטגוריות</li>
										<li>התחלת מעקב אחרי ההוצאות וניהול דוחות חודשיים</li>
									</ul>
								</div>
								<div class="timeline-item">
									<div class="timeline-header">חודש שלישי ואילך</div>
									<ul>
										<li>התחלת חיסכון לקרן חירום או הגדלת ההפרשה לקרנות קיימות</li>
										<li>בחינת השקעות לטווח ארוך שמתאימות לפרופיל המשפחתי</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="next-steps">
							<h5>המלצות להמשך יישום</h5>
							<div class="recommendations-grid">
								<div class="recommendation-card">
									<h6>מעקב ובקרה שוטפים</h6>
									<p>התנהלות כלכלית נכונה דורשת ניטור שוטף של ההוצאות וההכנסות, ובחינת העמידה ביעדים</p>
								</div>
								<div class="recommendation-card">
									<h6>שיתוף בני המשפחה</h6>
									<p>ודאו שכל בני המשפחה מעורבים ומבינים את ההחלטות הכלכליות, כולל ילדים, בהתאם לגילם</p>
								</div>
								<div class="recommendation-card">
									<h6>התאמת התוכנית למצבים משתנים</h6>
									<p>החיים דינמיים, וחשוב לעדכן את התוכנית הכלכלית בהתאם לשינויים במצב המשפחתי, התעסוקתי או הבריאותי</p>
								</div>
							</div>
						</div>

						<div class="progress-tracker">
							<button class="action-button" onclick="startTracking()">התחל מעקב התקדמות</button>
							<div id="trackingResults" class="tracking-results"></div>
						</div>
					</div>
				</div>
			</section>
			
        </div>
    </main>

    <!-- Replace the existing floating-nav div with this structure -->
	<div class="floating-nav">
		<button class="floating-btn" onclick="scrollToTop()" id="scrollTopBtn" title="חזור למעלה">
			<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
				<path d="M18 15l-6-6-6 6"/>
			</svg>
		</button>
		<!-- <button class="floating-btn" onclick="toggleProgressBar()" id="progressBtn" title="הצג התקדמות">
			<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
				<path d="M18 20V10"/>
				<path d="M12 20V4"/>
				<path d="M6 20v-6"/>
			</svg>
		</button> -->
	</div>

	<div class="progress-overlay" id="progressOverlay">
		<h6>התקדמות בלימוד</h6>
		<div class="progress-item">
			<span class="progress-label">התקדמות כללית</span>
			<div class="progress-bar">
				<div class="progress-fill" id="totalProgressBar"></div>
			</div>
		</div>
		<div class="progress-item">
			<span class="progress-label">פרק נוכחי</span>
			<div class="progress-bar">
				<div class="progress-fill" id="chapterProgressBar"></div>
			</div>
		</div>
	</div>

    <div class="progress-bar" id="progressBar">
        <div class="progress-indicator"></div>
    </div>

    <script>
	
		// מציאת ה-step המתאים לפי id של הפרק
		const stepMap = {
			// פרקים ראשיים
			'intro': 0,
			'budget': 1,
			'savings': 2,
			'insurance': 3,
			'kids-education': 4,
			'debt': 5,
			'retirement': 6,
			'summary': 7,
			'daily-expenses': 8,
			'long-term': 9,
			'real-cases': 10,

			// תתי-פרקים של מבוא
			'intro-basics': 0,
			'intro-goals': 0,
			'intro-mindset': 0,

			// תתי-פרקים של תקציב
			'budget-income': 1,
			'budget-planning': 1,
			'budget-tracking': 1,
			'budget-optimization': 1,

			// תתי-פרקים של חיסכון
			'savings-emergency': 2,
			'savings-investment-basics': 2,
			'savings-investment-types': 2,
			'savings-plans': 2,
			'savings-kids': 2,

			// תתי-פרקים של ביטוח
			'insurance-life': 3,
			'insurance-health': 3,
			'insurance-property': 3,
			'insurance-disability': 3,

			// תתי-פרקים של חינוך פיננסי לילדים
			'kids-education-basics': 4,
			'kids-education-allowance': 4,
			'kids-education-savings': 4,
			'kids-education-activities': 4,

			// תתי-פרקים של ניהול חובות
			'debt-credit': 5,
			'debt-mortgage': 5,
			'debt-management': 5,
			'debt-refinance': 5,
			'debt-recovery': 5,

			// תתי-פרקים של פרישה
			'retirement-pension': 6,
			'retirement-investments': 6,
			'retirement-planning': 6,
			'retirement-lifestyle': 6,

			// תתי-פרקים של סיכום
			'summary-review': 7,
			'summary-action-plan': 7,
			'summary-next-steps': 7,
			'summary-resources': 7,

			// תתי-פרקים של הוצאות יומיות
			'daily-expenses-supermarket': 8,
			'daily-expenses-apps': 8,
			'daily-expenses-transport': 8,

			// תתי-פרקים של תכנון לטווח ארוך
			'long-term-education': 9,
			'long-term-house': 9,
			'long-term-cashflow': 9,

			// תתי-פרקים של מקרים מציאותיים
			'real-cases-income': 10,
			'real-cases-debt': 10,
			'real-cases-lifestyle': 10
		};
				
		let stepsManager = {
			currentStep: 0,
			steps: ['intro', 'budget', 'savings', 'insurance', 'kids-education', 'debt', 'retirement', 'summary'],
			
			init: function() {
				this.updateUI();
				this.attachEventListeners();
				this.loadProgress();
				this.goToStep(0); // מציג את השלב הראשון בטעינה
			},
			
			updateProgress: function() {
				const progress = this.calculateProgress();
				document.getElementById('totalProgress').style.width = `${progress}%`;
				document.getElementById('progressText').textContent = `${Math.round(progress)}% הושלם`;
			},
			
			nextStep: function() {
				if (this.currentStep < this.steps.length - 1) {
					this.currentStep++;
					this.updateUI();
				}
			},
			
			previousStep: function() {
				if (this.currentStep > 0) {
					this.currentStep--;
					this.updateUI();
				}
			},
			
			goToStep: function(stepIndex) {
				if (stepIndex >= 0 && stepIndex < this.steps.length) {
					this.currentStep = stepIndex;
					updateContentDisplay(stepIndex);
					this.updateProgress();
					this.updateSubsteps(this.steps[stepIndex]);
				}
			},
			
			updateUI: function() {
				// עדכון הצעדים
				//document.querySelectorAll('.step').forEach((step, index) => {
				//	step.classList.toggle('active', index === this.currentStep);
				//	step.classList.toggle('completed', index < this.currentStep);
				//});
				
				// עדכון התוכן - שינוי חשוב כאן
				const sections = document.querySelectorAll('.content-section');
				sections.forEach((section, index) => {
					if (index === this.currentStep) {
						section.classList.add('active');
						section.style.display = 'block';
					} else {
						section.classList.remove('active');
						section.style.display = 'none';
					}
				});
				
				this.updateProgress();
				this.updateSubsteps(this.steps[this.currentStep]);
				
				// גלילה חלקה לראש העמוד
				window.scrollTo({ top: 0, behavior: 'smooth' });
			},
			
			updateSubsteps: function(stepId) {
				const completedSections = this.getCompletedSections(stepId);
				document.querySelectorAll(`.step[data-step="${stepId}"] .substep`).forEach(substep => {
					const sectionId = substep.dataset.section;
					substep.classList.toggle('completed', completedSections.includes(sectionId));
				});
			},
			
			getCompletedSections: function(stepId) {
				const saved = localStorage.getItem(`step_${stepId}`);
				return saved ? JSON.parse(saved) : [];
			},
			
			completeSubstep: function(stepId, sectionId) {
				let completedSections = this.getCompletedSections(stepId);
				if (!completedSections.includes(sectionId)) {
					completedSections.push(sectionId);
					localStorage.setItem(`step_${stepId}`, JSON.stringify(completedSections));
					this.updateSubsteps(stepId);
					this.updateProgress();
				}
			},
			
			clearSubstep: function(stepId, sectionId) {
				let completedSections = this.getCompletedSections(stepId);
				if (completedSections.includes(sectionId)) {
					completedSections.pop(sectionId);
					localStorage.setItem(`step_${stepId}`, JSON.stringify(completedSections));
					this.updateSubsteps(stepId);
					this.updateProgress();
				}
			},
			
			
			calculateProgress: function() {
				let totalSubsteps = 0;
				let completedSubsteps = 0;
				
				this.steps.forEach(stepId => {
					const substeps = document.querySelectorAll(`.step[data-step="${stepId}"] .substep`).length;
					const completed = this.getCompletedSections(stepId).length;
					totalSubsteps += substeps;
					completedSubsteps += completed;
				});
				
				return Math.round((completedSubsteps / totalSubsteps) * 100);
			},
			
			loadProgress: function() {
				this.steps.forEach(stepId => {
					this.updateSubsteps(stepId);
				});
				this.updateProgress();
			},
			
			attachEventListeners: function() {
				// מאזיני לחיצות על צעדים
				document.querySelectorAll('.step').forEach((step, index) => {
					step.addEventListener('click', () => this.goToStep(index));
				});
				
				// מאזיני לחיצות על תת-צעדים
				document.querySelectorAll('.substep').forEach(substep => {
					substep.addEventListener('click', (e) => {
						e.stopPropagation();
						const stepId = substep.closest('.step').dataset.step;
						const sectionId = substep.dataset.section;
						this.completeSubstep(stepId, sectionId);
					});
				});
				
				// הוספת כפתורי ניווט
				document.querySelectorAll('.content-section').forEach((section, index) => {
					const nav = document.createElement('div');
					nav.className = 'step-navigation';
					nav.innerHTML = `
						${index > 0 ? '<button class="prev-step">הקודם</button>' : ''}
						${index < this.steps.length - 1 ? '<button class="next-step">הבא</button>' : ''}
					`;
					section.appendChild(nav);
				});
				
				// מאזיני לחיצות על כפתורי ניווט
				document.addEventListener('click', (e) => {
					if (e.target.classList.contains('next-step')) {
						this.nextStep();
					} else if (e.target.classList.contains('prev-step')) {
						this.previousStep();
					}
				});
			}
		};

        // Dark mode toggle
        const themeToggle = document.querySelector('.theme-toggle');
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        }

        // Check for saved theme preference or system preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setTheme(savedTheme);
        } else if (prefersDarkScheme.matches) {
            setTheme('dark');
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            setTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });

        // Mobile navigation
        const navToggle = document.querySelector('.nav-toggle');
        const nav = document.querySelector('nav');

        navToggle.addEventListener('click', () => {
            nav.classList.toggle('active');
        });

        // Close mobile navigation when clicking outside
        //document.addEventListener('click', (e) => {
        //    if (!nav.contains(e.target) && !navToggle.contains(e.target)) {
        //        nav.classList.remove('active');
        //    }
        //});

        // Loading animation
        window.addEventListener('load', () => {
            const loading = document.getElementById('loading');
            loading.style.display = 'none';
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    nav.classList.remove('active');
                }
            });
        });
        
		function initializeSectionNavigation() {
			document.querySelectorAll('.substep').forEach(substep => {
				substep.addEventListener('click', (e) => {
					e.preventDefault();
					e.stopPropagation();
					
					const stepId = substep.closest('.step').dataset.step;
					const sectionId = substep.dataset.section;
					navigateToSection(stepId, sectionId);
					
					// מסמן את תת-השלב כהושלם
					//markSubstepComplete(substep);
				});
			});
		}


		function highlightSection(section) {
			section.classList.add('highlight');
			setTimeout(() => {
				section.classList.remove('highlight');
			}, 2000);
		}

		function markSubstepComplete(substep) {
			const stepId = substep.closest('.step').dataset.step;
			const sectionId = substep.dataset.section;
			
			if (stepId && sectionId) {
				substep.classList.add('completed');
				
				// עדכון ההתקדמות הכללית
				if (typeof ProgressTracker !== 'undefined') {
					ProgressTracker.toggleCompletion(substep);
				}
			}
		}
		
		// הוספת סגנונות CSS להדגשת החלק הנבחר
		const styleSub = document.createElement('style');
		styleSub.textContent = `
			.highlight {
				animation: highlight 2s ease-out;
			}

			@keyframes highlight {
				0% { background-color: transparent; }
				25% { background-color: var(--hover-color); }
				100% { background-color: transparent; }
			}

			.content-block > div {
				scroll-margin-top: 100px; /* מרווח מהכותרת הקבועה */
				transition: background-color 0.3s ease;
			}
		`;
		document.head.appendChild(styleSub);

		
		// בסיס המצב
		const lessonState = {
			currentLesson: 1,
			progress: 0,
			answers: {},
			goals: new Set(),
			completedSections: new Set()
		};

		

        // Save goals from checkbox list
        function saveGoals() {
            const checkboxes = document.querySelectorAll('input[name="goals"]');
            lessonState.goals.clear();
            
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    lessonState.goals.add(checkbox.value);
                }
            });

            // Update progress
            updateProgress();
            
            // Show success message
            showNotification('המטרות נשמרו בהצלחה!', 'success');
        }

		function scrollToTop()
		{
			window.scrollTo({ top: 0, behavior: 'smooth' });
		}
		
		function calculateBudgetSplit() {
			const totalIncome = Number(document.getElementById('totalIncome').value) || 0;
			const basics = totalIncome * 0.5;
			const savings = totalIncome * 0.2;
			const leisure = totalIncome * 0.3;

			document.getElementById('recommendedSplit').innerHTML = `
				<div class="split-results">
					<p>צרכים בסיסיים (50%): ${basics.toFixed(0)} ש"ח</p>
					<p>חיסכון והשקעות (20%): ${savings.toFixed(0)} ש"ח</p>
					<p>פנאי והנאה (30%): ${leisure.toFixed(0)} ש"ח</p>
				</div>
			`;
		}
		
		// Show/Hide Scroll Button based on scroll position
		function toggleScrollButton() {
			const scrollBtn = document.getElementById('scrollTopBtn');
			if (scrollBtn) {
				window.pageYOffset > 200 ?
					scrollBtn.style.opacity = '1' :
					scrollBtn.style.opacity = '0';
			}
		}

				
		// Toggle Progress Overlay
		function toggleProgressBar() {
			const overlay = document.getElementById('progressOverlay');
			const isVisible = overlay.classList.contains('visible');
			
			if (!isVisible) {
				updateProgressBars();
			}
			
			overlay.classList.toggle('visible');
		}

		// Update Progress Bars
		function updateProgressBars() {
			const totalProgress = Math.round(stepsManager.calculateProgress());
			const currentProgress = getCurrentChapterProgress();
			
			const totalBar = document.getElementById('totalProgressBar');
			const chapterBar = document.getElementById('chapterProgressBar');
			
			if (totalBar) {
				totalBar.style.width = `${totalProgress}%`;
			}
			
			if (chapterBar) {
				chapterBar.style.width = `${currentProgress}%`;
			}
		}



		function calculateBudget() {
			// קבלת הערכים מהשדות
			const salary1 = Number(document.getElementById('salary1').value) || 0;
			const salary2 = Number(document.getElementById('salary2').value) || 0;
			const otherIncome = Number(document.getElementById('otherIncome').value) || 0;
			const housing = Number(document.getElementById('housing').value) || 0;
			const bills = Number(document.getElementById('bills').value) || 0;
			const education = Number(document.getElementById('education').value) || 0;

			// חישוב סכומים
			const totalIncome = salary1 + salary2 + otherIncome;
			const totalFixedExpenses = housing + bills + education;
			const recommendedSavings = totalIncome * 0.2;
			const remainingForVariableExpenses = totalIncome - totalFixedExpenses - recommendedSavings;

			// הצגת התוצאות
			const resultsDiv = document.getElementById('budgetResults');
			resultsDiv.innerHTML = `
				<h6>ניתוח תקציב:</h6>
				<p>סך הכנסות: ${totalIncome.toFixed(2)} ₪</p>
				<p>הוצאות קבועות: ${totalFixedExpenses.toFixed(2)} ₪ (${((totalFixedExpenses/totalIncome)*100).toFixed(1)}%)</p>
				<p>חיסכון מומלץ: ${recommendedSavings.toFixed(2)} ₪ (20%)</p>
				<p>נשאר להוצאות משתנות: ${remainingForVariableExpenses.toFixed(2)} ₪</p>
			`;
			resultsDiv.style.display = 'block';
		}

        function checkAnswer() {
			const currentCard = questions[currentQuestion];
			const selectedAnswer = currentCard.querySelector('input[type="radio"]:checked');
			
			if (!selectedAnswer) {
				alert('אנא בחר תשובה');
				return;
			}

			const isCorrect = selectedAnswer.value === currentCard.dataset.correct;
			
			// הוספת קלאס לסימון התשובה בלי למחוק את התצוגה
			currentCard.classList.add(isCorrect ? 'correct' : 'incorrect');
			
			// הצגת המשוב הרלוונטי
			const feedback = selectedAnswer.closest('.option').querySelector('.feedback');
			if (feedback) {
				feedback.classList.add('show');
			}

			// נעילת התשובות אבל השארת התצוגה שלהן
			currentCard.querySelectorAll('input[type="radio"]').forEach(radio => {
				radio.disabled = true;
			});

			// השבתת כפתור בדיקת התשובה
			checkBtn.disabled = true;

			// הפעלת כפתור המעבר לשאלה הבאה אם קיימת
			if (currentQuestion < questions.length - 1) {
				nextBtn.disabled = false;
				nextBtn.focus();
			}
		}

        // מניעת הגשה חוזרת של אותה תשובה
        document.querySelectorAll('.quiz-option input').forEach(input => {
            input.addEventListener('change', function() {
                // הסתרת כל המשובים בקבוצת השאלות הנוכחית
                const questionGroup = this.closest('.quiz-question');
                questionGroup.querySelectorAll('.feedback').forEach(feedback => {
                    feedback.style.display = 'none';
                });

                // הסרת אנימציות קודמות
                questionGroup.querySelectorAll('.quiz-option').forEach(option => {
                    option.style.animation = '';
                });
            });
        });

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateY(0)';
                notification.style.opacity = '1';
            }, 10);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateY(-20px)';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Update progress bar
        function updateProgress() {
			// מספר כולל של תתי-שלבים בכל השלבים
			let totalSubsteps = 0;
			let completedSubsteps = 0;
			
			const totalProgress = document.querySelector('.total-progress');
			const currentChapter = document.querySelector('.current-chapter');

			// עבור על כל השלבים
			document.querySelectorAll('.step').forEach(step => {
				// ספור את כל תתי-השלבים בשלב הנוכחי
				const substeps = step.querySelectorAll('.substep').length;
				totalSubsteps += substeps;

				// ספור כמה תתי-שלבים הושלמו
				const completedInStep = step.querySelectorAll('.substep.completed').length;
				completedSubsteps += completedInStep;

				// עדכן את הסטטוס של השלב עצמו
				//if (completedInStep === substeps && substeps > 0) {
				//	step.classList.add('completed');
				//} else {
				//	step.classList.remove('completed');
				//}
			});

			// חשב את אחוז ההתקדמות הכולל
			const progressPercentage = totalSubsteps > 0 ? (completedSubsteps / totalSubsteps) * 100 : 0;

			// עדכן את סרגל ההתקדמות
			const progressIndicator = document.getElementById('totalProgress');
			const progressText = document.getElementById('progressText');
			
			if (progressIndicator && progressText) {
				progressIndicator.style.width = `${progressPercentage}%`;
				progressText.textContent = `${Math.round(progressPercentage)}% הושלם`;
			}
			
			if (totalProgress && currentChapter) {
				// Get progress values from your existing progress tracking system
				const total = Math.round(stepsManager.calculateProgress());
				const current = getCurrentChapterProgress();
				
				totalProgress.textContent = `${total}%`;
				currentChapter.textContent = `${current}%`;
			}
	

			// שמור את ההתקדמות
			lessonState.progress = progressPercentage;
			saveProgress();

			return progressPercentage;
		}
		
		// Replace the existing button with the new SVG button
		function initProgressButton() {
			const oldButton = document.getElementById('progressBtn');
			if (!oldButton) return;

			const newButton = document.createElement('button');
			newButton.className = 'progress-btn';
			newButton.id = 'progressBtn';
			newButton.setAttribute('title', 'הצג התקדמות');
			newButton.innerHTML = `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
			  <!-- Background Circle -->
			  <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e9f0" stroke-width="8"/>
			  
			  <!-- Progress Circle -->
			  <circle cx="50" cy="50" r="45" fill="none" stroke="#4a90a7" stroke-width="8"
					  stroke-dasharray="282.7" stroke-dashoffset="282.7"
					  transform="rotate(-90 50 50)">
				<animate attributeName="stroke-dashoffset"
						 from="282.7" to="0"
						 dur="1s"
						 begin="buttonHover.begin"
						 fill="freeze"/>
				<animate attributeName="stroke-dashoffset"
						 from="0" to="282.7"
						 dur="1s"
						 begin="buttonLeave.begin"
						 fill="freeze"/>
			  </circle>

			  <!-- Chart Bars -->
			  <g transform="translate(30,30) scale(0.8)">
				<rect x="5" y="40" width="10" height="20" fill="#2d5a77"/>
				<rect x="25" y="30" width="10" height="30" fill="#2d5a77"/>
				<rect x="45" y="20" width="10" height="40" fill="#2d5a77"/>
			  </g>
			</svg>`; // Replace with the SVG code from the first artifact

			oldButton.parentNode.replaceChild(newButton, oldButton);

			// Create progress overlay
			const overlay = document.createElement('div');
			overlay.className = 'progress-overlay';
			overlay.innerHTML = `
				<h6>התקדמות בלימוד</h6>
				<div class="progress-details">
					<div class="progress-item">
						<span class="progress-label">התקדמות כללית</span>
						<span class="progress-value total-progress">0%</span>
					</div>
					<div class="progress-item">
						<span class="progress-label">פרק נוכחי</span>
						<span class="progress-value current-chapter">0%</span>
					</div>
				</div>
			`;
			document.body.appendChild(overlay);

			// Add event listeners
			let isOverlayVisible = false;
			newButton.addEventListener('click', () => {
				isOverlayVisible = !isOverlayVisible;
				overlay.classList.toggle('visible', isOverlayVisible);
				updateProgress();
			});

			// Close overlay when clicking outside
			document.addEventListener('click', (e) => {
				if (!overlay.contains(e.target) && !newButton.contains(e.target)) {
					isOverlayVisible = false;
					overlay.classList.remove('visible');
				}
			});

			// Add hover animations
			newButton.addEventListener('mouseenter', () => {
				const circle = newButton.querySelector('circle:nth-of-type(2)');
				if (circle) {
					circle.dispatchEvent(new Event('buttonHover'));
				}
			});

			newButton.addEventListener('mouseleave', () => {
				const circle = newButton.querySelector('circle:nth-of-type(2)');
				if (circle) {
					circle.dispatchEvent(new Event('buttonLeave'));
				}
			});
		}

		
		// Get Current Chapter Progress
		function getCurrentChapterProgress() {
			const currentSection = document.querySelector('.content-section.active');
			if (!currentSection) return 0;
			
			const totalSubsteps = currentSection.querySelectorAll('.substep').length;
			const completedSubsteps = currentSection.querySelectorAll('.substep.completed').length;
			
			return totalSubsteps ? Math.round((completedSubsteps / totalSubsteps) * 100) : 0;
		}


        // Navigation between lessons
        function nextLesson() {
            if (lessonState.progress < 100) {
                showNotification('יש להשלים את כל חלקי השיעור לפני המעבר הלאה', 'warning');
                return;
            }

            const currentLesson = document.querySelector('.lesson-module.active');
            const nextLesson = currentLesson.nextElementSibling;

            if (nextLesson && nextLesson.classList.contains('lesson-module')) {
                currentLesson.classList.remove('active');
                nextLesson.classList.add('active');
                lessonState.currentLesson++;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                showNotification('סיימת את כל השיעורים בפרק זה!', 'success');
            }
        }

        function previousLesson() {
            const currentLesson = document.querySelector('.lesson-module.active');
            const prevLesson = currentLesson.previousElementSibling;

            if (prevLesson && prevLesson.classList.contains('lesson-module')) {
                currentLesson.classList.remove('active');
                prevLesson.classList.add('active');
                lessonState.currentLesson--;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        

		// טעינת התקדמות
		function loadProgress() {
			const savedState = localStorage.getItem('lessonState');
			if (savedState) {
				const parsedState = JSON.parse(savedState);
				lessonState.currentLesson = parsedState.currentLesson || 1;
				lessonState.progress = parsedState.progress || 0;
				lessonState.answers = parsedState.answers || {};
				lessonState.goals = new Set(Array.isArray(parsedState.goals) ? parsedState.goals : []);
				lessonState.completedSections = new Set(Array.isArray(parsedState.completedSections) ? parsedState.completedSections : []);
				
				updateProgress();
				
				// שחזור המטרות שנשמרו
				if (lessonState.goals.size > 0) {
					lessonState.goals.forEach(goal => {
						const checkbox = document.querySelector(`input[value="${goal}"]`);
						if (checkbox) checkbox.checked = true;
					});
				}
			}
		}

		function analyzeDebtRatio() {
			const income = Number(document.getElementById('monthlyIncome').value);
			const debts = Number(document.getElementById('monthlyDebts').value);
			const ratio = (debts / income) * 100;
			
			let analysis = '';
			if (ratio > 40) {
				analysis = `<p class="warning">יחס חוב-הכנסה: ${ratio.toFixed(1)}%</p>
						   <p>⚠️ יחס גבוה מדי. מומלץ לפעול להקטנת החובות.</p>`;
			} else if (ratio > 30) {
				analysis = `<p>יחס חוב-הכנסה: ${ratio.toFixed(1)}%</p>
						   <p>⚠️ יחס גבוה. כדאי לשקול הקטנת חובות.</p>`;
			} else {
				analysis = `<p class="good">יחס חוב-הכנסה: ${ratio.toFixed(1)}%</p>
						   <p>✅ יחס סביר. המשך לשמור על ניהול פיננסי אחראי.</p>`;
			}
			
			document.getElementById('debtAnalysis').innerHTML = analysis;
		}

		function simulateCredit() {
			const charge = Number(document.getElementById('creditCharge').value);
			const scenario = document.getElementById('creditScenario').value;
			
			let result = '';
			switch(scenario) {
				case 'full':
					result = `<p class="good">תשלום מלא: ${charge} ₪</p>
							 <p>✅ אין ריבית נוספת</p>
							 <p>חיסכון שנתי: ${(charge * 0.12).toFixed(0)} ₪</p>`;
					break;
				case 'minimum':
					const minimumPayment = charge * 0.1;
					const interest = (charge - minimumPayment) * 0.12;
					result = `<p class="warning">תשלום מינימום: ${minimumPayment.toFixed(0)} ₪</p>
							 <p>⚠️ ריבית חודשית: ${interest.toFixed(0)} ₪</p>
							 <p>זמן לסגירת החוב: ${Math.ceil(charge / minimumPayment)} חודשים</p>`;
					break;
				case 'partial':
					const partialPayment = charge * 0.5;
					const partialInterest = (charge - partialPayment) * 0.12;
					result = `<p>תשלום חלקי: ${partialPayment.toFixed(0)} ₪</p>
							 <p>ריבית חודשית: ${partialInterest.toFixed(0)} ₪</p>
							 <p>זמן לסגירת החוב: ${Math.ceil(charge / partialPayment)} חודשים</p>`;
					break;
			}
			
			document.getElementById('creditSimulation').innerHTML = result;
		}

		function calculateRefinance() {
			const amount = Number(document.getElementById('currentLoanAmount').value);
			const currentInterest = Number(document.getElementById('currentInterest').value) / 100;
			const newInterest = Number(document.getElementById('newInterest').value) / 100;
			const months = Number(document.getElementById('remainingMonths').value);
			
			const currentMonthlyPayment = amount * (currentInterest/12 * Math.pow(1 + currentInterest/12, months)) / (Math.pow(1 + currentInterest/12, months) - 1);
			const newMonthlyPayment = amount * (newInterest/12 * Math.pow(1 + newInterest/12, months)) / (Math.pow(1 + newInterest/12, months) - 1);
			const totalSavings = (currentMonthlyPayment - newMonthlyPayment) * months;
			
			const result = `
				<p>תשלום חודשי נוכחי: ${currentMonthlyPayment.toFixed(0)} ₪</p>
				<p>תשלום חודשי לאחר מיחזור: ${newMonthlyPayment.toFixed(0)} ₪</p>
				<p class="good">חיסכון חודשי: ${(currentMonthlyPayment - newMonthlyPayment).toFixed(0)} ₪</p>
				<p class="good">חיסכון כולל: ${totalSavings.toFixed(0)} ₪</p>
			`;
			
			document.getElementById('refinanceResults').innerHTML = result;
		}

		function calculateInsuranceNeeds() {
			const income = Number(document.getElementById('familyIncome').value);
			const houseValue = Number(document.getElementById('houseValue').value);
			const childrenCount = Number(document.getElementById('childrenCount').value);
			const contentValue = Number(document.getElementById('contentValue').value);

			const lifeInsurance = income * 60; // 5 שנות הכנסה
			const healthInsurance = income * 0.05; // 5% מההכנסה לביטוח בריאות
			const propertyInsurance = houseValue + contentValue;
			const childrenEducation = childrenCount * 200000; // 200,000 ש"ח לילד

			const recommendations = `
				<h6>המלצות לכיסוי ביטוחי:</h6>
				<ul>
					<li>ביטוח חיים: ${lifeInsurance.toLocaleString()} ₪</li>
					<li>ביטוח בריאות חודשי: ${healthInsurance.toLocaleString()} ₪</li>
					<li>ביטוח רכוש: ${propertyInsurance.toLocaleString()} ₪</li>
					<li>חיסכון לחינוך ילדים: ${childrenEducation.toLocaleString()} ₪</li>
				</ul>
			`;

			document.getElementById('insuranceRecommendations').innerHTML = recommendations;
		}

		function calculateRetirement() {
			const currentAge = Number(document.getElementById('currentAge').value);
			const retirementAge = Number(document.getElementById('retirementAge').value);
			const monthlyIncome = Number(document.getElementById('monthlyIncome').value);
			const currentSavings = Number(document.getElementById('currentSavings').value);
			const savingRate = Number(document.getElementById('monthlySavingRate').value) / 100;

			const yearsToRetirement = retirementAge - currentAge;
			const monthlyContribution = monthlyIncome * savingRate;
			const expectedReturns = 0.04; // 4% ריבית שנתית ריאלית משוערת
			
			// חישוב הצבירה הצפויה
			const futureValue = currentSavings * Math.pow(1 + expectedReturns, yearsToRetirement) + 
							   monthlyContribution * 12 * ((Math.pow(1 + expectedReturns, yearsToRetirement) - 1) / expectedReturns);
			
			// חישוב הקצבה החודשית הצפויה
			const monthlyPension = (futureValue * 0.04) / 12; // הנחה של 4% משיכה שנתית

			const results = `
				<h6>תחזית פרישה:</h6>
				<ul>
					<li>צבירה צפויה בגיל ${retirementAge}: ${Math.round(futureValue).toLocaleString()} ₪</li>
					<li>קצבה חודשית צפויה: ${Math.round(monthlyPension).toLocaleString()} ₪</li>
					<li>יחס תחלופה: ${Math.round((monthlyPension/monthlyIncome) * 100)}%</li>
				</ul>
				${monthlyPension < monthlyIncome * 0.7 ? 
					'<p class="warning">⚠️ הקצבה הצפויה נמוכה מ-70% מההכנסה הנוכחית. מומלץ להגדיל את החיסכון.</p>' : 
					'<p class="success">✅ הקצבה הצפויה מספקת יחס תחלופה טוב.</p>'}
			`;

			document.getElementById('retirementResults').innerHTML = results;
		}

		function showPensionDetails(type) {
			const details = {
				fund: {
					title: 'קרן פנסיה',
					advantages: ['דמי ניהול נמוכים (עד 0.5%)', 'כיסוי למקרה נכות ושאירים', 'ניהול השקעות מקצועי'],
					disadvantages: ['פחות גמישות בבחירת מסלולים', 'אין אפשרות למשיכה הונית']
				},
				insurance: {
					title: 'ביטוח מנהלים',
					advantages: ['גמישות רבה בבחירת כיסויים', 'קצבה מובטחת', 'אפשרות למשיכה הונית'],
					disadvantages: ['דמי ניהול גבוהים יותר', 'עלות ביטוח גבוהה יותר']
				},
				provident: {
					title: 'קופת גמל',
					advantages: ['גמישות מלאה במשיכת הכספים', 'דמי ניהול נמוכים יחסית', 'מגוון אפשרויות השקעה'],
					disadvantages: ['אין כיסויים ביטוחיים מובנים', 'אין הבטחת תשואה']
				}
			};

			const selected = details[type];
			document.getElementById('pensionDetails').style.display = 'block';
			document.getElementById('pensionDetails').innerHTML = `
				<h6>${selected.title} - פירוט מלא</h6>
				<div class="details-grid">
					<div>
						<h7>יתרונות:</h7>
						<ul>${selected.advantages.map(adv => '<li>' + adv + '</li>').join('')}</ul>
					</div>
					<div>
						<h7>חסרונות:</h7>
						<ul>${selected.disadvantages.map(dis => '<li>' + dis + '</li>').join('')}</ul>
					</div>
				</div>
			`;

			// עדכון הסגנון של האפשרות שנבחרה
			document.querySelectorAll('.pension-option').forEach(opt => opt.classList.remove('selected'));
			document.querySelector(`.pension-option:nth-child(${['fund', 'insurance', 'provident'].indexOf(type) + 1})`).classList.add('selected');
		}
		
		function comparePensionPlans() {
			const monthlyDeposit = Number(document.getElementById('monthlyDeposit').value);
			const startAge = Number(document.getElementById('startAge').value);
			const savingPeriod = Number(document.getElementById('savingPeriod').value);

			const plans = {
				fund: {
					managementFees: 0.005,
					returns: 0.04
				},
				insurance: {
					managementFees: 0.01,
					returns: 0.04
				},
				provident: {
					managementFees: 0.006,
					returns: 0.04
				}
			};

			const results = {};
			for (const [type, plan] of Object.entries(plans)) {
				const netReturns = plan.returns - plan.managementFees;
				const futureValue = monthlyDeposit * 12 * ((Math.pow(1 + netReturns, savingPeriod) - 1) / netReturns);
				results[type] = Math.round(futureValue);
			}

			// חישוב הקצבה החודשית הצפויה
			const monthlyPensions = {};
			for (const [type, value] of Object.entries(results)) {
				monthlyPensions[type] = Math.round((value * 0.04) / 12);
			}

			document.getElementById('pensionComparison').innerHTML = `
				<h6>השוואת מסלולים לאחר ${savingPeriod} שנים:</h6>
				<ul>
					<li>קרן פנסיה: 
						<div>צבירה: ${results.fund.toLocaleString()} ₪</div>
						<div>קצבה צפויה: ${monthlyPensions.fund.toLocaleString()} ₪</div>
					</li>
					<li>ביטוח מנהלים: 
						<div>צבירה: ${results.insurance.toLocaleString()} ₪</div>
						<div>קצבה צפויה: ${monthlyPensions.insurance.toLocaleString()} ₪</div>
					</li>
					<li>קופת גמל: 
						<div>צבירה: ${results.provident.toLocaleString()} ₪</div>
						<div>קצבה צפויה: ${monthlyPensions.provident.toLocaleString()} ₪</div>
					</li>
				</ul>
				<p class="note">* התחשיב מניח תשואה שנתית ממוצעת של 4% ומתעלם משינויים בדמי ניהול ותשואות לאורך זמן</p>
				<p class="recommendation">
					${getRecommendation(monthlyPensions, results)}
				</p>
			`;
		}

		function getRecommendation(monthlyPensions, totalSavings) {
			const bestOption = Object.entries(monthlyPensions).reduce((a, b) => a[1] > b[1] ? a : b);
			const recommendations = {
				fund: "קרן הפנסיה מציעה את היחס הטוב ביותר בין דמי ניהול לתשואה",
				insurance: "ביטוח המנהלים מציע גמישות רבה יותר למרות דמי הניהול הגבוהים",
				provident: "קופת הגמל מציעה איזון טוב בין גמישות לעלויות"
			};
			
			return `המלצה: ${recommendations[bestOption[0]]}`;
		}

		/* JavaScript */
		function updateContentDisplay(stepIndex) {
			// Hide all content sections
			document.querySelectorAll('.content-section').forEach(section => {
				section.classList.remove('active');
				section.style.display = 'none';
			});
			
			// Show the selected content section
			const targetSection = document.getElementById(stepsManager.steps[stepIndex]);
			if (targetSection) {
				targetSection.style.display = 'block';
				
				// Add active class and update progress
				requestAnimationFrame(() => {
					targetSection.classList.add('active');
					
					// Update progress for all sections
					const sections = document.querySelectorAll('.content-section');
					sections.forEach(section => {
						ProgressTracker.updateChapterProgress(section.id);
					});
					
					// Scroll to content
					setTimeout(() => {
						const headerHeight = 80;
						const container = targetSection.closest('.container');
						const containerTop = container.getBoundingClientRect().top;
						const scrollPosition = window.pageYOffset + containerTop - headerHeight;
						
						window.scrollTo({
							top: scrollPosition,
							behavior: 'smooth'
						});
					}, 50);
				});
			}
			
			// Update step highlighting
			document.querySelectorAll('.step').forEach((step, index) => {
				step.classList.toggle('active', index === stepIndex);
			});
		}

		// מערכת מעקב התקדמות משולבת
		const ProgressTracker = {
			completedSubsteps: new Set(),
			
		  init() {
			this.loadProgress();
			this.attachEventListeners();
			this.updateAllProgress();
		  },

		  loadProgress() {
			const saved = localStorage.getItem('completedSubsteps');
			if (saved) {
			  this.completedSubsteps = new Set(JSON.parse(saved));
			  this.updateAllUI();
			}
		  },

		  saveProgress() {
			localStorage.setItem('completedSubsteps', 
			  JSON.stringify(Array.from(this.completedSubsteps)));
			  
			const interval = setInterval(() => {
				loadProgress();
				clearInterval(interval);
			}, 1000);
		  },

		  toggleCompletion(substep) {
			const stepId = substep.closest('.step')?.dataset.step;
			const sectionId = substep.dataset.section;
			
			if (!stepId || !sectionId) return;
			
			const key = `${stepId}-${sectionId}`;
			
			if (this.completedSubsteps.has(key)) {
			  this.completedSubsteps.delete(key);
			  substep.classList.remove('completed');
			  stepsManager.clearSubstep(stepId,sectionId);
			} else {
			  this.completedSubsteps.add(key);
			  substep.classList.add('completed');
			}

			this.saveProgress();
			this.updateAllProgress();
			this.updateChapterProgress(substep.dataset.chapter);
		  },

		  updateTotalProgress() {
			const allSubsteps = document.querySelectorAll('.substep').length;
			const completed = this.completedSubsteps.size;
			const percentage = allSubsteps > 0 ? (completed / allSubsteps) * 100 : 0;

			// Update total progress bar
			const progressBar = document.getElementById('totalProgress');
			const progressText = document.getElementById('progressText');
			
			if (progressBar && progressText) {
			  progressBar.style.width = `${percentage}%`;
			  progressText.textContent = `${Math.round(percentage)}% הושלם`;
			}

			return percentage;
		  },

		  updateChapterProgress(chapterId) {
			  if (!chapterId) {
				console.log('No chapter ID provided');
				return;
			  }

			  const chapter = document.getElementById(chapterId);
			  if (!chapter) {
				console.log('Chapter element not found:', chapterId);
				return;
			  }

			  // מציאת ה-step המתאים לפי מיפוי הפרקים
			  const stepIndex = stepMap[chapterId];
			  if (typeof stepIndex !== 'number') {
				console.log('Step mapping not found for:', chapterId);
				return;
			  }

			  // מציאת אלמנט ה-step המתאים
			  const stepElement = document.querySelector(`.step[data-step="${stepsManager.steps[stepIndex]}"]`);
			  if (!stepElement) {
				console.log('Step element not found for step:', stepsManager.steps[stepIndex]);
				return;
			  }

			  // מציאת כל תתי-הצעדים וספירת ההשלמות
			  const substeps = stepElement.querySelectorAll('.substep');
			  let completed = 0;

			  substeps.forEach(substep => {
				const stepId = stepsManager.steps[stepIndex];
				const sectionId = substep.dataset.section;
				if (stepId && sectionId) {
				  const key = `${stepId}-${sectionId}`;
				  if (this.completedSubsteps.has(key)) {
					completed++;
				  }
				}
			  });

			  // חישוב האחוז
			  const percentage = substeps.length > 0 ? (completed / substeps.length) * 100 : 0;

			  // עדכון סרגל ההתקדמות של הפרק
			  const progressBar = chapter.querySelector('.chapter-navigation .progress-bar .progress-indicator');
			  const progressText = chapter.querySelector('.chapter-navigation .progress-text');

			  if (progressBar) {
				progressBar.style.width = `${percentage}%`;
			  }
			  if (progressText) {
				progressText.textContent = `${Math.round(percentage)}% הושלם`;
			  }

			  // עדכון מצב ה-step בתפריט הצד
			  //if (completed === substeps.length && substeps.length > 0) {
				//stepElement.classList.add('completed');
			  //} else {
				//stepElement.classList.remove('completed');
			  //}

			  // לוג לצורך דיבוג
			  console.log(`Updated progress for ${chapterId}:`, {
				stepIndex,
				totalSubsteps: substeps.length,
				completedSubsteps: completed,
				percentage
			  });

			  return percentage;
			},

		  updateAllProgress() {
			this.updateTotalProgress();
			document.querySelectorAll('.content-section').forEach(section => {
			  this.updateChapterProgress(section.id);
			});
		  },

		  updateAllUI() {
			document.querySelectorAll('.substep').forEach(substep => {
			  const stepId = substep.closest('.step')?.dataset.step;
			  const sectionId = substep.dataset.section;
			  if (stepId && sectionId) {
				const key = `${stepId}-${sectionId}`;
				substep.classList.toggle('completed', 
				  this.completedSubsteps.has(key));
			  }
			});
			this.updateAllProgress();
		  },

		  attachEventListeners() {
			document.querySelectorAll('.substep').forEach(substep => {
			  substep.addEventListener('click', (e) => {
				e.stopPropagation();
				this.toggleCompletion(substep);
			  });
			});

			// Listen for chapter changes
			document.querySelectorAll('.step').forEach(step => {
			  step.addEventListener('click', () => {
				const stepId = step.dataset.step;
				const currentSection = document.querySelector(
				  `.content-section[data-step="${stepId}"]`);
				if (currentSection) {
				  this.updateChapterProgress(currentSection.id);
				}
			  });
			});
		  }
		};

		function toggleSubstepCompletion(substep) {
			substep.classList.toggle('completed');
			
			// Find and update chapter progress
			const chapter = substep.closest('.content-section');
			if (chapter) {
				updateChapterProgress(chapter.id);
			}
		}

		function initializeChapterProgress() {
			// Add click listeners to all substeps
			document.querySelectorAll('.substep').forEach(substep => {
				substep.addEventListener('click', () => {
					toggleSubstepCompletion(substep);
				});
			});
			
			// Initial progress update for current chapter
			const currentChapter = document.querySelector('.content-section.active');
			if (currentChapter) {
				ProgressTracker.updateChapterProgress(currentChapter.id);
			}
			
			// Update progress for all sections
			const sections = document.querySelectorAll('.content-section');
			sections.forEach(section => {
				ProgressTracker.updateChapterProgress(section.id);
			});
		}

		function comparePolicies() {
			const premium1 = Number(document.getElementById('premium1').value);
			const coverage1 = Number(document.getElementById('coverage1').value);
			const deductible1 = Number(document.getElementById('deductible1').value);
			
			const premium2 = Number(document.getElementById('premium2').value);
			const coverage2 = Number(document.getElementById('coverage2').value);
			const deductible2 = Number(document.getElementById('deductible2').value);

			const ratio1 = coverage1 / (premium1 * 12);
			const ratio2 = coverage2 / (premium2 * 12);

			let recommendation = '';
			if (ratio1 > ratio2) {
				recommendation = 'פוליסה א\' מספקת יחס כיסוי/מחיר טוב יותר';
			} else if (ratio2 > ratio1) {
				recommendation = 'פוליסה ב\' מספקת יחס כיסוי/מחיר טוב יותר';
			} else {
				recommendation = 'שתי הפוליסות מספקות יחס דומה';
			}

			document.getElementById('policyComparison').innerHTML = `
				<h6>תוצאות השוואה:</h6>
				<p>יחס כיסוי/מחיר שנתי:</p>
				<ul>
					<li>פוליסה א': ${ratio1.toFixed(2)}</li>
					<li>פוליסה ב': ${ratio2.toFixed(2)}</li>
				</ul>
				<p><strong>המלצה: </strong>${recommendation}</p>
			`;
		}
		
		function buildEmergencyPlan() {
			const basicExpenses = Number(document.getElementById('basicExpenses').value);
			const coveragePeriod = Number(document.getElementById('coveragePeriod').value);
			const hasSavings = document.getElementById('savings').checked;
			const hasInsurance = document.getElementById('insurance').checked;
			const hasFamily = document.getElementById('family').checked;
			const totalNeeded = basicExpenses * coveragePeriod;
			let recommendations = [];

			if (!hasSavings) {
				recommendations.push('מומלץ לבנות קרן חירום של לפחות 3 חודשי הוצאות');
			}
			if (!hasInsurance) {
				recommendations.push('שקול רכישת ביטוח אובדן כושר עבודה');
			}
			if (recommendations.length === 0) {
				recommendations.push('יש לך את רוב המרכיבים הנדרשים לתכנית חירום טובה');
			}

			const coverageScore = ((hasSavings ? 1 : 0) + (hasInsurance ? 1 : 0) + (hasFamily ? 0.5 : 0)) * 40;
			
			document.getElementById('emergencyPlan').innerHTML = `
				<div class="plan-summary">
					<h6>סיכום תכנית החירום:</h6>
					<ul>
						<li>סכום חודשי נדרש: ${basicExpenses.toLocaleString()} ₪</li>
						<li>סכום כולל לתקופה של ${coveragePeriod} חודשים: ${totalNeeded.toLocaleString()} ₪</li>
						<li>רמת מוכנות: ${coverageScore}%</li>
						<li>מקורות זמינים: ${[
							hasSavings ? "חסכונות" : null,
							hasInsurance ? "ביטוח" : null,
							hasFamily ? "תמיכה משפחתית" : null
						].filter(Boolean).join(", ") || "אין"}</li>
					</ul>
					<div class="coverage-bar">
						<div class="progress-fill" style="width: ${coverageScore}%"></div>
					</div>
					<div class="recommendations">
						<h6>המלצות:</h6>
						<ul>
							${recommendations.map(rec => '<li>' + rec + '</li>').join('')}
						</ul>
					</div>
				</div>
			`;
		}
		
		// עדכון תצוגת תקופת הכיסוי
		document.getElementById('coveragePeriod')?.addEventListener('input', (e) => {
			document.getElementById('periodDisplay').textContent = `${e.target.value} חודשים`;
		});

		// חישוב אחוזי כיסוי ביטוחי
		function calculateCoverage(currentValue, recommendedValue) {
			return Math.min((currentValue / recommendedValue) * 100, 100);
		}

		// אנימציית התקדמות
		function animateProgress(elementId, targetWidth) {
			const element = document.getElementById(elementId);
			let width = 0;
			const interval = setInterval(() => {
				if (width >= targetWidth) {
					clearInterval(interval);
				} else {
					width++;
					element.style.width = width + '%';
				}
			}, 10);
		}

		// הוספת אינדיקציה ויזואלית לאיכות הכיסוי
		function addCoverageIndicator(value) {
			if (value >= 90) return '🟢';
			if (value >= 70) return '🟡';
			return '🔴';
		}

		// תצוגת טיפים לשיפור הכיסוי
		function showInsuranceTips(coverageGaps) {
			const tips = {
				life: 'שקול הגדלת ביטוח החיים לפי גודל המשפחה וההתחייבויות',
				health: 'בדוק אפשרות להרחבת הכיסוי הרפואי כולל ניתוחים וטיפולים מיוחדים',
				property: 'עדכן את סכומי הביטוח בהתאם לשווי הנכסים העדכני',
				disability: 'הוסף ביטוח אובדן כושר עבודה להגנה על ההכנסה החודשית'
			};

			return coverageGaps.map(gap => tips[gap]).join('<br>');
		}

		// יצירת גרף השוואת פוליסות
		function createPolicyComparisonChart(policy1, policy2) {
			const ctx = document.createElement('canvas');
			document.getElementById('policyComparison').appendChild(ctx);
			
			return new Chart(ctx, {
				type: 'bar',
				data: {
					labels: ['פרמיה', 'כיסוי', 'השתתפות עצמית'],
					datasets: [
						{
							label: 'פוליסה א׳',
							data: [policy1.premium, policy1.coverage, policy1.deductible],
							backgroundColor: 'rgba(54, 162, 235, 0.5)'
						},
						{
							label: 'פוליסה ב׳',
							data: [policy2.premium, policy2.coverage, policy2.deductible],
							backgroundColor: 'rgba(255, 99, 132, 0.5)'
						}
					]
				},
				options: {
					responsive: true,
					scales: {
						y: {
							beginAtZero: true
						}
					}
				}
			});
		}


		// שמירת התקדמות
		function saveProgress() {
			const stateToSave = {
				currentLesson: lessonState.currentLesson,
				progress: lessonState.progress,
				answers: lessonState.answers,
				goals: Array.from(lessonState.goals),
				completedSections: Array.from(lessonState.completedSections)
			};
			localStorage.setItem('lessonState', JSON.stringify(stateToSave));
		}
		
		function initializeQuiz() {
			const quizContainer = document.querySelector('.quiz-container');
			const questions = quizContainer.querySelectorAll('.question-card');
			const prevBtn = quizContainer.querySelector('.prev-btn');
			const nextBtn = quizContainer.querySelector('.next-btn');
			const checkBtn = quizContainer.querySelector('.check-btn');
			let currentQuestion = 0;
			let answeredQuestions = new Set(); // הוספת המשתנה החסר

			function showQuestion(index) {
				questions.forEach(q => q.classList.remove('active'));
				questions[index].classList.add('active');
				
				prevBtn.disabled = index === 0;
				nextBtn.disabled = index === questions.length - 1;
				
				// בדיקה האם השאלה כבר נענתה
				checkBtn.disabled = answeredQuestions.has(index);
			}

			prevBtn.addEventListener('click', () => {
				if (currentQuestion > 0) {
					currentQuestion--;
					showQuestion(currentQuestion);
				}
			});

			nextBtn.addEventListener('click', () => {
				if (currentQuestion < questions.length - 1) {
					currentQuestion++;
					showQuestion(currentQuestion);
				}
			});

			checkBtn.addEventListener('click', () => {
				const currentCard = questions[currentQuestion];
				const selectedAnswer = currentCard.querySelector('input[type="radio"]:checked');
				
				if (!selectedAnswer) {
					alert('אנא בחר תשובה');
					return;
				}

				// סימון השאלה כנענתה
				answeredQuestions.add(currentQuestion);

				// הצגת המשוב המתאים
				const feedback = currentCard.querySelector(`.feedback[data-value="${selectedAnswer.value}"]`);
				if (feedback) {
					currentCard.querySelectorAll('.feedback').forEach(f => f.classList.remove('show'));
					feedback.classList.add('show');
				}

				// סימון האם התשובה נכונה
				if ((currentQuestion === 0 && selectedAnswer.value === 'b') || 
					(currentQuestion === 1 && selectedAnswer.value === 'a')) {
					currentCard.classList.add('correct');
				} else {
					currentCard.classList.add('incorrect');
				}

				// נעילת התשובות
				currentCard.querySelectorAll('input[type="radio"]').forEach(radio => {
					radio.disabled = true;
				});

				checkBtn.disabled = true;
			});

			// אתחול
			showQuestion(0);

			// הוספת מאזין לשינוי בחירת תשובה
			questions.forEach(question => {
				question.querySelectorAll('input[type="radio"]').forEach(radio => {
					radio.addEventListener('change', () => {
						if (!answeredQuestions.has(currentQuestion)) {
							checkBtn.disabled = false;
						}
					});
				});
			});
		}

		function initializeAnimations() {
			// בחירת כל כפתורי ההפעלה של האנימציות
			const animateButtons = document.querySelectorAll('.animate-btn');
			const conceptCards = document.querySelectorAll('.concept-card');

			// הוספת מאזיני אירועים לכפתורי ההפעלה
			animateButtons.forEach(button => {
				button.addEventListener('click', function() {
					const card = this.closest('.concept-card');
					const animation = card.querySelector('.concept-animation');
					const concept = card.dataset.concept;

					// החלפת טקסט הכפתור
					this.textContent = animation.style.display === 'none' ? 'הסתר הדגמה' : 'הצג הדגמה';

					// הצגה/הסתרה של האנימציה
					animation.style.display = animation.style.display === 'none' ? 'block' : 'none';

					// הפעלת האנימציה המתאימה
					if (animation.style.display === 'block') {
						switch (concept) {
							case 'compound-interest':
								initCompoundInterestAnimation(animation);
								break;
							case 'inflation':
								initInflationAnimation(animation);
								break;
							case 'diversification':
								initDiversificationAnimation(animation);
								break;
						}
					}
				});
			});

			// פונקציות עזר לאנימציות ספציפיות
			function initCompoundInterestAnimation(container) {
				const layers = container.querySelector('.interest-layers');
				const controls = container.querySelector('.animation-controls');
				
				controls.querySelectorAll('.control-btn').forEach(btn => {
					btn.addEventListener('click', function() {
						const year = this.dataset.year;
						updateCompoundInterest(layers, year);
					});
				});
			}

			function initInflationAnimation(container) {
				const cart = container.querySelector('.shopping-cart');
				const controls = container.querySelector('.animation-controls');
				
				controls.querySelectorAll('.control-btn').forEach(btn => {
					btn.addEventListener('click', function() {
						const year = this.dataset.year;
						updateInflationVisual(cart, year);
					});
				});
			}

			function initDiversificationAnimation(container) {
				const grid = container.querySelector('.investment-grid');
				const controls = container.querySelector('.animation-controls');
				
				controls.querySelectorAll('.control-btn').forEach(btn => {
					btn.addEventListener('click', function() {
						const risk = this.dataset.risk;
						updateDiversificationVisual(grid, risk);
					});
				});
			}
		}

		// פונקציות עזר לאנימציות
		function updateCompoundInterest(layers, year) {
			const baseAmount = 1000;
			const rate = 0.05; // 5% ריבית שנתית
			
			let amount = baseAmount;
			layers.innerHTML = '';
			
			for (let i = 1; i <= year; i++) {
				amount *= (1 + rate);
				const layer = document.createElement('div');
				layer.className = 'interest-layer';
				layer.style.height = `${(amount - baseAmount) / 50}px`;
				layer.textContent = `${Math.round(amount - baseAmount)} ₪ ריבית`;
				layers.appendChild(layer);
			}
		}

		function updateInflationVisual(cart, year) {
			const basePrice = 100;
			const inflationRates = {
				'2020': 1,
				'2021': 1.02,
				'2022': 1.05
			};
			
			const newPrice = Math.round(basePrice * inflationRates[year]);
			cart.querySelector('.price-tag').textContent = `${newPrice} ₪`;
		}

		function updateDiversificationVisual(grid, risk) {
			const portfolios = {
				'low': [
					{ type: 'אג"ח ממשלתי', percent: 60 },
					{ type: 'מניות', percent: 20 },
					{ type: 'פקדונות', percent: 20 }
				],
				'medium': [
					{ type: 'אג"ח ממשלתי', percent: 40 },
					{ type: 'מניות', percent: 40 },
					{ type: 'נדל"ן', percent: 20 }
				],
				'high': [
					{ type: 'מניות', percent: 70 },
					{ type: 'קריפטו', percent: 20 },
					{ type: 'אג"ח', percent: 10 }
				]
			};

			grid.innerHTML = portfolios[risk].map(item => `
				<div class="investment-item" style="height: ${item.percent}%">
					<div class="item-label">${item.type}</div>
					<div class="item-percent">${item.percent}%</div>
				</div>
			`).join('');
		}

		// פונקציית עזר לעדכון התקדמות המבחן
		function updateQuizProgress(isCorrect) {
			// מציאת מיכל ההתקדמות
			const progressContainer = document.querySelector('.progress-indicator');
			if (!progressContainer) return;

			// עדכון ההתקדמות
			const currentProgress = parseInt(progressContainer.dataset.progress || 0);
			const newProgress = isCorrect ? currentProgress + 1 : currentProgress;
			
			progressContainer.dataset.progress = newProgress;
			progressContainer.style.width = `${(newProgress / totalQuestions) * 100}%`;
		}

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();

            // Add event listeners
            document.querySelectorAll('input[name="goals"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    lessonState.completedSections.add('goals');
                    updateProgress();
                });
            });

            // Mark theory as read when scrolled
            const theorySection = document.querySelector('.theory');
            if (theorySection) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            setTimeout(() => {
                                lessonState.completedSections.add('theory');
                                updateProgress();
                            }, 10000); // Mark as read after 10 seconds of viewing
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.7 });

                observer.observe(theorySection);
            }
			
			// Add click handlers for steps
			document.querySelectorAll('.step').forEach((step, index) => {
				step.addEventListener('click', () => {
					stepsManager.goToStep(index);
					
					// Smooth scroll to content if needed
					//const content = document.getElementById(stepsManager.steps[index]);
					//if (content) {
						//content.scrollIntoView({ behavior: 'smooth' });
					//}
				});
			});
			
			// Initial update
			const sections = document.querySelectorAll('.content-section');
			sections.forEach(section => {
				ProgressTracker.updateChapterProgress(section.id);
			});
			

			// Initialize first step
			stepsManager.init();
			
	
			// הוסף data-chapter לכל תת-צעד כדי לשייך אותו לפרק הנכון
			document.querySelectorAll('.content-section').forEach(section => {
				const chapterId = section.id;
				section.querySelectorAll('.substep').forEach(substep => {
					substep.dataset.chapter = chapterId;
				});
			});
			
			// סגירה בלחיצה על Escape
			document.addEventListener('keydown', (e) => {
				if (e.key === 'Escape') {
					const searchOverlay = document.getElementById('searchOverlay');
					if (searchOverlay && searchOverlay.style.display === 'flex') {
						toggleSearch();
					}
				}
			});

			// סגירה בלחיצה מחוץ לחלון החיפוש
			const searchOverlay = document.getElementById('searchOverlay');
			if (searchOverlay) {
				searchOverlay.style.display = 'none';
				searchOverlay.addEventListener('click', (e) => {
					if (e.target === searchOverlay) {
						toggleSearch();
					}
				});
			}

			// חיפוש בהקלדה
			const searchInput = document.getElementById('searchInput');
			let searchTimeout;
			searchInput?.addEventListener('input', (e) => {
				clearTimeout(searchTimeout);
				searchTimeout = setTimeout(() => {
					performSearch(e.target.value);
				}, 300); // השהייה של 300ms למניעת חיפושים מיותרים
			});
    
			// Add search input listener
			searchInput.addEventListener('input', () => {
				searchContent();
			});
			
			// Add escape key listener to close search
			document.addEventListener('keydown', (e) => {
				if (e.key === 'Escape' && document.getElementById('searchOverlay').style.display === 'flex') {
					toggleSearch();
				}
			});
			
			// Close Progress Overlay when clicking outside
			document.addEventListener('click', (e) => {
				const overlay = document.getElementById('progressOverlay');
				const progressBtn = document.getElementById('progressBtn');
				
				if (overlay && overlay.classList.contains('visible') &&
					!overlay.contains(e.target) && !progressBtn.contains(e.target)) {
					overlay.classList.remove('visible');
				}
			});

			// Add scroll event listener
			window.addEventListener('scroll', toggleScrollButton);

			initializeSectionNavigation();
			
			initProgressButton();
			
			initializeQuiz();
			
			initializeSimulator();
			
			initializeCharts();

			initializeAnimations();

			toggleScrollButton();
			
			initializeChapterProgress();
			
			ProgressTracker.init();
        });

        // Add styles for notifications
        const style = document.createElement('style');
        style.textContent = `
            .notification {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem 2rem;
                border-radius: 8px;
                background-color: var(--background-color);
                box-shadow: 0 4px 20px var(--shadow-color);
                transform: translateY(-20px);
                opacity: 0;
                transition: all 0.3s ease;
                z-index: 1000;
            }

            .notification.success {
                border-right: 4px solid var(--success-color);
            }

            .notification.error {
                border-right: 4px solid var(--error-color);
            }

            .notification.warning {
                border-right: 4px solid var(--warning-color);
            }

            .quiz-option .feedback {
                display: none;
                margin-top: 0.5rem;
                padding: 0.5rem;
                border-radius: 4px;
                background-color: var(--card-background);
                font-size: 0.9rem;
            }

            .quiz-question.correct {
                border-right: 4px solid var(--success-color);
                padding-right: 1rem;
            }

            .quiz-question.incorrect {
                border-right: 4px solid var(--error-color);
                padding-right: 1rem;
            }

            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.02); }
                100% { transform: scale(1); }
            }

            @keyframes slideIn {
                from { 
                    transform: translateY(-20px);
                    opacity: 0;
                }
                to { 
                    transform: translateY(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
		
		// משחק חנות
		const products = [
			{ id: 1, name: "ספר", price: 50 },
			{ id: 2, name: "משחק", price: 80 },
			{ id: 3, name: "צעצוע", price: 40 },
			{ id: 4, name: "ממתקים", price: 10 },
			{ id: 5, name: "חטיף", price: 5 },
			{ id: 6, name: "מחברת", price: 15 }
		];

		let cart = [];
		let money = 100;

		function initShop() {
			const shopDiv = document.getElementById('shopProducts');
			shopDiv.innerHTML = products.map(product => `
				<div class="product-card" onclick="addToCart(${product.id})">
					<h6>${product.name}</h6>
					<p>${product.price} ₪</p>
				</div>
			`).join('');
			updateCart();
		}

		function addToCart(productId) {
			const product = products.find(p => p.id === productId);
			if (getTotalCost() + product.price <= money) {
				cart.push(product);
				updateCart();
			} else {
				alert('אין מספיק כסף!');
			}
		}

		function getTotalCost() {
			return cart.reduce((sum, item) => sum + item.price, 0);
		}

		function updateCart() {
			const cartDiv = document.getElementById('cart-items');
			cartDiv.innerHTML = cart.map(item => `
				<div class="cart-item">
					${item.name} - ${item.price} ₪
				</div>
			`).join('');
			document.getElementById('cartTotal').textContent = getTotalCost();
			document.getElementById('availableMoney').textContent = money - getTotalCost();
		}

		function checkout() {
			const total = getTotalCost();
			if (total > 0) {
				alert(`קנית מוצרים בסך ${total} ₪. נשאר לך ${money - total} ₪`);
				money -= total;
				cart = [];
				updateCart();
			}
		}

		// מחשבון דמי כיס
		function calculateAllowance() {
			const age = Number(document.getElementById('childAge').value);
			const frequency = document.getElementById('frequency').value;
			const incomeLevel = document.getElementById('incomeLevel').value;

			let baseAmount = age * 5; // 5 שקלים כפול הגיל
			
			// התאמה לפי רמת הכנסה
			switch(incomeLevel) {
				case 'low': baseAmount *= 0.8; break;
				case 'high': baseAmount *= 1.2; break;
			}

			// התאמה לתדירות
			if (frequency === 'monthly') {
				baseAmount *= 4;
			}

			const result = {
				amount: Math.round(baseAmount),
				savingsRecommendation: Math.round(baseAmount * 0.2),
				spendingRecommendation: Math.round(baseAmount * 0.6),
				donationRecommendation: Math.round(baseAmount * 0.2)
			};

			document.getElementById('allowanceResult').innerHTML = `
				<h6>המלצות לדמי כיס ${frequency === 'weekly' ? 'שבועיים' : 'חודשיים'}:</h6>
				<ul>
					<li>סכום כולל: ${result.amount} ₪</li>
					<li>המלצה לחיסכון (20%): ${result.savingsRecommendation} ₪</li>
					<li>המלצה להוצאות (60%): ${result.spendingRecommendation} ₪</li>
					<li>המלצה לתרומה/צדקה (20%): ${result.donationRecommendation} ₪</li>
				</ul>
			`;
		}
		
		// טוגל חלון החיפוש
		function toggleSearch() {
			const searchOverlay = document.getElementById('searchOverlay');
			if (!searchOverlay) return;
			
			const isVisible = window.getComputedStyle(searchOverlay).display !== 'none';
			
			searchOverlay.style.display = isVisible ? 'none' : 'flex';
			
			if (!isVisible) {
				// נקה את שדה החיפוש
				const searchInput = document.getElementById('searchInput');
				if (searchInput) {
					searchInput.value = '';
					searchInput.focus();
				}
				
				// נקה את תוצאות החיפוש
				const searchResults = document.getElementById('searchResults');
				if (searchResults) {
					searchResults.innerHTML = '';
				}
			}
			
			// מניעת המשך האירוע
			event?.preventDefault();
			event?.stopPropagation();
		}

		// חיפוש בתוכן
		function performSearch(searchTerm) {
			if (!searchTerm || searchTerm.length < 2) return;
			
			const searchResults = document.getElementById('searchResults');
			if (!searchResults) return;
			
			const results = [];
			
			document.querySelectorAll('.content-section').forEach(section => {
				// מציאת כותרת הסעיף
				const title = section.querySelector('h2')?.textContent || '';
				const sectionId = section.id;
				
				// מציאת ה-step המתאים מתוך המיפוי הקיים
				const stepId = Object.keys(stepMap).find(key => stepMap[key] === section.id);
				
				// חיפוש בכל התוכן הרלוונטי
				section.querySelectorAll('h4, h5, h6, p, li').forEach(element => {
					const text = element.textContent;
					if (text.toLowerCase().includes(searchTerm.toLowerCase())) {
						results.push({
							title,
							content: text,
							sectionId,
							stepId: stepId || findParentStep(section)
						});
					}
				});
			});

			// פונקציית עזר למציאת ה-step ההורה
			function findParentStep(section) {
				// מציאת ה-step הקרוב ביותר שמכיל את הסעיף
				const steps = document.querySelectorAll('.step');
				for (let step of steps) {
					const substeps = step.querySelectorAll('.substep');
					for (let substep of substeps) {
						if (substep.dataset.section === section.id) {
							return step.dataset.step;
						}
					}
				}
				return null;
			}

			// הצגת התוצאות
			searchResults.innerHTML = results.length ? 
				results.map(result => `
					<div class="search-result" onclick="navigateToSection('${result.stepId}','${result.sectionId}')">
						<div class="result-title">${result.title}</div>
						<div class="result-content">${highlightText(result.content, searchTerm)}</div>
						<div class="result-path">${result.stepId ? `מיקום: ${result.stepId}` : ''}</div>
					</div>
				`).join('') : 
				'<div class="no-results">לא נמצאו תוצאות</div>';
		}
		
		
		// הדגשת מילות החיפוש בטקסט
		function highlightText(text, searchTerm) {
				return text.replace(new RegExp(searchTerm, 'gi'), 
					match => `<span class="highlight">${match}</span>`);
			}

		// ניווט לסעיף הרלוונטי
		function navigateToSection(stepId, sectionId) {
			//const stepId = substep.closest('.step')?.dataset.step;
			//const sectionId = substep.dataset.section;
			
			if (!stepId || !sectionId) return;
			
			var key = ``;
			if (stepId === 'null')
			{
				key = `${sectionId}`;
				toggleSearch();
			}
			else
				key = `${stepId}-${sectionId}`;
			
			// מציאת האינדקס מהמפה
			const stepIndex = stepMap[key];
			if (typeof stepIndex !== 'number') return;
			
			try {
				// נסיון לנווט באמצעות מנהל הצעדים אם הוא קיים
				if (stepsManager && typeof stepsManager.goToStep === 'function') {
					stepsManager.goToStep(stepIndex);
				}
				
				// בכל מקרה, גולל לאלמנט המתאים
				setTimeout(() => {
					const section = document.getElementById(key);
					if (section) {
						const headerHeight = document.querySelector('header')?.offsetHeight || 0;
						const offset = section.getBoundingClientRect().top + window.pageYOffset - headerHeight - 20;
						
						window.scrollTo({
							top: offset,
							behavior: 'smooth'
						});
						
						// הדגשה זמנית
						section.classList.add('highlight');
						setTimeout(() => section.classList.remove('highlight'), 2000);
					}
				}, 100);
			} catch (error) {
				console.error('Error during navigation:', error);
			}
		}

		// Search functionality
		function searchContent() {
			const searchTerm = document.getElementById('searchInput').value.toLowerCase();
			const searchResults = document.getElementById('searchResults');
			
			// Clear previous results
			searchResults.innerHTML = '';
			
			if (searchTerm.length < 2) return;

			// Define sections to search through
			const sections = document.querySelectorAll('.content-section');
			let results = [];

			sections.forEach(section => {
				// Get section title
				const title = section.querySelector('h2')?.textContent;
				
				// Get all content blocks in the section
				const blocks = section.querySelectorAll('.content-block h4, .content-block h5, .content-block p');
				
				blocks.forEach(block => {
					if (block.textContent.toLowerCase().includes(searchTerm)) {
						results.push({
							section: title,
							sectionId: section.id,
							text: block.textContent,
							type: block.tagName
						});
					}
				});
			});

			// Display results
			if (results.length > 0) {
				results.forEach(result => {
					const resultElement = document.createElement('div');
					resultElement.className = 'search-result';
					resultElement.innerHTML = `
						<div class="result-section">${result.section}</div>
						<div class="result-text">${highlightSearchTerm(result.text, searchTerm)}</div>
					`;
					
					// Add click handler to navigate to section
					resultElement.addEventListener('click', () => {
						navigateToSection(result.sectionId);
						toggleSearch(); // Close search overlay
					});
					
					searchResults.appendChild(resultElement);
				});
			} else {
				searchResults.innerHTML = '<div class="no-results">לא נמצאו תוצאות</div>';
			}
		}

		// Helper function to highlight search term in results
		// Helper function to highlight search term in results
		function highlightSearchTerm(text, searchTerm) {
			const regex = new RegExp(`(${searchTerm})`, 'gi');
			return text.replace(regex, '<mark>$1</mark>');
		}

		function trackSavings() {
			// קבלת הערכים מהשדות
			const goal = document.getElementById('savingGoal').value;         // מטרת החיסכון (טקסט)
			const targetPrice = Number(document.getElementById('targetPrice').value); // סכום היעד
			const weeklySaving = Number(document.getElementById('weeklySaving').value); // חיסכון שבועי

			// חישוב הזמן הנדרש
			const weeksToGoal = Math.ceil(targetPrice / weeklySaving); // מספר שבועות לחיסכון
			const monthsToGoal = Math.ceil(weeksToGoal / 4);    // המרה לחודשים

			// הצגת התוצאות
			document.getElementById('savingsProgress').innerHTML = `
				<h6>מעקב חיסכון - ${goal}</h6>
				<ul>
					<li>זמן להשגת המטרה: ${weeksToGoal} שבועות (${monthsToGoal} חודשים)</li>
					<li>חיסכון שבועי: ${weeklySaving} ₪</li>
					<li>סכום יעד: ${targetPrice} ₪</li>
				</ul>
				<div class="progress-bar">
					<div class="progress-fill" id="savingsBar"></div>
				</div>
				<p class="savings-tip">
					${getSavingsTip(weeksToGoal, weeklySaving)}
				</p>
			`;
			
			// אנימציה של בר ההתקדמות
			setTimeout(() => {
			   document.getElementById('savingsBar').style.width = '0%';
			}, 100);
		}

		
		

		// טיפים לחיסכון
		function getSavingsTip(weeks, amount) {
		   if (weeks > 52) {
			   return 'טיפ: נסה להגדיל את החיסכון השבועי כדי להשיג את המטרה מהר יותר';
		   } else if (amount < 20) {
			   return 'טיפ: סכום קטן באופן קבוע יכול להצטבר לסכום משמעותי';
		   } else {
			   return 'טיפ: המשך כך! אתה בדרך הנכונה להשגת המטרה';
		   }
		}
		
		// ניהול רשימת קניות
		let shoppingItems = [];

		function addToList() {
			const name = document.getElementById('itemName').value;
			const quantity = Number(document.getElementById('itemQuantity').value);
			const price = Number(document.getElementById('itemPrice').value);

			if (name && quantity && price) {
				shoppingItems.push({ name, quantity, price });
				updateShoppingList();
				clearInputs(['itemName', 'itemQuantity', 'itemPrice']);
			}
		}

		function updateShoppingList() {
			const list = document.getElementById('shoppingList');
			const total = shoppingItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);

			list.innerHTML = shoppingItems.map(item => `
				<li>
					${item.name} x ${item.quantity} = ${(item.price * item.quantity).toLocaleString()} ₪
					<button onclick="removeItem('${item.name}')">הסר</button>
				</li>
			`).join('');

			document.getElementById('listTotal').innerHTML = `
				<strong>סה"כ: ${total.toLocaleString()} ₪</strong>
			`;
		}

		function removeItem(name) {
			shoppingItems = shoppingItems.filter(item => item.name !== name);
			updateShoppingList();
		}

		// השוואת מחירים
		function comparePrice() {
			const productName = document.getElementById('productName').value;
			const stores = [
				{ name: "סופר א", price: Math.random() * 50 + 50 },
				{ name: "סופר ב", price: Math.random() * 50 + 50 },
				{ name: "סופר ג", price: Math.random() * 50 + 50 }
			];

			const sortedStores = stores.sort((a, b) => a.price - b.price);
			
			document.getElementById('priceComparison').innerHTML = `
				<h6>מחירי ${productName}:</h6>
				<ul>
					${sortedStores.map((store, index) => `
						<li>${store.name}: ${store.price.toFixed(2)} ₪ 
							${index === 0 ? '<span class="best-price">המחיר הטוב ביותר!</span>' : ''}
						</li>
					`).join('')}
				</ul>
				<p>חיסכון אפשרי: ${(sortedStores[2].price - sortedStores[0].price).toFixed(2)} ₪</p>
			`;
		}

		// סימולטור ירידה בהכנסה
		function simulateIncomeReduction() {
			const currentIncome = Number(document.getElementById('currentIncome').value);
			const reductionPercent = Number(document.getElementById('incomeReductionPercent').value);
			const emergencyFund = Number(document.getElementById('emergencyFund').value);
			const fixedExpenses = Number(document.getElementById('fixedExpenses').value);

			const newIncome = currentIncome * (1 - reductionPercent/100);
			const monthlyGap = fixedExpenses - newIncome;
			const emergencyFundMonths = monthlyGap > 0 ? Math.floor(emergencyFund / monthlyGap) : 0;

			let recommendations = [];
			if (monthlyGap > 0) {
				recommendations.push(`נדרש קיצוץ של ${monthlyGap.toLocaleString()} ₪ בחודש`);
				recommendations.push(`קרן החירום תספיק ל-${emergencyFundMonths} חודשים`);
			}

			const result = `
				<h6>תכנית התמודדות:</h6>
				<ul>
					<li>הכנסה חדשה: ${newIncome.toLocaleString()} ₪</li>
					<li>פער חודשי: ${monthlyGap > 0 ? '-' : '+'} ${Math.abs(monthlyGap).toLocaleString()} ₪</li>
					${recommendations.map(rec => '<li>' + rec + '</li>').join('')}
				</ul>
				<div class="action-plan">
					<h6>צעדים מומלצים:</h6>
					<ol>
						${getActionPlan(monthlyGap, emergencyFundMonths)}
					</ol>
				</div>
			`;

			document.getElementById('reductionPlan').innerHTML = result;
		}
		
		// פונקציות עזר
		function getActionPlan(monthlyGap, emergencyFundMonths) {
			let steps = [];
			
			if (monthlyGap > 0) {
				steps.push(`זהה הוצאות לא הכרחיות בסך ${monthlyGap.toLocaleString()} ₪ לקיצוץ מיידי`);
				
				if (emergencyFundMonths < 3) {
					steps.push('הגדל את קרן החירום למינימום של 3 חודשי הוצאות');
				}
				
				steps.push('חפש מקורות הכנסה נוספים זמניים');
				steps.push('שקול מיחזור או איחוד הלוואות להקטנת החזרים חודשיים');
			} else {
				steps.push('המצב הפיננסי יציב - המשך לחזק את קרן החירום');
				steps.push('שקול להגדיל את החיסכון ארוך הטווח');
			}
			
			return steps.map(step => '<li>' + step + '</li>').join('');
		}

		function calculatePayoffTime(totalDebt, monthlyPayment, interest) {
			// חישוב מספר החודשים הדרושים לסגירת החוב
			const monthlyInterest = interest / 100 / 12;
			const numberOfMonths = Math.ceil(
				Math.log(monthlyPayment / (monthlyPayment - totalDebt * monthlyInterest)) /
				Math.log(1 + monthlyInterest)
			);
			
			return numberOfMonths;
		}

		function getPayoffStrategy(sortedDebts, monthlyPayment) {
			let strategy = [];
			let remainingPayment = monthlyPayment;
			let totalMonthlyMinimum = sortedDebts.reduce((sum, debt) => sum + (debt.amount * 0.1), 0);

			if (monthlyPayment < totalMonthlyMinimum) {
				strategy.push('התשלום החודשי המוצע נמוך מדי - נדרש סכום גבוה יותר');
				return strategy.map(step => `<li>${step}</li>`).join('');
			}

			strategy.push(`תשלום מינימום לכל החובות: ${Math.round(totalMonthlyMinimum).toLocaleString()} ₪`);
			strategy.push(`שארית התשלום החודשי (${(monthlyPayment - totalMonthlyMinimum).toLocaleString()} ₪) תופנה לחוב עם הריבית הגבוהה ביותר`);
			
			sortedDebts.forEach((debt, index) => {
				strategy.push(`חוב ${index + 1}: ${debt.name} - ריבית ${debt.interest}% - תשלום מוגבר עד לסגירה`);
			});

			return strategy.map(step => `<li>${step}</li>`).join('');
		}

		function clearInputs(ids) {
			ids.forEach(id => {
				document.getElementById(id).value = '';
			});
		}

		function clearDebtInputs() {
			clearInputs(['debtName', 'debtAmount', 'interestRate']);
		}

		// פונקציות עזר נוספות לפורמוט
		function formatCurrency(amount) {
			return amount.toLocaleString('he-IL', { style: 'currency', currency: 'ILS' });
		}

		function formatPercent(value) {
			return value.toLocaleString('he-IL', { style: 'percent', minimumFractionDigits: 1 });
		}

		// הוספת מאזינים לאירועים
		document.addEventListener('DOMContentLoaded', () => {
			// מאזינים לשינויים בשדות קלט
			const inputs = document.querySelectorAll('.calc-input');
			inputs.forEach(input => {
				input.addEventListener('input', () => {
					input.value = input.value.replace(/[^0-9]/g, '');
				});
			});
		});


		// תכנון יציאה מחובות
		let debts = [];

		function addDebt() {
			const name = document.getElementById('debtName').value;
			const amount = Number(document.getElementById('debtAmount').value);
			const interest = Number(document.getElementById('interestRate').value);

			if (name && amount && interest) {
				debts.push({ name, amount, interest });
				updateDebtsList();
				clearDebtInputs();
			}
		}

		function updateDebtsList() {
			const listElement = document.getElementById('debtsList');
			listElement.innerHTML = debts.map((debt, index) => `
				<div class="debt-item">
					<span>${debt.name}: ${debt.amount.toLocaleString()} ₪ (${debt.interest}%)</span>
					<button onclick="removeDebt(${index})">מחק</button>
				</div>
			`).join('');
		}

		function removeDebt(index) {
			debts.splice(index, 1);
			updateDebtsList();
		}

		function calculateDebtPayoff() {
			const monthlyPayment = Number(document.getElementById('monthlyPayment').value);
			let totalDebt = debts.reduce((sum, debt) => sum + debt.amount, 0);
			let avgInterest = debts.reduce((sum, debt) => sum + (debt.amount * debt.interest), 0) / totalDebt;
			
			// מיון החובות לפי ריבית
			const sortedDebts = [...debts].sort((a, b) => b.interest - a.interest);
			
			const result = `
				<h6>תכנית החזר חובות:</h6>
				<ul>
					<li>סך חובות: ${totalDebt.toLocaleString()} ₪</li>
					<li>ריבית ממוצעת: ${avgInterest.toFixed(1)}%</li>
					<li>זמן משוער לסגירת החובות: ${calculatePayoffTime(totalDebt, monthlyPayment, avgInterest)} חודשים</li>
				</ul>
				<div class="payoff-strategy">
					<h6>אסטרטגיית החזר מומלצת:</h6>
					<ol>
						${getPayoffStrategy(sortedDebts, monthlyPayment)}
					</ol>
				</div>
			`;

			document.getElementById('debtPayoffPlan').innerHTML = result;
		}
		
		function optimizeLifestyle() {
			const monthlyIncome = Number(document.getElementById('monthlyNetIncome').value);
			const currentSavings = Number(document.getElementById('currentSavings').value);
			const leisureBudget = Number(document.getElementById('leisureBudget').value);

			const savingsRate = (currentSavings / monthlyIncome) * 100;
			const leisureRate = (leisureBudget / monthlyIncome) * 100;

			let recommendations = [];
			
			// בדיקות והמלצות
			if (savingsRate < 20) {
				recommendations.push('הגדלת החיסכון החודשי ל-20% מההכנסה');
			}
			
			if (leisureRate > 30) {
				recommendations.push('שקול הקטנת תקציב הפנאי ל-30% מההכנסה');
			} else if (leisureRate < 10 && savingsRate > 30) {
				recommendations.push('ניתן להגדיל את תקציב הפנאי תוך שמירה על חיסכון');
			}

			// חישוב המלצות לשיפור
			const recommendedSavings = monthlyIncome * 0.2;
			const recommendedLeisure = monthlyIncome * 0.3;
			
			const result = `
				<h6>ניתוח איכות חיים פיננסית:</h6>
				<ul>
					<li>אחוז חיסכון נוכחי: ${savingsRate.toFixed(1)}%</li>
					<li>אחוז פנאי נוכחי: ${leisureRate.toFixed(1)}%</li>
				</ul>
				<div class="optimization-plan">
					<h6>המלצות לאיזון:</h6>
					<ul>
						${recommendations.map(rec => `<li>${rec}</li>`).join('')}
					</ul>
					<div class="recommended-amounts">
						<p>סכומים מומלצים:</p>
						<ul>
							<li>חיסכון חודשי: ${recommendedSavings.toLocaleString()} ₪</li>
							<li>תקציב פנאי: ${recommendedLeisure.toLocaleString()} ₪</li>
						</ul>
					</div>
				</div>
			`;

			document.getElementById('lifestyleRecommendations').innerHTML = result;
		}
				
				

		// מחשבון חיסכון לחינוך
		function calculateEducationSavings() {
			const currentAge = Number(document.getElementById('childCurrentAge').value);
			const goalType = document.getElementById('educationGoal').value;
			const monthlySaving = Number(document.getElementById('monthlySaving').value);

			let targetAmount;
			switch(goalType) {
				case 'degree':
					targetAmount = 150000;
					break;
				case 'professional':
					targetAmount = 50000;
					break;
				case 'custom':
					targetAmount = Number(document.getElementById('customAmount').value);
					break;
			}

			const yearsToSave = 18 - currentAge;
			const expectedReturn = 0.04; // תשואה שנתית משוערת של 4%
			
			// חישוב הסכום הצפוי
			const futureValue = monthlySaving * 12 * ((Math.pow(1 + expectedReturn, yearsToSave) - 1) / expectedReturn);
			const gap = targetAmount - futureValue;

			const result = `
				<h6>תחזית חיסכון:</h6>
				<ul>
					<li>יעד חיסכון: ${targetAmount.toLocaleString()} ₪</li>
					<li>צבירה צפויה: ${Math.round(futureValue).toLocaleString()} ₪</li>
					<li>זמן לחיסכון: ${yearsToSave} שנים</li>
					${gap > 0 ? 
						`<li class="warning">חסר: ${Math.round(gap).toLocaleString()} ₪</li>
						 <li>חיסכון חודשי מומלץ: ${Math.round((targetAmount / (yearsToSave * 12))).toLocaleString()} ₪</li>` :
						`<li class="success">היעד צפוי להיות מושג!</li>`}
				</ul>
			`;

			document.getElementById('educationSavingsResult').innerHTML = result;
		}
		
		function checkProgress() {
			const checklist = {
				budgetCheck: 'תקציב משפחתי',
				savingsCheck: 'קרן חירום',
				insuranceCheck: 'כיסויים ביטוחיים',
				retirementCheck: 'תכנון פרישה',
				kidsEducationCheck: 'חיסכון לילדים'
			};

			let completed = 0;
			let total = Object.keys(checklist).length;
			let completedItems = [];
			let remainingItems = [];

			for (let [id, name] of Object.entries(checklist)) {
				if (document.getElementById(id).checked) {
					completed++;
					completedItems.push(name);
				} else {
					remainingItems.push(name);
				}
			}

			const progressPercent = (completed / total) * 100;
			
			document.getElementById('progressSummary').innerHTML = `
				<h6>סיכום התקדמות:</h6>
				<p>השלמת ${progressPercent}% מהיעדים</p>
				${completedItems.length > 0 ? 
					`<div class="completed-items">
						<h6>הושלם:</h6>
						<ul>${completedItems.map(item => `<li>${item}</li>`).join('')}</ul>
					</div>` : ''}
				${remainingItems.length > 0 ? 
					`<div class="remaining-items">
						<h6>להשלמה:</h6>
						<ul>${remainingItems.map(item => `<li>${item}</li>`).join('')}</ul>
					</div>` : ''}
			`;
		}

		function startTracking() {
			// Initialize tracking data
			const trackingData = {
				startDate: new Date(),
				goals: [],
				milestones: []
			};

			// Save to localStorage
			localStorage.setItem('financialTracking', JSON.stringify(trackingData));

			document.getElementById('trackingResults').innerHTML = `
				<div class="tracking-started">
					<h6>מעקב התקדמות הופעל!</h6>
					<p>תאריך התחלה: ${trackingData.startDate.toLocaleDateString()}</p>
					<div class="next-actions">
						<h6>הצעדים הבאים:</h6>
						<ol>
							<li>השלם את רשימת הבדיקה לעיל</li>
							<li>עקוב אחר התקדמות חודשית</li>
							<li>עדכן את התוכנית בהתאם לצורך</li>
						</ol>
					</div>
				</div>
			`;
		}

		// מחשבון משכנתא
		function calculateMortgage() {
			const propertyPrice = Number(document.getElementById('propertyPrice').value);
			const currentSavings = Number(document.getElementById('currentSavings').value);
			const monthlySaving = Number(document.getElementById('monthlySavingAmount').value);
			const familyIncome = Number(document.getElementById('familyIncome').value);

			const requiredDownPayment = propertyPrice * 0.25; // 25% הון עצמי נדרש
			const maxMonthlyPayment = familyIncome * 0.33; // מקסימום 33% מההכנסה להחזר משכנתא
			const missingDownPayment = requiredDownPayment - currentSavings;
			const monthsToSave = Math.ceil(missingDownPayment / monthlySaving);

			const result = `
				<h6>ניתוח תכנית רכישה:</h6>
				<ul>
					<li>הון עצמי נדרש: ${Math.round(requiredDownPayment).toLocaleString()} ₪</li>
					<li>חסר להון עצמי: ${Math.round(missingDownPayment).toLocaleString()} ₪</li>
					<li>זמן חיסכון נדרש: ${Math.floor(monthsToSave/12)} שנים ו-${monthsToSave%12} חודשים</li>
					<li>החזר חודשי מקסימלי מומלץ: ${Math.round(maxMonthlyPayment).toLocaleString()} ₪</li>
				</ul>
				<div class="mortgage-tips">
					<p>${getMortgageTip(monthsToSave, maxMonthlyPayment, propertyPrice - requiredDownPayment)}</p>
				</div>
				`;

			document.getElementById('mortgageResult').innerHTML = result;
		}

		function getMortgageTip(monthsToSave, maxPayment, loanAmount) {
			if (monthsToSave > 60) {
				return 'טיפ: שקול הגדלת החיסכון החודשי או חיפוש דירה במחיר נמוך יותר';
			} else if (loanAmount / maxPayment > 300) {
				return 'טיפ: גובה ההחזר החודשי עלול להיות גבוה מדי ביחס להכנסה';
			} else {
				return 'טיפ: התוכנית נראית מאוזנת והיעד בר השגה';
			}
		}

		// מנתח תזרים מזומנים
		function analyzeCashFlow() {
			const income = {
				salary1: Number(document.getElementById('salary1').value),
				salary2: Number(document.getElementById('salary2').value),
				other: Number(document.getElementById('otherIncome').value)
			};
			
			const expenses = {
				housing: Number(document.getElementById('housing').value),
				fixed: Number(document.getElementById('fixedExpenses').value),
				variable: Number(document.getElementById('variableExpenses').value)
			};

			const totalIncome = income.salary1 + income.salary2 + income.other;
			const totalExpenses = expenses.housing + expenses.fixed + expenses.variable;
			const monthlyBalance = totalIncome - totalExpenses;
			const savingRate = (monthlyBalance / totalIncome) * 100;

			let recommendedEmergencyFund = totalExpenses * 6; // 6 חודשי הוצאות
			let monthsToEmergencyFund = recommendedEmergencyFund / monthlyBalance;

			const result = `
				<h6>ניתוח תזרים מזומנים:</h6>
				<ul>
					<li>סך הכנסות: ${totalIncome.toLocaleString()} ₪</li>
					<li>סך הוצאות: ${totalExpenses.toLocaleString()} ₪</li>
					<li>יתרה חודשית: ${monthlyBalance.toLocaleString()} ₪</li>
					<li>שיעור חיסכון: ${savingRate.toFixed(1)}%</li>
				</ul>
				
				<div class="emergency-fund-analysis">
					<h6>ניתוח קרן חירום:</h6>
					<ul>
						<li>קרן חירום מומלצת: ${recommendedEmergencyFund.toLocaleString()} ₪</li>
						<li>זמן לבניית קרן חירום: ${Math.ceil(monthsToEmergencyFund)} חודשים</li>
					</ul>
				</div>

				<div class="cash-flow-recommendations">
					<h6>המלצות:</h6>
					<ul>
						${getCashFlowRecommendations(savingRate, monthlyBalance, totalExpenses)}
					</ul>
				</div>
			`;

			document.getElementById('cashFlowAnalysis').innerHTML = result;
		}

		function getCashFlowRecommendations(savingRate, monthlyBalance, expenses) {
			let recommendations = [];

			if (savingRate < 10) {
				recommendations.push('מומלץ להגדיל את שיעור החיסכון ל-10% לפחות');
			}
			if (monthlyBalance < 0) {
				recommendations.push('יש לצמצם הוצאות או להגדיל הכנסות לאיזון התקציב');
			}
			if (monthlyBalance < expenses * 0.1) {
				recommendations.push('מומלץ ליצור כרית ביטחון גדולה יותר למקרי חירום');
			}
			if (recommendations.length === 0) {
				recommendations.push('התזרים מאוזן ויציב. המשך לשמור על ניהול פיננסי אחראי');
			}

			return recommendations.map(rec => `<li>${rec}</li>`).join('');
		}

		// מאזין לשינוי בסוג יעד החיסכון
		document.getElementById('educationGoal')?.addEventListener('change', function() {
			const customAmountGroup = document.getElementById('customAmountGroup');
			customAmountGroup.style.display = this.value === 'custom' ? 'block' : 'none';
		});
		
		

		// חישוב עלויות תחבורה
		function compareTransportCosts() {
			const fuelEfficiency = Number(document.getElementById('fuelEfficiency').value);
			const dailyDistance = Number(document.getElementById('dailyDistance').value);
			const fuelPrice = Number(document.getElementById('fuelPrice').value);
			const monthlyPass = Number(document.getElementById('monthlyPass').value);

			const dailyFuelCost = (dailyDistance / fuelEfficiency) * fuelPrice;
			const monthlyFuelCost = dailyFuelCost * 22; // ימי עבודה בחודש
			const yearlyFuelCost = monthlyFuelCost * 12;
			const yearlyPublicCost = monthlyPass * 12;

			document.getElementById('transportComparison').innerHTML = `
				<h6>השוואת עלויות שנתית:</h6>
				<ul>
					<li>רכב פרטי: ${Math.round(yearlyFuelCost).toLocaleString()} ₪</li>
					<li>תחבורה ציבורית: ${yearlyPublicCost.toLocaleString()} ₪</li>
				</ul>
				<p class="saving-summary">
					${yearlyFuelCost > yearlyPublicCost ? 
						`חיסכון אפשרי בתחבורה ציבורית: ${Math.round(yearlyFuelCost - yearlyPublicCost).toLocaleString()} ₪ בשנה` :
						`חיסכון בזמן ונוחות ברכב פרטי עם עלות נוספת של ${Math.round(yearlyFuelCost - yearlyPublicCost).toLocaleString()} ₪ בשנה`}
				</p>
			`;
		}

		function clearInputs(ids) {
			ids.forEach(id => {
				document.getElementById(id).value = '';
			});
		}

		// קוד JavaScript למבחן הידע
		document.querySelectorAll('.check-answer-btn').forEach(button => {
			button.addEventListener('click', checkAnswer);
		});

		function checkAnswer(event) {
			const questionCard = event.target.closest('.quiz-container').querySelector('.question-card');
			const selectedOption = questionCard.querySelector('input[type="radio"]:checked');
			
			if (!selectedOption) {
				alert('אנא בחר תשובה');
				return;
			}
			
			const isCorrect = selectedOption.value === 'b'; // התשובה הנכונה
			questionCard.className = `question-card ${isCorrect ? 'correct' : 'incorrect'}`;
			
			// הצג משוב
			questionCard.querySelectorAll('.feedback').forEach(feedback => {
				feedback.style.display = 'none';
			});
			
			const feedback = selectedOption.parentElement.querySelector('.feedback');
			feedback.classList.add('show');
			
			// עדכן התקדמות
			updateProgress(isCorrect);
		}

		// קוד JavaScript לסימולטור
		function initializeSimulator() {
			const ctx = document.getElementById('growthChart').getContext('2d');
			let chart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: [],
					datasets: [{
						label: 'ערך השקעה',
						data: [],
						borderColor: '#4a90a7',
						fill: true,
						backgroundColor: 'rgba(74, 144, 167, 0.1)'
					}]
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								callback: value => value.toLocaleString() + ' ₪',
								color: 'white'  // צבע המספרים בציר Y
							},
							grid: {
								color: 'rgba(255, 255, 255, 0.1)',  // צבע הקווים הרוחביים
								borderColor: 'white'  // צבע הציר Y עצמו
							}
						},
						x: {
							ticks: {
								color: 'white'  // צבע המספרים בציר X
							},
							grid: {
								color: 'rgba(255, 255, 255, 0.1)',  // צבע הקווים האנכיים
								borderColor: 'white'  // צבע הציר X עצמו
							}
						}
					},
					plugins: {
						tooltip: {
							callbacks: {
								label: context => {
									return context.parsed.y.toLocaleString() + ' ₪';
								}
							}
						},
						legend: {
							labels: {
								color: 'white'  // צבע הטקסט במקרא
							}
						}
					}
				}
			});

			// מאזיני אירועים לשינויים בקלט
			document.querySelectorAll('.input-group input').forEach(input => {
				input.addEventListener('input', calculateInvestment);
			});

			function calculateInvestment() {
				const initialAmount = Number(document.getElementById('initialAmount').value);
				const monthlyDeposit = Number(document.getElementById('monthlyDeposit').value);
				const expectedReturn = Number(document.getElementById('expectedReturn').value) / 100;
				const years = Number(document.getElementById('investmentPeriod').value);

				const monthlyRate = expectedReturn / 12;
				const months = years * 12;
				let balance = initialAmount;
				const dataPoints = [balance];

				for (let i = 1; i <= months; i++) {
					balance = balance * (1 + monthlyRate) + monthlyDeposit;
					if (i % 12 === 0) {
						dataPoints.push(Math.round(balance));
					}
				}

				// עדכון הגרף
				chart.data.labels = Array.from({length: years + 1}, (_, i) => `שנה ${i}`);
				chart.data.datasets[0].data = dataPoints;
				chart.update();

				// עדכון סיכום התוצאות
				document.getElementById('finalAmount').textContent = Math.round(balance).toLocaleString() + ' ₪';
				document.getElementById('totalProfit').textContent = 
					Math.round(balance - initialAmount - (monthlyDeposit * months)).toLocaleString() + ' ₪';
			}

			// חישוב ראשוני
			calculateInvestment();
		}

		// קוד JavaScript לגרפים דינמיים
		function initializeCharts() {
			// יצירת גרף עוגה
			const pieCtx = document.getElementById('expensesPie').getContext('2d');
			const pieChart = new Chart(pieCtx, {
				type: 'pie',
				data: {
					labels: ['דיור', 'מזון', 'תחבורה', 'בילויים', 'חינוך'],
					datasets: [{
						data: [],
						backgroundColor: [
							'#4a90a7',
							'#c9a959',
							'#2d5a77',
							'#81d4fa',
							'#64b5f6'
						]
					}]
				},
				options: {
					responsive: true,
					plugins: {
						tooltip: {
							callbacks: {
								label: context => {
									const value = context.raw;
									const total = context.dataset.data.reduce((a, b) => a + b, 0);
									const percentage = ((value / total) * 100).toFixed(1);
									return `${percentage}%`;
								}
							}
						}
					}
				}
			});

			// יצירת גרף עמודות
			const barCtx = document.getElementById('expensesBar').getContext('2d');
			const barChart = new Chart(barCtx, {
				type: 'bar',
				data: {
					labels: ['דיור', 'מזון', 'תחבורה', 'בילויים', 'חינוך'],
					datasets: [{
						label: 'הוצאה חודשית בש"ח',
						data: [],
						backgroundColor: [
							'#4a90a7',
							'#c9a959',
							'#2d5a77',
							'#81d4fa',
							'#64b5f6'
						]
					}]
				},
				options: {
					responsive: true,
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								callback: value => value.toLocaleString() + ' ₪'
							}
						}
					},
					plugins: {
						tooltip: {
							callbacks: {
								label: context => {
									return context.raw.toLocaleString() + ' ₪';
								}
							}
						}
					}
				}
			});

			// עדכון הגרפים בשינוי ערכים
			function updateCharts() {
				const expenses = {
					housing: Number(document.getElementById('housingExpense').value),
					food: Number(document.getElementById('foodExpense').value),
					transport: Number(document.getElementById('transportExpense').value),
					leisure: Number(document.getElementById('leisureExpense').value),
					education: Number(document.getElementById('educationExpense').value)
				};

				const data = Object.values(expenses);
				const total = data.reduce((a, b) => a + b, 0);

				// עדכון גרפים
				pieChart.data.datasets[0].data = data;
				barChart.data.datasets[0].data = data;
				pieChart.update();
				barChart.update();

				// ניתוח הוצאות
				analyzeExpenses(expenses, total);
			}

			// ניתוח והמלצות
			function analyzeExpenses(expenses, total) {
				const housingPercent = (expenses.housing / total) * 100;
				const foodPercent = (expenses.food / total) * 100;
				const transportPercent = (expenses.transport / total) * 100;
				const leisurePercent = (expenses.leisure / total) * 100;
				const educationPercent = (expenses.education / total) * 100;

				let analysis = `<div class="expense-summary">`;
				analysis += `<p>סך הוצאות חודשיות: ${total.toLocaleString()} ₪</p>`;
				
				// המלצות בהתאם להתפלגות
				if (housingPercent > 35) {
					analysis += `<p class="warning">⚠️ הוצאות הדיור גבוהות מהמומלץ (${housingPercent.toFixed(1)}%)</p>`;
				}
				if (foodPercent > 25) {
					analysis += `<p class="warning">⚠️ הוצאות המזון גבוהות מהמומלץ (${foodPercent.toFixed(1)}%)</p>`;
				}
				if (leisurePercent > 15) {
					analysis += `<p class="warning">⚠️ הוצאות הפנאי גבוהות יחסית (${leisurePercent.toFixed(1)}%)</p>`;
				}

				if (housingPercent <= 35 && foodPercent <= 25 && leisurePercent <= 15) {
					analysis += `<p class="success">✅ התפלגות ההוצאות מאוזנת</p>`;
				}

				document.getElementById('analysisContent').innerHTML = analysis;
			}

			// הוספת מאזיני אירועים
			document.querySelectorAll('.input-group input').forEach(input => {
				input.addEventListener('input', updateCharts);
			});

			// עדכון ראשוני
			updateCharts();
		}

		function updateProgress(isCorrect) {
			// כאן אפשר להוסיף לוגיקה לשמירת התקדמות המשתמש
			const progressEvent = new CustomEvent('quizProgress', {
				detail: { isCorrect }
			});
			document.dispatchEvent(progressEvent);
		}

		// הצגת פרטי פעילות
		function showActivityDetails(activityType) {
		   const activities = {
			   store: {
				   title: 'משחק "חנות"',
				   steps: [
					   'הכינו פריטים למכירה עם תגי מחיר',
					   'תנו לילדים תקציב מוגדר',
					   'אפשרו להם לקבל החלטות קנייה',
					   'דונו בשיקולים לבחירת המוצרים'
				   ],
				   benefits: [
					   'לימוד על ערך הכסף',
					   'תרגול חישובים מתמטיים',
					   'קבלת החלטות כלכליות'
				   ]
			   },
			   budget: {
				   title: 'תכנון תקציב משפחתי',
				   steps: [
					   'רשמו יחד את ההוצאות המשפחתיות',
					   'חלקו לקטגוריות',
					   'קבעו יעדי חיסכון משותפים',
					   'עקבו אחר ההתקדמות'
				   ],
				   benefits: [
					   'הבנת ניהול כספים',
					   'עבודת צוות משפחתית',
					   'פיתוח אחריות כלכלית'
				   ]
			   },
			   investment: {
				   title: 'משחק השקעות',
				   steps: [
					   'צרו "תיק השקעות" דמיוני',
					   'עקבו אחר שינויים בערך',
					   'קבלו החלטות השקעה',
					   'למדו על סיכון ותשואה'
				   ],
				   benefits: [
					   'הבנת עקרונות השקעה',
					   'תכנון לטווח ארוך',
					   'ניהול סיכונים'
				   ]
			   }
		   };

		   const activity = activities[activityType];
		   document.getElementById('activityDetails').innerHTML = `
			   <div class="activity-details-content">
				   <h6>${activity.title}</h6>
				   <div class="steps-section">
					   <h7>שלבי הפעילות:</h7>
					   <ul>
						   ${activity.steps.map(step => `<li>${step}</li>`).join('')}
					   </ul>
				   </div>
				   <div class="benefits-section">
					   <h7>יתרונות חינוכיים:</h7>
					   <ul>
						   ${activity.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
					   </ul>
				   </div>
			   </div>
		   `;
		}

		// אתחול המשחק בטעינת העמוד
		window.addEventListener('load', initShop);

    </script>
</body>
</html>